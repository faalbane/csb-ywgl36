parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"D9Nj":[function(require,module,exports) {

},{}],"g5IB":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"HlZQ":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var define;
var e,t=arguments[3],n=require("process");!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(t,n){"use strict";var r=[],i=Object.getPrototypeOf,o=r.slice,a=r.flat?function(e){return r.flat.call(e)}:function(e){return r.concat.apply([],e)},s=r.push,u=r.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},y=t.document,m={type:!0,src:!0,nonce:!0,noModule:!0};function x(e,t,n){var r,i,o=(n=n||y).createElement("script");if(o.text=e,t)for(r in m)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function b(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var w=function(e,t){return new w.fn.init(e,t)};function T(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!g(e)&&!v(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:"3.6.4",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(w.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:r.sort,splice:r.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||w.isPlainObject(n)?n:{},i=!1,a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.6.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){x(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(T(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(T(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,s=[];if(T(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return a(s)},guid:1,support:h}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=r[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});var C=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,v,y,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ue(),S=ue(),k=ue(),A=ue(),N=function(e,t){return e===t&&(f=!0),0},j={}.hasOwnProperty,D=[],q=D.pop,L=D.push,H=D.push,O=D.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"ï¿½":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){p()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(D=O.call(w.childNodes),w.childNodes),D[w.childNodes.length].nodeType}catch(Se){H={apply:D.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(e,t,r,i){var o,s,l,c,f,h,y,m=t&&t.ownerDocument,w=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==w&&9!==w&&11!==w)return r;if(!i&&(p(t),t=t||d,g)){if(11!==w&&(f=Z.exec(e)))if(o=f[1]){if(9===w){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return H.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return H.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!A[e+" "]&&(!v||!v.test(e))&&(1!==w||"object"!==t.nodeName.toLowerCase())){if(y=e,m=t,1===w&&(U.test(e)||z.test(e))){for((m=ee.test(e)&&ye(t.parentNode)||t)===t&&n.scope||((c=t.getAttribute("id"))?c=c.replace(re,ie):t.setAttribute("id",c=b)),s=(h=a(e)).length;s--;)h[s]=(c?"#"+c:":scope")+" "+xe(h[s]);y=h.join(",")}try{return H.apply(r,m.querySelectorAll(y)),r}catch(T){A(e,!0)}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(B,"$1"),t,r,i)}function ue(){var e=[];return function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function le(e){return e[b]=!0,e}function ce(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(Se){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){for(var n=e.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ae(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ve(e){return le(function(t){return t=+t,le(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},o=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},p=se.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!=d&&9===a.nodeType&&a.documentElement?(h=(d=a).documentElement,g=!o(d),w!=d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",oe,!1):i.attachEvent&&i.attachEvent("onunload",oe)),n.scope=ce(function(e){return h.appendChild(e).appendChild(d.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),n.cssHas=ce(function(){try{return d.querySelector(":has(*,:jqfake)"),!1}catch(Se){return!0}}),n.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ce(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=K.test(d.getElementsByClassName),n.getById=ce(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];for(i=t.getElementsByName(e),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},y=[],v=[],(n.qsa=K.test(d.querySelectorAll))&&(ce(function(e){var t;h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+b+"-]").length||v.push("~="),(t=d.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(n.matchesSelector=K.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ce(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),y.push("!=",F)}),n.cssHas||v.push(":has"),v=v.length&&new RegExp(v.join("|")),y=y.length&&new RegExp(y.join("|")),t=K.test(h.compareDocumentPosition),x=t||K.test(h.contains)?function(e,t){var n=9===e.nodeType&&e.documentElement||e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==d||e.ownerDocument==w&&x(w,e)?-1:t==d||t.ownerDocument==w&&x(w,t)?1:c?P(c,e)-P(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==d?-1:t==d?1:i?-1:o?1:c?P(c,e)-P(c,t):0;if(i===o)return pe(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?pe(a[r],s[r]):a[r]==w?-1:s[r]==w?1:0},d):d},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(p(e),n.matchesSelector&&g&&!A[t+" "]&&(!y||!y.test(t))&&(!v||!v.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(Se){A(t,!0)}return se(t,d,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=d&&p(e),x(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&j.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(N),f){for(;t=e[o++];)t===e[o]&&(i=r.push(o));for(;i--;)e.splice(r[i],1)}return c=null,e},i=se.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=i(t);return n},(r=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=se.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",v=t.parentNode,y=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(v){if(o){for(;g;){for(p=t;p=p[g];)if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?v.firstChild:v.lastChild],a&&m){for(x=(d=(l=(c=(f=(p=v)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&v.childNodes[d];p=++d&&p&&p[g]||(x=d=0)||h.pop();)if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)for(;(p=++d&&p&&p[g]||(x=d=0)||h.pop())&&((s?p.nodeName.toLowerCase()!==y:1!==p.nodeType)||!++x||(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p!==t)););return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,n){for(var r,o=i(e,t),a=o.length;a--;)e[r=P(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:le(function(e){var t=[],n=[],r=s(e.replace(B,"$1"));return r[b]?le(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:le(function(e){return function(t){return se(e,t).length>0}}),contains:le(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||i(t)).indexOf(e)>-1}}),lang:le(function(e){return V.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=he(t);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,u))return!0}else for(;t=t[r];)if(1===t.nodeType||a)if(c=(f=t[b]||(t[b]={}))[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function we(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(e,t,n,r,i,o){return r&&!r[b]&&(r=Ce(r)),i&&!i[b]&&(i=Ce(i,o)),le(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),v=!e||!o&&t?g:Te(g,p,e,s,u),y=n?i||(o?e:h||r)?[]:a:v;if(n&&n(v,y,s,u),r)for(l=Te(y,d),r(l,[],s,u),c=l.length;c--;)(f=l[c])&&(y[d[c]]=!(v[d[c]]=f));if(o){if(i||e){if(i){for(l=[],c=y.length;c--;)(f=y[c])&&l.push(v[c]=f);i(null,y=[],l,u)}for(c=y.length;c--;)(f=y[c])&&(l=i?P(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else y=Te(y===a?y.splice(h,y.length):y),i?i(null,a,y,u):H.apply(a,y)})}function Ee(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=be(function(e){return e===t},s,!0),f=be(function(e){return P(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[be(we(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o&&!r.relative[e[i].type];i++);return Ce(u>1&&we(p),u>1&&xe(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(B,"$1"),n,u<i&&Ee(e.slice(u,i)),i<o&&Ee(e=e.slice(i)),i<o&&xe(e))}p.push(n)}return we(p)}return me.prototype=r.filters=r.pseudos,r.setFilters=new me,a=se.tokenize=function(e,t){var n,i,o,a,s,u,l,c=S[e+" "];if(c)return t?0:c.slice(0);for(s=e,u=[],l=r.preFilter;s;){for(a in n&&!(i=_.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=z.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(B," ")}),s=s.slice(n.length)),r.filter)!(i=G[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):S(e,u).slice(0)},s=se.compile=function(e,t){var n,i=[],o=[],s=k[e+" "];if(!s){for(t||(t=a(e)),n=t.length;n--;)(s=Ee(t[n]))[b]?i.push(s):o.push(s);(s=k(e,function(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,v,y=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,S=C.length;for(c&&(l=a==d||a||c);m!==S&&null!=(f=C[m]);m++){if(i&&f){for(h=0,a||f.ownerDocument==d||(p(f),s=!g);v=e[h++];)if(v(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!v&&f)&&y--,o&&x.push(f))}if(y+=m,n&&m!==y){for(h=0;v=t[h++];)v(x,b,a,s);if(o){if(y>0)for(;m--;)x[m]||b[m]||(b[m]=q.call(u));b=Te(b)}H.apply(u,b),c&&!o&&b.length>0&&y+t.length>1&&se.uniqueSort(u)}return c&&(T=E,l=w),x};return n?le(o):o}(o,i))).selector=e}return s},u=se.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(te,ne),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}for(o=G.needsContext.test(e)?0:u.length;o--&&(l=u[o],!r.relative[c=l.type]);)if((f=r.find[c])&&(i=f(l.matches[0].replace(te,ne),ee.test(u[0].type)&&ye(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&xe(u)))return H.apply(n,i),n;break}}return(p||s(e,d))(i,t,!g,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},n.sortStable=b.split("").sort(N).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(t);w.find=C,w.expr=C.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=C.uniqueSort,w.text=C.getText,w.isXMLDoc=C.isXML,w.contains=C.contains,w.escapeSelector=C.escape;var E=function(e,t,n){for(var r=[],i=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=w.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return g(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return u.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?w(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:y,!0)),N.test(r[1])&&w.isPlainObject(t))for(r in t)g(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=y.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,D=w(y);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&w(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(w(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return E(e,"parentNode")},parentsUntil:function(e,t,n){return E(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return E(e,"nextSibling")},prevAll:function(e){return E(e,"previousSibling")},nextUntil:function(e,t,n){return E(e,"nextSibling",n)},prevUntil:function(e,t,n){return E(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return null!=e.contentDocument&&i(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(H[e]||w.uniqueSort(i),L.test(e)&&i.reverse()),this.pushStack(i)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&g(i=e.promise)?i.call(e).done(t).fail(n):e&&g(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(P)||[],function(e,n){t[n]=!0}),t}(e):w.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1);e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){w.each(n,function(n,r){g(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==b(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return w.each(arguments,function(e,t){for(var n;(n=w.inArray(t,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},w.extend({Deferred:function(e){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var i=g(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(e,r,i){var o=0;function a(e,n,r,i){return function(){var s=this,u=arguments,l=function(){var t,l;if(!(e<o)){if((t=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=t&&("object"==typeof t||"function"==typeof t)&&t.then,g(l)?i?l.call(t,a(o,n,R,i),a(o,n,M,i)):(o++,l.call(t,a(o,n,R,i),a(o,n,M,i),a(o,n,R,n.notifyWith))):(r!==R&&(s=void 0,u=[t]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(t){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(t,c.stackTrace),e+1>=o&&(r!==M&&(s=void 0,u=[t]),n.rejectWith(s,u))}};e?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),t.setTimeout(c))}}return w.Deferred(function(t){n[0][3].add(a(0,t,g(i)?i:R,t.notifyWith)),n[1][3].add(a(0,t,g(e)?e:R)),n[2][3].add(a(0,t,g(r)?r:M))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&(I(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();for(;n--;)I(i[n],s(n),a.reject);return a.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&W.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},w.readyException=function(e){t.setTimeout(function(){throw e})};var F=w.Deferred();function $(){y.removeEventListener("DOMContentLoaded",$),t.removeEventListener("load",$),w.ready()}w.fn.ready=function(e){return F.then(e).catch(function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(y,[w]))}}),w.ready.then=F.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?t.setTimeout(w.ready):(y.addEventListener("DOMContentLoaded",$),t.addEventListener("load",$));var B=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===b(n))for(s in i=!0,n)B(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=w.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(n)}catch(i){}Q.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){Q.set(this,e)}):B(this,function(t){var n;if(o&&void 0===t)return void 0!==(n=Q.get(o,e))?n:void 0!==(n=Z(o,e))?n:void 0;this.each(function(){Q.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){w.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:w.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=y.documentElement,ie=function(e){return w.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===w.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=e.nodeType&&(w.cssNumber[t]||"px"!==l&&+u)&&te.exec(w.css(e,t));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e){var t,n=e.ownerDocument,r=e.nodeName,i=ue[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),ue[r]=i,i)}function ce(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=Y.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=le(r))):"none"!==n&&(i[o]="none",Y.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return ce(this,!0)},hide:function(){return ce(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?w(this).show():w(this).hide()})}});var fe,pe,de=/^(?:checkbox|radio)$/i,he=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ge=/^$|^module$|\/(?:java|ecma)script/i;fe=y.createDocumentFragment().appendChild(y.createElement("div")),(pe=y.createElement("input")).setAttribute("type","radio"),pe.setAttribute("checked","checked"),pe.setAttribute("name","t"),fe.appendChild(pe),h.checkClone=fe.cloneNode(!0).cloneNode(!0).lastChild.checked,fe.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!fe.cloneNode(!0).lastChild.defaultValue,fe.innerHTML="<option></option>",h.option=!!fe.lastChild;var ve={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?w.merge([e],n):n}function me(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ve.tbody=ve.tfoot=ve.colgroup=ve.caption=ve.thead,ve.th=ve.td,h.option||(ve.optgroup=ve.option=[1,"<select multiple='multiple'>","</select>"]);var xe=/<|&#?\w+;/;function be(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===b(o))w.merge(p,o.nodeType?[o]:o);else if(xe.test(o)){for(a=a||f.appendChild(t.createElement("div")),s=(he.exec(o)||["",""])[1].toLowerCase(),u=ve[s]||ve._default,a.innerHTML=u[1]+w.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;w.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));for(f.textContent="",d=0;o=p[d++];)if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(l=ie(o),a=ye(f.appendChild(o),"script"),l&&me(a),n)for(c=0;o=a[c++];)ge.test(o.type||"")&&n.push(o);return f}var we=/^([^.]*)(?:\.(.+)|)/;function Te(){return!0}function Ce(){return!1}function Ee(e,t){return e===function(){try{return y.activeElement}catch(e){}}()==("focus"===t)}function Se(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Se(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Ce;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return w().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),e.each(function(){w.event.add(this,t,i,r,n)})}function ke(e,t,n){n?(Y.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var r,i,a=Y.get(this,t);if(1&e.isTrigger&&this[t]){if(a.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(a=o.call(arguments),Y.set(this,t,a),r=n(this,t),this[t](),a!==(i=Y.get(this,t))||r?Y.set(this,t,!1):i={},a!==i)return e.stopImmediatePropagation(),e.preventDefault(),i&&i.value}else a.length&&(Y.set(this,t,{value:w.event.trigger(w.extend(a[0],w.Event.prototype),a.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,t)&&w.event.add(e,t,Te)}w.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(e);if(V(e))for(n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(re,i),n.guid||(n.guid=w.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(P)||[""]).length;l--;)d=g=(s=we.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=w.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=w.event.special[d]||{},c=w.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),w.event.global[d]=!0)},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){for(l=(t=(t||"").match(P)||[""]).length;l--;)if(d=g=(s=we.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){for(f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;o--;)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||w.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=w.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=w.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){for(a=w.event.handlers.call(this,u,l),t=0;(i=a[t++])&&!u.isPropagationStopped();)for(u.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((w.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?w(i,this).index(l)>-1:w.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return de.test(t.type)&&t.click&&A(t,"input")&&ke(t,"click",Te),!1},trigger:function(e){var t=this||e;return de.test(t.type)&&t.click&&A(t,"input")&&ke(t,"click"),!0},_default:function(e){var t=e.target;return de.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Te:Ce,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Ce,isPropagationStopped:Ce,isImmediatePropagationStopped:Ce,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Te,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Te,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Te,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},function(e,t){w.event.special[e]={setup:function(){return ke(this,e,Ee),!1},trigger:function(){return ke(this,e),!0},_default:function(t){return Y.get(t.target,e)},delegateType:t}}),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;return r&&(r===this||w.contains(this,r))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return Se(this,e,t,n,r)},one:function(e,t,n,r){return Se(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Ce),this.each(function(){w.event.remove(this,e,n,t)})}});var Ae=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function De(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function qe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Le(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function He(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)w.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=w.extend({},o),Q.set(t,a))}}function Oe(e,t,n,r){t=a(t);var i,o,s,u,l,c,f=0,p=e.length,d=p-1,v=t[0],y=g(v);if(y||p>1&&"string"==typeof v&&!h.checkClone&&Ne.test(v))return e.each(function(i){var o=e.eq(i);y&&(t[0]=v.call(this,i,o.html())),Oe(o,t,n,r)});if(p&&(o=(i=be(t,e[0].ownerDocument,!1,e,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=w.map(ye(i,"script"),qe)).length;f<p;f++)l=i,f!==d&&(l=w.clone(l,!0,!0),u&&w.merge(s,ye(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,w.map(s,Le),f=0;f<u;f++)l=s[f],ge.test(l.type||"")&&!Y.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&!l.noModule&&w._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):x(l.textContent.replace(je,""),l,c))}return e}function Pe(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(ye(r)),r.parentNode&&(n&&ie(r)&&me(ye(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(a=ye(c),r=0,i=(o=ye(e)).length;r<i;r++)s=o[r],u=a[r],l=void 0,"input"===(l=u.nodeName.toLowerCase())&&de.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ye(e),a=a||ye(c),r=0,i=o.length;r<i;r++)He(o[r],a[r]);else He(e,c);return(a=ye(c,"script")).length>0&&me(a,!f&&ye(e,"script")),c},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Pe(this,e,!0)},remove:function(e){return Pe(this,e)},text:function(e){return B(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Oe(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||De(this,e).appendChild(e)})},prepend:function(){return Oe(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=De(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Oe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Oe(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return B(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!ve[(he.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Oe(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}});var Re=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Me=/^--/,Ie=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},We=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Fe=new RegExp(ne.join("|"),"i"),$e=new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g");function Be(e,t,n){var r,i,o,a,s=Me.test(t),u=e.style;return(n=n||Ie(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace($e,"$1")||void 0),""!==a||ie(e)||(a=w.style(e,t)),!h.pixelBoxStyles()&&Re.test(a)&&Fe.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(l).appendChild(c);var e=t.getComputedStyle(c);r="1%"!==e.top,u=12===n(e.marginLeft),c.style.right="60%",a=36===n(e.right),i=36===n(e.width),c.style.position="absolute",o=12===n(c.offsetWidth/3),re.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var r,i,o,a,s,u,l=y.createElement("div"),c=y.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(h,{boxSizingReliable:function(){return e(),i},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),o},reliableTrDimensions:function(){var e,n,r,i;return null==s&&(e=y.createElement("table"),n=y.createElement("tr"),r=y.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="border:1px solid",n.style.height="1px",r.style.height="9px",r.style.display="block",re.appendChild(e).appendChild(n).appendChild(r),i=t.getComputedStyle(n),s=parseInt(i.height,10)+parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)===n.offsetHeight,re.removeChild(e)),s}}))}();var ze=["Webkit","Moz","ms"],Ue=y.createElement("div").style,Xe={};function Ve(e){var t=w.cssProps[e]||Xe[e];return t||(e in Ue?e:Xe[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=ze.length;n--;)if((e=ze[n]+t)in Ue)return e}(e)||e)}var Ge=/^(none|table(?!-c[ea]).+)/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=w.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=w.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=w.css(e,"border"+ne[a]+"Width",!0,i))):(u+=w.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=w.css(e,"border"+ne[a]+"Width",!0,i):s+=w.css(e,"border"+ne[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Ie(e),i=(!h.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Re.test(a)){if(!n)return a;a="auto"}return(!h.boxSizingReliable()&&i||!h.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===w.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===w.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Me.test(t),l=e.style;if(u||(t=Ve(s)),a=w.cssHooks[t]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(w.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Me.test(t)||(t=Ve(s)),(a=w.cssHooks[t]||w.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!Ge.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,t,r):We(e,Ye,function(){return Ze(e,t,r)})},set:function(e,n,r){var i,o=Ie(e),a=!h.scrollboxSize()&&"absolute"===o.position,s=(a||r)&&"border-box"===w.css(e,"boxSizing",!1,o),u=r?Ke(e,t,r,s,o):0;return s&&a&&(u-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ke(e,t,"border",!1,o)-.5)),u&&(i=te.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Je(0,n,u)}}}),w.cssHooks.marginLeft=_e(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-We(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+ne[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Je)}),w.fn.extend({css:function(e,t){return B(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Ie(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}}),w.Tween=et,et.prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ve(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=et.prototype.init,w.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){nt&&(!1===y.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(ot):t.setTimeout(ot,w.fx.interval),w.fx.tick())}function at(){return t.setTimeout(function(){tt=void 0}),tt=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(e,t,n){var r,i,o=0,a=lt.prefilters.length,s=w.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=tt||at(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||at(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=w.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);o<a;o++)if(r=lt.prefilters[o].call(l,e,c,l.opts))return g(r.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,ut,l),g(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){g(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=w._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,w.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||w.style(e,r)}if((u=!w.isEmptyObject(t))||!w.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=w.css(e,"display"))&&(l?c=l:(ce([e],!0),l=e.style.display||l,c=w.css(e,"display"),ce([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&ce([e],!0),p.done(function(){for(r in g||ce([e]),Y.remove(e,"fxshow"),d)w.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||g(e)&&e,duration:e,easing:n&&t||t&&!g(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),a=function(){var t=lt(this,w.extend({},e),o);(i||Y.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,a=Y.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&it.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=Y.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,r,i)}}),w.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),tt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){nt||(nt=!0,ot())},w.fx.stop=function(){nt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(e,n){return e=w.fx&&w.fx.speeds[e]||e,n=n||"fx",this.queue(n,function(n,r){var i=t.setTimeout(n,e);r.stop=function(){t.clearTimeout(i)}})},function(){var e=y.createElement("input"),t=y.createElement("select").appendChild(y.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=y.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var ct,ft=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return B(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)for(;n=i[r++];)e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ft[t]||w.find.attr;ft[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ft[a],ft[a]=i,i=null!=n(e,t,r)?a:null,ft[a]=o),i}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}w.fn.extend({prop:function(e,t){return B(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),h.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.fn.extend({addClass:function(e){var t,n,r,i,o,a;return g(e)?this.each(function(t){w(this).addClass(e.call(this,t,gt(this)))}):(t=vt(e)).length?this.each(function(){if(r=gt(this),n=1===this.nodeType&&" "+ht(r)+" "){for(o=0;o<t.length;o++)i=t[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=ht(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(e){var t,n,r,i,o,a;return g(e)?this.each(function(t){w(this).removeClass(e.call(this,t,gt(this)))}):arguments.length?(t=vt(e)).length?this.each(function(){if(r=gt(this),n=1===this.nodeType&&" "+ht(r)+" "){for(o=0;o<t.length;o++)for(i=t[o];n.indexOf(" "+i+" ")>-1;)n=n.replace(" "+i+" "," ");a=ht(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(e,t){var n,r,i,o,a=typeof e,s="string"===a||Array.isArray(e);return g(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,gt(this),t),t)}):"boolean"==typeof t&&s?t?this.addClass(e):this.removeClass(e):(n=vt(e),this.each(function(){if(s)for(o=w(this),i=0;i<n.length;i++)r=n[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==e&&"boolean"!==a||((r=gt(this))&&Y.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":Y.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+ht(gt(n))+" ").indexOf(t)>-1)return!0;return!1}});var yt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];return arguments.length?(r=g(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))})):i?(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(yt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:ht(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=w(n).val(),a)return t;s.push(t)}return s},set:function(e,t){for(var n,r,i=e.options,o=w.makeArray(t),a=i.length;a--;)((r=i[a]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},h.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),h.focusin="onfocusin"in t;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(e,n,r,i){var o,a,s,u,l,c,p,d,h=[r||y],m=f.call(e,"type")?e.type:e,x=f.call(e,"namespace")?e.namespace.split("."):[];if(a=d=s=r=r||y,3!==r.nodeType&&8!==r.nodeType&&!mt.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(x=m.split("."),m=x.shift(),x.sort()),l=m.indexOf(":")<0&&"on"+m,(e=e[w.expando]?e:new w.Event(m,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=x.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),n=null==n?[e]:w.makeArray(n,[e]),p=w.event.special[m]||{},i||!p.trigger||!1!==p.trigger.apply(r,n))){if(!i&&!p.noBubble&&!v(r)){for(u=p.delegateType||m,mt.test(u+m)||(a=a.parentNode);a;a=a.parentNode)h.push(a),s=a;s===(r.ownerDocument||y)&&h.push(s.defaultView||s.parentWindow||t)}for(o=0;(a=h[o++])&&!e.isPropagationStopped();)d=a,e.type=o>1?u:p.bindType||m,(c=(Y.get(a,"events")||Object.create(null))[e.type]&&Y.get(a,"handle"))&&c.apply(a,n),(c=l&&a[l])&&c.apply&&V(a)&&(e.result=c.apply(a,n),!1===e.result&&e.preventDefault());return e.type=m,i||e.isDefaultPrevented()||p._default&&!1!==p._default.apply(h.pop(),n)||!V(r)||l&&g(r[m])&&!v(r)&&((s=r[l])&&(r[l]=null),w.event.triggered=m,e.isPropagationStopped()&&d.addEventListener(m,xt),r[m](),e.isPropagationStopped()&&d.removeEventListener(m,xt),w.event.triggered=void 0,s&&(r[l]=s)),e.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),h.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,i=Y.access(r,t);i||r.addEventListener(e,n,!0),Y.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,i=Y.access(r,t)-1;i?Y.access(r,t,i):(r.removeEventListener(e,n,!0),Y.remove(r,t))}}});var bt=t.location,wt={guid:Date.now()},Tt=/\?/;w.parseXML=function(e){var n,r;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(i){}return r=n&&n.getElementsByTagName("parsererror")[0],n&&!r||w.error("Invalid XML: "+(r?w.map(r.childNodes,function(e){return e.textContent}).join("\n"):e)),n};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(e,t,n,r){var i;if(Array.isArray(t))w.each(t,function(t,i){n||Ct.test(e)?r(e,i):At(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==b(t))r(e,t);else for(i in t)At(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=g(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!de.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=y.createElement("a");function It(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(P)||[];if(g(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Wt(e,t,n,r){var i={},o=e===Pt;function a(s){var u;return i[s]=!0,w.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function Ft(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}Mt.href=bt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,w.ajaxSettings),t):Ft(w.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var r,i,o,a,s,u,l,c,f,p,d=w.ajaxSetup({},n),h=d.context||d,g=d.context&&(h.nodeType||h.jquery)?w(h):w.event,v=w.Deferred(),m=w.Callbacks("once memory"),x=d.statusCode||{},b={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(l){if(!a)for(a={};t=qt.exec(o);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return l?o:null},setRequestHeader:function(e,t){return null==l&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==l&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(l)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return r&&r.abort(t),S(0,t),this}};if(v.promise(E),d.url=((e||d.url||bt.href)+"").replace(Ht,bt.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(P)||[""],null==d.crossDomain){u=y.createElement("a");try{u.href=d.url,u.href=u.href,d.crossDomain=Mt.protocol+"//"+Mt.host!=u.protocol+"//"+u.host}catch(k){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=w.param(d.data,d.traditional)),Wt(Ot,d,n,E),l)return E;for(f in(c=w.event&&d.global)&&0==w.active++&&w.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Lt.test(d.type),i=d.url.replace(jt,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Nt,"+")):(p=d.url.slice(i.length),d.data&&(d.processData||"string"==typeof d.data)&&(i+=(Tt.test(i)?"&":"?")+d.data,delete d.data),!1===d.cache&&(i=i.replace(Dt,"$1"),p=(Tt.test(i)?"&":"?")+"_="+wt.guid+++p),d.url=i+p),d.ifModified&&(w.lastModified[i]&&E.setRequestHeader("If-Modified-Since",w.lastModified[i]),w.etag[i]&&E.setRequestHeader("If-None-Match",w.etag[i])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&E.setRequestHeader("Content-Type",d.contentType),E.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Rt+"; q=0.01":""):d.accepts["*"]),d.headers)E.setRequestHeader(f,d.headers[f]);if(d.beforeSend&&(!1===d.beforeSend.call(h,E,d)||l))return E.abort();if(C="abort",m.add(d.complete),E.done(d.success),E.fail(d.error),r=Wt(Pt,d,n,E)){if(E.readyState=1,c&&g.trigger("ajaxSend",[E,d]),l)return E;d.async&&d.timeout>0&&(s=t.setTimeout(function(){E.abort("timeout")},d.timeout));try{l=!1,r.send(b,S)}catch(k){if(l)throw k;S(-1,k)}}else S(-1,"No Transport");function S(e,n,a,u){var f,p,y,b,T,C=n;l||(l=!0,s&&t.clearTimeout(s),r=void 0,o=u||"",E.readyState=e>0?4:0,f=e>=200&&e<300||304===e,a&&(b=function(e,t,n){for(var r,i,o,a,s=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(d,E,a)),!f&&w.inArray("script",d.dataTypes)>-1&&w.inArray("json",d.dataTypes)<0&&(d.converters["text script"]=function(){}),b=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(k){return{state:"parsererror",error:a?k:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(d,b,E,f),f?(d.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[i]=T),(T=E.getResponseHeader("etag"))&&(w.etag[i]=T)),204===e||"HEAD"===d.type?C="nocontent":304===e?C="notmodified":(C=b.state,p=b.data,f=!(y=b.error))):(y=C,!e&&C||(C="error",e<0&&(e=0))),E.status=e,E.statusText=(n||C)+"",f?v.resolveWith(h,[p,C,E]):v.rejectWith(h,[E,C,y]),E.statusCode(x),x=void 0,c&&g.trigger(f?"ajaxSuccess":"ajaxError",[E,d,f?p:y]),m.fireWith(h,[E,C]),c&&(g.trigger("ajaxComplete",[E,d]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var $t={0:200,1223:204},Bt=w.ajaxSettings.xhr();h.cors=!!Bt&&"withCredentials"in Bt,h.ajax=Bt=!!Bt,w.ajaxTransport(function(e){var n,r;if(h.cors||Bt&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o($t[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(u){if(n)throw u}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,i){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),y.head.appendChild(t[0])},abort:function(){n&&n()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||w.expando+"_"+wt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(e,n,r){var i,o,a,s=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=g(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Ut,"$1"+i):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=t[i],t[i]=function(){a=arguments},r.always(function(){void 0===o?w(t).removeProp(i):t[i]=o,e[i]&&(e.jsonpCallback=n.jsonpCallback,zt.push(i)),a&&g(o)&&o(a[0]),a=o=void 0}),"script"}),h.createHTMLDocument=((_t=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(h.createHTMLDocument?((r=(t=y.implementation.createHTMLDocument("")).createElement("base")).href=y.location.href,t.head.appendChild(r)):t=y),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=be([e],t,o),o&&o.length&&w(o).remove(),w.merge([],i.childNodes)));var r,i,o},w.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=ht(e.slice(s)),e=e.slice(0,s)),g(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=w.css(e,"position"),c=w(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=w.css(e,"top"),u=w.css(e,"left"),("absolute"===l||"fixed"===l)&&(o+u).indexOf("auto")>-1?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||re})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return B(this,function(e,r,i){var o;if(v(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=_e(h.pixelPosition,function(e,n){if(n)return n=Be(e,t),Re.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return B(this,function(t,n,i){var o;return v(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}});var Xt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(o.call(arguments)))}).guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=A,w.isFunction=g,w.isWindow=v,w.camelCase=X,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Xt,"$1")},"function"==typeof e&&e.amd&&e("jquery",[],function(){return w});var Vt=t.jQuery,Gt=t.$;return w.noConflict=function(e){return t.$===w&&(t.$=Gt),e&&t.jQuery===w&&(t.jQuery=Vt),w},void 0===n&&(t.jQuery=t.$=w),w});
},{"process":"g5IB"}],"VOc0":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var t=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.DecodeBase64StringError=exports.CONSTANTS=void 0,exports.areCookiesEnabled=V,exports.assertionError=exports.assert=void 0,exports.async=ft,exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=void 0,exports.calculateBackoffMillis=Ct,exports.contains=Y,exports.createMockUserToken=O,exports.createSubscribe=ht,exports.decode=void 0,exports.deepCopy=l,exports.deepEqual=rt,exports.deepExtend=p,exports.errorPrefix=bt,exports.extractQuerystring=at,exports.getExperimentalSetting=exports.getDefaults=exports.getDefaultEmulatorHostnameAndPort=exports.getDefaultEmulatorHost=exports.getDefaultAppConfig=void 0,exports.getGlobal=b,exports.getModularInstance=Tt,exports.getUA=C,exports.isAdmin=void 0,exports.isBrowser=T,exports.isBrowserExtension=N,exports.isElectron=j,exports.isEmpty=tt,exports.isIE=B,exports.isIndexedDBAvailable=L,exports.isMobileCordova=D,exports.isNode=w,exports.isNodeSdk=I,exports.isReactNative=M,exports.isSafari=P,exports.isUWP=k,exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=void 0,exports.jsonEval=H,exports.map=et,exports.ordinal=Dt,exports.promiseWithTimeout=nt,exports.querystring=st,exports.querystringDecode=it,exports.safeGet=Z,exports.stringToByteArray=exports.stringLength=void 0,exports.stringify=J,exports.validateArgCount=exports.uuidv4=void 0,exports.validateCallback=_t,exports.validateContextObject=gt,exports.validateIndexedDBOpenable=R,exports.validateNamespace=xt;const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=r;const o=function(t,e){if(!t)throw n(e)};exports.assert=o;const n=function(t){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=n;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let n=t.charCodeAt(o);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++o)),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128)}return e},i=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const n=t[r++];if(n<128)e[o++]=String.fromCharCode(n);else if(n>191&&n<224){const s=t[r++];e[o++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(s>>10)),e[o++]=String.fromCharCode(56320+(1023&s))}else{const s=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&i)}}return e.join("")},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let n=0;n<t.length;n+=3){const e=t[n],s=n+1<t.length,i=s?t[n+1]:0,a=n+2<t.length,c=a?t[n+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|c>>6,l=63&c;a||(l=64,s||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):i(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let n=0;n<t.length;){const e=r[t.charAt(n++)],s=n<t.length?r[t.charAt(n)]:0,i=++n<t.length?r[t.charAt(n)]:64,a=++n<t.length?r[t.charAt(n)]:64;if(++n,null==e||null==s||null==i||null==a)throw new c;const h=e<<2|s>>4;if(o.push(h),64!==i){const t=s<<4&240|i>>2;if(o.push(t),64!==a){const t=i<<6&192|a;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};exports.base64=a;class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}exports.DecodeBase64StringError=c;const h=function(t){const e=s(t);return a.encodeByteArray(e,!0)};exports.base64Encode=h;const u=function(t){return h(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=u;const f=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&d(r)&&(t[r]=p(t[r],e[r]));return t}function d(t){return"__proto__"!==t}function b(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.base64Decode=f;const x=()=>b().__FIREBASE_DEFAULTS__,_=()=>{if(void 0===e||void 0===e.env)return},g=()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const e=t&&f(t[1]);return e&&JSON.parse(e)},y=()=>{try{return x()||_()||g()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}};exports.getDefaults=y;const v=t=>{var e,r;return null===(r=null===(e=y())||void 0===e?void 0:e.emulatorHosts)||void 0===r?void 0:r[t]};exports.getDefaultEmulatorHost=v;const E=t=>{const e=v(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(r+1),10);return"["===e[0]?[e.substring(1,r-1),o]:[e.substring(0,r),o]};exports.getDefaultEmulatorHostnameAndPort=E;const m=()=>{var t;return null===(t=y())||void 0===t?void 0:t.config};exports.getDefaultAppConfig=m;const S=t=>{var e;return null===(e=y())||void 0===e?void 0:e[`_${t}`]};exports.getExperimentalSetting=S;class A{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function O(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,n=t.sub||t.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(s)),""].join(".")}function C(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function D(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C())}function w(){var e;const r=null===(e=y())||void 0===e?void 0:e.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(o){return!1}}function T(){return"object"==typeof self&&self.self===self}function N(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function M(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function j(){return C().indexOf("Electron/")>=0}function B(){const t=C();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function k(){return C().indexOf("MSAppHost/")>=0}function I(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function P(){return!w()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){try{return"object"==typeof indexedDB}catch(t){return!1}}function R(){return new Promise((t,e)=>{try{let o=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=(()=>{s.result.close(),o||self.indexedDB.deleteDatabase(n),t(!0)}),s.onupgradeneeded=(()=>{o=!1}),s.onerror=(()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function V(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}exports.Deferred=A;const F="FirebaseError";class U extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=F,Object.setPrototypeOf(this,U.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,W.prototype.create)}}exports.FirebaseError=U;class W{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,n=this.errors[t],s=n?$(n,r):"Error",i=`${this.serviceName}: ${s} (${o}).`;return new U(o,i,r)}}function $(t,e){return t.replace(z,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=W;const z=/\{\$([^}]+)}/g;function H(t){return JSON.parse(t)}function J(t){return JSON.stringify(t)}const q=function(t){let e={},r={},o={},n="";try{const i=t.split(".");e=H(f(i[0])||""),r=H(f(i[1])||""),n=i[2],o=r.d||{},delete r.d}catch(s){}return{header:e,claims:r,data:o,signature:n}};exports.decode=q;const G=function(t){const e=q(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,n=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),n=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!n&&r>=o&&r<=n};exports.isValidTimestamp=G;const K=function(t){const e=q(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=K;const X=function(t){const e=q(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=X;const Q=function(t){const e=q(t).claims;return"object"==typeof e&&!0===e.admin};function Y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function tt(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function et(t,e,r){const o={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=e.call(r,t[n],n,t));return o}function rt(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const n of r){if(!o.includes(n))return!1;const r=t[n],s=e[n];if(ot(r)&&ot(s)){if(!rt(r,s))return!1}else if(r!==s)return!1}for(const n of o)if(!r.includes(n))return!1;return!0}function ot(t){return null!==t&&"object"==typeof t}function nt(t,e=2e3){const r=new A;return setTimeout(()=>r.reject("timeout!"),e),t.then(r.resolve,r.reject),r.promise}function st(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function it(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function at(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=Q;class ct{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,n,s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=c^i&(a^c),n=1518500249):(o=i^a^c,n=1859775393):u<60?(o=i&a|c&(i|a),n=2400959708):(o=i^a^c,n=3395469782);const t=(s<<5|s>>>27)+o+h+n+r[u]&4294967295;h=c,c=a,a=4294967295&(i<<30|i>>>2),i=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const n=this.buf_;let s=this.inbuf_;for(;o<e;){if(0===s)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(n[s]=t.charCodeAt(o),++o,++s===this.blockSize){this.compress_(n),s=0;break}}else for(;o<e;)if(n[s]=t[o],++o,++s===this.blockSize){this.compress_(n),s=0;break}}this.inbuf_=s,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function ht(t,e){const r=new ut(t,e);return r.subscribe.bind(r)}exports.Sha1=ct;class ut{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=lt(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=pt),void 0===o.error&&(o.error=pt),void 0===o.complete&&(o.complete=pt);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),n}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ft(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function lt(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function pt(){}const dt=function(t,e,r,o){let n;if(o<e?n="at least "+e:o>r&&(n=0===r?"none":"no more than "+r),n){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")}};function bt(t,e){return`${t} failed: ${e} argument `}function xt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(bt(t,"namespace")+"must be a valid firebase namespace.")}function _t(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(bt(t,e)+"must be a valid function.")}function gt(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(bt(t,e)+"must be a valid context object.")}exports.validateArgCount=dt;const yt=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s>=55296&&s<=56319){const e=s-55296;o(++n<t.length,"Surrogate pair missing trail surrogate."),s=65536+(e<<10)+(t.charCodeAt(n)-56320)}s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):s<65536?(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e};exports.stringToByteArray=yt;const vt=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=vt;const Et=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})};exports.uuidv4=Et;const mt=1e3,St=2,At=144e5;exports.MAX_VALUE_MILLIS=At;const Ot=.5;function Ct(t,e=mt,r=St){const o=e*Math.pow(r,t),n=Math.round(Ot*o*(Math.random()-.5)*2);return Math.min(At,o+n)}function Dt(t){return Number.isFinite(t)?t+wt(t):`${t}`}function wt(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function Tt(t){return t&&t._delegate?t._delegate:t}exports.RANDOM_FACTOR=Ot;
},{"process":"g5IB"}],"bXWY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("@firebase/util");class e{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}exports.Component=e;const n="[DEFAULT]";class i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const e=new t.Deferred;if(this.instancesDeferred.set(n,e),this.isInitialized(n)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:n});t&&e.resolve(t)}catch(i){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(r(t))try{this.getOrInitializeService({instanceIdentifier:n})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t=n){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=n){return this.instances.has(t)}getOptions(t=n){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:s(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}return n||null}normalizeInstanceIdentifier(t=n){return this.component?this.component.multipleInstances?t:n:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function s(t){return t===n?void 0:t}function r(t){return"EAGER"===t.instantiationMode}exports.Provider=i;class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}exports.ComponentContainer=o;
},{"@firebase/util":"VOc0"}],"uNCT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0,exports.setLogLevel=i,exports.setUserLogHandler=g;const e=[];var r;exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"yLTS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.i=exports.a=void 0,exports.r=v,exports.u=void 0,exports.w=I;const e=(e,t)=>t.some(t=>e instanceof t);let t,r;function n(){return t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o(){return r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}exports.i=e;const s=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap;function p(e){const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{t(I(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&s.set(t,e)}).catch(()=>{}),u.set(t,e),t}function f(e){if(i.has(e))return;const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});i.set(e,t)}exports.a=u;let d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return I(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function v(e){d=e(d)}function D(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?o().includes(e)?function(...t){return e.apply(B(this),t),I(s.get(this))}:function(...t){return I(e.apply(B(this),t))}:function(t,...r){const n=e.call(B(this),t,...r);return a.set(n,t.sort?t.sort():[t]),I(n)}}function m(t){return"function"==typeof t?D(t):(t instanceof IDBTransaction&&f(t),e(t,n())?new Proxy(t,d):t)}function I(e){if(e instanceof IDBRequest)return p(e);if(c.has(e))return c.get(e);const t=m(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const B=e=>u.get(e);exports.u=B;
},{}],"ZUep":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteDB=n,exports.openDB=t,Object.defineProperty(exports,"unwrap",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"wrap",{enumerable:!0,get:function(){return e.w}});var e=require("./wrap-idb-value.js");function t(t,n,{blocked:r,upgrade:o,blocking:d,terminated:i}={}){const s=indexedDB.open(t,n),a=(0,e.w)(s);return o&&s.addEventListener("upgradeneeded",t=>{o((0,e.w)(s.result),t.oldVersion,t.newVersion,(0,e.w)(s.transaction))}),r&&s.addEventListener("blocked",()=>r()),a.then(e=>{i&&e.addEventListener("close",()=>i()),d&&e.addEventListener("versionchange",()=>d())}).catch(()=>{}),a}function n(t,{blocked:n}={}){const r=indexedDB.deleteDatabase(t);return n&&r.addEventListener("blocked",()=>n()),(0,e.w)(r).then(()=>void 0)}const r=["get","getKey","getAll","getAllKeys","count"],o=["put","add","delete","clear"],d=new Map;function i(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(d.get(t))return d.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,s=o.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!r.includes(n))return;const a=async function(e,...t){const r=this.transaction(e,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&r.done]))[0]};return d.set(t,a),a}(0,e.r)(e=>({...e,get:(t,n,r)=>i(t,n)||e.get(t,n,r),has:(t,n)=>!!i(t,n)||e.has(t,n)}));
},{"./wrap-idb-value.js":"yLTS"}],"qn02":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0,exports._addComponent=L,exports._addOrOverwriteComponent=M,exports._apps=void 0,exports._clearComponents=V,exports._components=void 0,exports._getProvider=U,exports._registerComponent=T,exports._removeServiceInstance=R,exports.deleteApp=Q,exports.getApp=Y,exports.getApps=G,exports.initializeApp=W,exports.onLog=Z,exports.registerVersion=X,exports.setLogLevel=ee;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util"),r=require("idb");class n{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(i(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function i(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const s="@firebase/app",o="0.9.5",c=new t.Logger("@firebase/app"),p="@firebase/app-compat",h="@firebase/analytics-compat",l="@firebase/analytics",f="@firebase/app-check-compat",d="@firebase/app-check",b="@firebase/auth",g="@firebase/auth-compat",u="@firebase/database",m="@firebase/database-compat",_="@firebase/functions",w="@firebase/functions-compat",v="@firebase/installations",D="@firebase/installations-compat",C="@firebase/messaging",E="@firebase/messaging-compat",y="@firebase/performance",x="@firebase/performance-compat",I="@firebase/remote-config",S="@firebase/remote-config-compat",P="@firebase/storage",O="@firebase/storage-compat",A="@firebase/firestore",$="@firebase/firestore-compat",N="firebase",F="9.18.0",j="[DEFAULT]";exports._DEFAULT_ENTRY_NAME=j;const k={[s]:"fire-core",[p]:"fire-core-compat",[l]:"fire-analytics",[h]:"fire-analytics-compat",[d]:"fire-app-check",[f]:"fire-app-check-compat",[b]:"fire-auth",[g]:"fire-auth-compat",[u]:"fire-rtdb",[m]:"fire-rtdb-compat",[_]:"fire-fn",[w]:"fire-fn-compat",[v]:"fire-iid",[D]:"fire-iid-compat",[C]:"fire-fcm",[E]:"fire-fcm-compat",[y]:"fire-perf",[x]:"fire-perf-compat",[I]:"fire-rc",[S]:"fire-rc-compat",[P]:"fire-gcs",[O]:"fire-gcs-compat",[A]:"fire-fst",[$]:"fire-fst-compat","fire-js":"fire-js",[N]:"fire-js-all"},B=new Map;exports._apps=B;const H=new Map;function L(e,t){try{e.container.addComponent(t)}catch(a){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function M(e,t){e.container.addOrOverwriteComponent(t)}function T(e){const t=e.name;if(H.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;H.set(t,e);for(const a of B.values())L(a,e);return!0}function U(e,t){const a=e.container.getProvider("heartbeat").getImmediate({optional:!0});return a&&a.triggerHeartbeat(),e.container.getProvider(t)}function R(e,t,a=j){U(e,t).clearInstance(a)}function V(){H.clear()}exports._components=H;const q={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},z=new a.ErrorFactory("app","Firebase",q);class J{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw z.create("app-deleted",{appName:this._name})}}const K=F;function W(t,r={}){let n=t;if("object"!=typeof r){r={name:r}}const i=Object.assign({name:j,automaticDataCollectionEnabled:!1},r),s=i.name;if("string"!=typeof s||!s)throw z.create("bad-app-name",{appName:String(s)});if(n||(n=(0,a.getDefaultAppConfig)()),!n)throw z.create("no-options");const o=B.get(s);if(o){if((0,a.deepEqual)(n,o.options)&&(0,a.deepEqual)(i,o.config))return o;throw z.create("duplicate-app",{appName:s})}const c=new e.ComponentContainer(s);for(const e of H.values())c.addComponent(e);const p=new J(n,i,c);return B.set(s,p),p}function Y(e=j){const t=B.get(e);if(!t&&e===j)return W();if(!t)throw z.create("no-app",{appName:e});return t}function G(){return Array.from(B.values())}async function Q(e){const t=e.name;B.has(t)&&(B.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function X(t,a,r){var n;let i=null!==(n=k[t])&&void 0!==n?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),o=a.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${a}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void c.warn(e.join(" "))}T(new e.Component(`${i}-version`,()=>({library:i,version:a}),"VERSION"))}function Z(e,a){if(null!==e&&"function"!=typeof e)throw z.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function ee(e){(0,t.setLogLevel)(e)}exports.SDK_VERSION="9.18.0";const te="firebase-heartbeat-database",ae=1,re="firebase-heartbeat-store";let ne=null;function ie(){return ne||(ne=(0,r.openDB)(te,ae,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(re)}}}).catch(e=>{throw z.create("idb-open",{originalErrorMessage:e.message})})),ne}async function se(e){try{return(await ie()).transaction(re).objectStore(re).get(ce(e))}catch(t){if(t instanceof a.FirebaseError)c.warn(t.message);else{const e=z.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});c.warn(e.message)}}}async function oe(e,t){try{const n=(await ie()).transaction(re,"readwrite"),i=n.objectStore(re);return await i.put(t,ce(e)),n.done}catch(r){if(r instanceof a.FirebaseError)c.warn(r.message);else{const e=z.create("idb-set",{originalErrorMessage:null==r?void 0:r.message});c.warn(e.message)}}}function ce(e){return`${e.name}!${e.options.appId}`}const pe=1024,he=2592e6;class le{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new be(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=fe();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=he}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=fe(),{heartbeatsToSend:t,unsentEntries:r}=de(this._heartbeatsCache.heartbeats),n=(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}}function fe(){return(new Date).toISOString().substring(0,10)}function de(e,t=pe){const a=[];let r=e.slice();for(const n of e){const e=a.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),ge(a)>t){e.dates.pop();break}}else if(a.push({agent:n.agent,dates:[n.date]}),ge(a)>t){a.pop();break}r=r.slice(1)}return{heartbeatsToSend:a,unsentEntries:r}}class be{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.isIndexedDBAvailable)()&&(0,a.validateIndexedDBOpenable)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){return await se(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}}}function ge(e){return(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:e})).length}function ue(t){T(new e.Component("platform-logger",e=>new n(e),"PRIVATE")),T(new e.Component("heartbeat",e=>new le(e),"PRIVATE")),X(s,o,t),X(s,o,"esm2017"),X("fire-js","")}ue("");
},{"@firebase/component":"bXWY","@firebase/logger":"uNCT","@firebase/util":"VOc0","idb":"ZUep"}],"hLvv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="9.18.0";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"qn02"}],"ygBT":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.default=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.FetchXmlHttpFactory=exports.EventType=exports.Event=exports.ErrorCode=void 0;var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},i={};exports.default=i;var n,s=s||{},r=e||self;function o(){}function h(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function a(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t){return Object.prototype.hasOwnProperty.call(t,u)&&t[u]||(t[u]=++c)}var u="closure_uid_"+(1e9*Math.random()>>>0),c=0;function f(t,e,i){return t.call.apply(t.bind,arguments)}function g(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function p(t,e,i){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:g).apply(null,arguments)}function d(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function y(t,e){function i(){}i.prototype=e.prototype,t.X=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.Wb=function(t,i,n){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[i].apply(t,s)}}function v(){this.s=this.s,this.o=this.o}var m=0;v.prototype.s=!1,v.prototype.na=function(){this.s||(this.s=!0,this.M(),0==m)||l(this)},v.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const b=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function w(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function T(t,e){for(let i=1;i<arguments.length;i++){const e=arguments[i];if(h(e)){const i=t.length||0,n=e.length||0;t.length=i+n;for(let s=0;s<n;s++)t[i+s]=e[s]}else t.push(e)}}function E(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{r.addEventListener("test",o,e),r.removeEventListener("test",o,e)}catch(i){}return t}();function x(t){return/^[\s\xa0]*$/.test(t)}var j=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function C(t,e){return t<e?-1:t>e?1:0}function I(){var t=r.navigator;return t&&(t=t.userAgent)?t:""}function A(t){return-1!=I().indexOf(t)}function R(t){return R[" "](t),t}function O(t){var e=K;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}R[" "]=o;var P,M=A("Opera"),D=A("Trident")||A("MSIE"),L=A("Edge"),X=L||D,k=A("Gecko")&&!(-1!=I().toLowerCase().indexOf("webkit")&&!A("Edge"))&&!(A("Trident")||A("MSIE"))&&!A("Edge"),H=-1!=I().toLowerCase().indexOf("webkit")&&!A("Edge");function _(){var t=r.document;return t?t.documentMode:void 0}t:{var B="",F=function(){var t=I();return k?/rv:([^\);]+)(\)|;)/.exec(t):L?/Edge\/([\d\.]+)/.exec(t):D?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):H?/WebKit\/(\S+)/.exec(t):M?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(F&&(B=F?F[1]:""),D){var N=_();if(null!=N&&N>parseFloat(B)){P=String(N);break t}}P=B}var U,K={};function Y(){return O(function(){let t=0;const e=j(String(P)).split("."),i=j("9").split("."),n=Math.max(e.length,i.length);for(let o=0;0==t&&o<n;o++){var s=e[o]||"",r=i[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=C(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||C(0==s[2].length,0==r[2].length)||C(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t})}if(r.document&&D){var G=_();U=G||(parseInt(P,10)||void 0)}else U=void 0;var J=U;function W(t,e){if(E.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(k){t:{try{R(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:V[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&W.X.h.call(this)}}y(W,E);var V={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),q=0;function z(t,e,i,n,s){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.ha=s,this.key=++q,this.ba=this.ea=!1}function Z(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Q(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function tt(t){const e={};for(const i in t)e[i]=t[i];return e}const et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){let i,n;for(let s=1;s<arguments.length;s++){for(i in n=arguments[s])t[i]=n[i];for(let e=0;e<et.length;e++)i=et[e],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function nt(t){this.src=t,this.g={},this.h=0}function st(t,e){var i=e.type;if(i in t.g){var n,s=t.g[i],r=b(s,e);(n=0<=r)&&Array.prototype.splice.call(s,r,1),n&&(Z(e),0==t.g[i].length&&(delete t.g[i],t.h--))}}function rt(t,e,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ba&&r.listener==e&&r.capture==!!i&&r.ha==n)return s}return-1}nt.prototype.add=function(t,e,i,n,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=rt(t,e,n,s);return-1<o?(e=t[o],i||(e.ea=!1)):((e=new z(e,this.src,r,!!n,s)).ea=i,t.push(e)),e};var ot="closure_lm_"+(1e6*Math.random()|0),ht={};function at(t,e,i,n,s){if(n&&n.once)return ct(t,e,i,n,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)at(t,e[r],i,n,s);return null}return i=mt(i),t&&t[$]?t.N(e,i,a(n)?!!n.capture:!!n,s):lt(t,e,i,!1,n,s)}function lt(t,e,i,n,s,r){if(!e)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,h=yt(t);if(h||(t[ot]=h=new nt(t)),(i=h.add(e,i,n,o,r)).proxy)return i;if(n=ut(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)S||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),n,s);else if(t.attachEvent)t.attachEvent(pt(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return i}function ut(){const t=dt;return function e(i){return t.call(e.src,e.listener,i)}}function ct(t,e,i,n,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)ct(t,e[r],i,n,s);return null}return i=mt(i),t&&t[$]?t.O(e,i,a(n)?!!n.capture:!!n,s):lt(t,e,i,!0,n,s)}function ft(t,e,i,n,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)ft(t,e[r],i,n,s);else n=a(n)?!!n.capture:!!n,i=mt(i),t&&t[$]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(i=rt(r=t.g[e],i,n,s))&&(Z(r[i]),Array.prototype.splice.call(r,i,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=yt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=rt(e,i,n,s)),(i=-1<t?e[t]:null)&&gt(i))}function gt(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[$])st(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(pt(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=yt(e))?(st(i,t),0==i.h&&(i.src=null,e[ot]=null)):Z(t)}}}function pt(t){return t in ht?ht[t]:ht[t]="on"+t}function dt(t,e){if(t.ba)t=!0;else{e=new W(e,this);var i=t.listener,n=t.ha||t.src;t.ea&&gt(t),t=i.call(n,e)}return t}function yt(t){return(t=t[ot])instanceof nt?t:null}var vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function mt(t){return"function"==typeof t?t:(t[vt]||(t[vt]=function(e){return t.handleEvent(e)}),t[vt])}function bt(){v.call(this),this.i=new nt(this),this.P=this,this.I=null}function wt(t,e){var i,n=t.I;if(n)for(i=[];n;n=n.I)i.push(n);if(t=t.P,n=e.type||e,"string"==typeof e)e=new E(e,t);else if(e instanceof E)e.target=e.target||t;else{var s=e;it(e=new E(n,t),s)}if(s=!0,i)for(var r=i.length-1;0<=r;r--){var o=e.g=i[r];s=Tt(o,n,!0,e)&&s}if(s=Tt(o=e.g=t,n,!0,e)&&s,s=Tt(o,n,!1,e)&&s,i)for(r=0;r<i.length;r++)s=Tt(o=e.g=i[r],n,!1,e)&&s}function Tt(t,e,i,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ba&&o.capture==i){var h=o.listener,a=o.ha||o.src;o.ea&&st(t.i,o),s=!1!==h.call(a,n)&&s}}return s&&!n.defaultPrevented}y(bt,v),bt.prototype[$]=!0,bt.prototype.removeEventListener=function(t,e,i,n){ft(this,t,e,i,n)},bt.prototype.M=function(){if(bt.X.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var i=e.g[t],n=0;n<i.length;n++)Z(i[n]);delete e.g[t],e.h--}}this.I=null},bt.prototype.N=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)},bt.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};var Et=r.JSON.stringify;function St(){var t=Mt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class xt{constructor(){this.h=this.g=null}add(t,e){const i=Ct.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var jt,Ct=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new It,t=>t.reset());class It{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function At(t){r.setTimeout(()=>{throw t},0)}function Rt(t,e){jt||Ot(),Pt||(jt(),Pt=!0),Mt.add(t,e)}function Ot(){var t=r.Promise.resolve(void 0);jt=function(){t.then(Dt)}}var Pt=!1,Mt=new xt;function Dt(){for(var t;t=St();){try{t.h.call(t.g)}catch(i){At(i)}var e=Ct;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pt=!1}function Lt(t,e){bt.call(this),this.h=t||1,this.g=e||r,this.j=p(this.lb,this),this.l=Date.now()}function Xt(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function kt(t,e,i){if("function"==typeof t)i&&(t=p(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=p(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function Ht(t){t.g=kt(()=>{t.g=null,t.i&&(t.i=!1,Ht(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}y(Lt,bt),(n=Lt.prototype).ca=!1,n.R=null,n.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),wt(this,"tick"),this.ca&&(Xt(this),this.start()))}},n.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},n.M=function(){Lt.X.M.call(this),Xt(this),delete this.g};class _t extends v{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ht(this)}M(){super.M(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bt(t){v.call(this),this.h=t,this.g={}}y(Bt,v);var Ft=[];function Nt(t,e,i,n){Array.isArray(i)||(i&&(Ft[0]=i.toString()),i=Ft);for(var s=0;s<i.length;s++){var r=at(e,i[s],n||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function Ut(t){Q(t.g,function(t,e){this.g.hasOwnProperty(e)&&gt(t)},t),t.g={}}function Kt(){this.g=!0}function Yt(t,e,i,n,s,r){t.info(function(){if(t.g)if(r)for(var o="",h=r.split("&"),a=0;a<h.length;a++){var l=h[a].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+e+"\n"+i+"\n"+o})}function Gt(t,e,i,n,s,r,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+e+"\n"+i+"\n"+r+" "+o})}function Jt(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Vt(t,i)+(n?" "+n:"")})}function Wt(t,e){t.info(function(){return"TIMEOUT: "+e})}function Vt(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var s=n[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return Et(i)}catch(h){return e}}Bt.prototype.M=function(){Bt.X.M.call(this),Ut(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Kt.prototype.Aa=function(){this.g=!1},Kt.prototype.info=function(){};var $t={},qt=null;function zt(){return qt=qt||new bt}function Zt(t){E.call(this,$t.Pa,t)}function Qt(t){const e=zt();wt(e,new Zt(e))}function te(t,e){E.call(this,$t.STAT_EVENT,t),this.stat=e}function ee(t){const e=zt();wt(e,new te(e,t))}function ie(t,e){E.call(this,$t.Qa,t),this.size=e}function ne(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){t()},e)}$t.Pa="serverreachability",y(Zt,E),$t.STAT_EVENT="statevent",y(te,E),$t.Qa="timingevent",y(ie,E);var se={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},re={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function oe(){}function he(t){return t.h||(t.h=t.i())}function ae(){}oe.prototype.h=null;var le,ue={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function ce(){E.call(this,"d")}function fe(){E.call(this,"c")}function ge(){}function pe(t,e,i,n){this.l=t,this.j=e,this.m=i,this.U=n||1,this.S=new Bt(this),this.O=ye,t=X?125:void 0,this.T=new Lt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new de}function de(){this.i=null,this.g="",this.h=!1}y(ce,E),y(fe,E),y(ge,oe),ge.prototype.g=function(){return new XMLHttpRequest},ge.prototype.i=function(){return{}},le=new ge;var ye=45e3,ve={},me={};function be(t,e,i){t.K=1,t.v=Ne(ke(e)),t.s=i,t.P=!0,we(t,null)}function we(t,e){t.F=Date.now(),xe(t),t.A=ke(t.v);var i=t.A,n=t.U;Array.isArray(n)||(n=[String(n)]),ti(i.i,"t",n),t.C=0,i=t.l.H,t.h=new de,t.g=rn(t.l,i?e:null,!t.s),0<t.N&&(t.L=new _t(p(t.La,t,t.g),t.N)),Nt(t.S,t.g,"readystatechange",t.ib),e=t.H?tt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Qt(),Yt(t.j,t.u,t.A,t.m,t.U,t.s)}function Te(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Da)}function Ee(t,e,i){let n,s=!0;for(;!t.I&&t.C<i.length;){if((n=Se(t,i))==me){4==e&&(t.o=4,ee(14),s=!1),Jt(t.j,t.m,null,"[Incomplete Response]");break}if(n==ve){t.o=4,ee(15),Jt(t.j,t.m,i,"[Invalid Chunk]"),s=!1;break}Jt(t.j,t.m,n,null),Re(t,n)}Te(t)&&n!=me&&n!=ve&&(t.h.g="",t.C=0),4!=e||0!=i.length||t.h.h||(t.o=1,ee(16),s=!1),t.i=t.i&&s,s?0<i.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+i.length),qi(e),e.K=!0,ee(11))):(Jt(t.j,t.m,i,"[Invalid Chunked Response]"),Ae(t),Ie(t))}function Se(t,e){var i=t.C,n=e.indexOf("\n",i);return-1==n?me:(i=Number(e.substring(i,n)),isNaN(i)?ve:(n+=1)+i>e.length?me:(e=e.substr(n,i),t.C=n+i,e))}function xe(t){t.V=Date.now()+t.O,je(t,t.O)}function je(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ne(p(t.gb,t),e)}function Ce(t){t.B&&(r.clearTimeout(t.B),t.B=null)}function Ie(t){0==t.l.G||t.I||Qi(t.l,t)}function Ae(t){Ce(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Xt(t.T),Ut(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Re(t,e){try{var i=t.l;if(0!=i.G&&(i.g==t||ai(i.h,t)))if(!t.J&&ai(i.h,t)&&3==i.G){try{var n=i.Fa.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var s=n;if(0==s[0]){t:if(!i.u){if(i.g){if(!(i.g.F+3e3<t.F))break t;Zi(i),Ni(i)}$i(i),ee(18)}}else i.Ba=s[1],0<i.Ba-i.T&&37500>s[2]&&i.L&&0==i.A&&!i.v&&(i.v=ne(p(i.cb,i),6e3));if(1>=hi(i.h)&&i.ja){try{i.ja()}catch(l){}i.ja=void 0}}else en(i,11)}else if((t.J||i.g==t)&&Zi(i),!x(e))for(s=i.Fa.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(i.T=l[0],l=l[1],2==i.G)if("c"==l[0]){i.I=l[1],i.ka=l[2];const e=l[3];null!=e&&(i.ma=e,i.j.info("VER="+i.ma));const s=l[4];null!=s&&(i.Ca=s,i.j.info("SVER="+i.Ca));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(n=1.5*u,i.J=n,i.j.info("backChannelRequestTimeoutMs_="+n)),n=i;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=n.h;r.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(li(r,r.h),r.h=null))}if(n.D){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.za=t,Fe(n.F,n.D,t))}}i.G=3,i.l&&i.l.xa(),i.$&&(i.P=Date.now()-t.F,i.j.info("Handshake RTT: "+i.P+"ms"));var o=t;if((n=i).sa=sn(n,n.H?n.ka:null,n.V),o.J){ui(n.h,o);var h=o,a=n.J;a&&h.setTimeout(a),h.B&&(Ce(h),xe(h)),n.g=o}else Vi(n);0<i.i.length&&Ki(i)}else"stop"!=l[0]&&"close"!=l[0]||en(i,7);else 3==i.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?en(i,7):Fi(i):"noop"!=l[0]&&i.l&&i.l.wa(l),i.A=0)}Qt(4)}catch(l){}}function Oe(t){if(t.W&&"function"==typeof t.W)return t.W();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}for(n in e=[],i=0,t)e[i++]=t[n];return e}function Pe(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(h(t)||"string"==typeof t){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(const n in t)e[i++]=n;return e}}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var i=Pe(t),n=Oe(t),s=n.length,r=0;r<s;r++)e.call(void 0,n[r],i&&i[r],t)}(n=pe.prototype).setTimeout=function(t){this.O=t},n.ib=function(t){t=t.target;const e=this.L;e&&3==Li(t)?e.l():this.La(t)},n.La=function(t){try{if(t==this.g)t:{const c=Li(this.g);var e=this.g.Ea();const f=this.g.aa();if(!(3>c)&&(3!=c||X||this.g&&(this.h.h||this.g.fa()||Xi(this.g)))){this.I||4!=c||7==e||Qt(8==e||0>=f?3:2),Ce(this);var i=this.g.aa();this.Y=i;e:if(Te(this)){var n=Xi(this.g);t="";var s=n.length,o=4==Li(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ae(this),Ie(this);var h="";break e}this.h.i=new r.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:o&&e==s-1});n.splice(0,s),this.h.g+=t,this.C=0,h=this.h.g}else h=this.g.fa();if(this.i=200==i,Gt(this.j,this.u,this.A,this.m,this.U,c,i),this.i){if(this.Z&&!this.J){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(a)){var u=a;break e}}u=null}if(!(i=u)){this.i=!1,this.o=3,ee(12),Ae(this),Ie(this);break t}Jt(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Re(this,i)}this.P?(Ee(this,c,h),X&&this.i&&3==c&&(Nt(this.S,this.T,"tick",this.hb),this.T.start())):(Jt(this.j,this.m,h,null),Re(this,h)),4==c&&Ae(this),this.i&&!this.I&&(4==c?Qi(this.l,this):(this.i=!1,xe(this)))}else 400==i&&0<h.indexOf("Unknown SID")?(this.o=3,ee(12)):(this.o=0,ee(13)),Ae(this),Ie(this)}}}catch(c){}},n.hb=function(){if(this.g){var t=Li(this.g),e=this.g.fa();this.C<e.length&&(Ce(this),Ee(this,t,e),this.i&&4!=t&&xe(this))}},n.cancel=function(){this.I=!0,Ae(this)},n.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(Wt(this.j,this.A),2!=this.K&&(Qt(),ee(17)),Ae(this),this.o=2,Ie(this)):je(this,this.V-t)};var De=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Le(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),s=null;if(0<=n){var r=t[i].substring(0,n);s=t[i].substring(n+1)}else r=t[i];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Xe(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Xe){this.h=void 0!==e?e:t.h,He(this,t.j),this.s=t.s,this.g=t.g,_e(this,t.m),this.l=t.l,e=t.i;var i=new qe;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),Be(this,i),this.o=t.o}else t&&(i=String(t).match(De))?(this.h=!!e,He(this,i[1]||"",!0),this.s=Ue(i[2]||""),this.g=Ue(i[3]||"",!0),_e(this,i[4]),this.l=Ue(i[5]||"",!0),Be(this,i[6]||"",!0),this.o=Ue(i[7]||"")):(this.h=!!e,this.i=new qe(null,this.h))}function ke(t){return new Xe(t)}function He(t,e,i){t.j=i?Ue(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function _e(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Be(t,e,i){e instanceof qe?(t.i=e,ii(t.i,t.h)):(i||(e=Ke(e,Ve)),t.i=new qe(e,t.h))}function Fe(t,e,i){t.i.set(e,i)}function Ne(t){return Fe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ue(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ke(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,Ye),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ye(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ke(e,Ge,!0),":");var i=this.g;return(i||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ke(e,Ge,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&t.push(":",String(i))),(i=this.l)&&(this.g&&"/"!=i.charAt(0)&&t.push("/"),t.push(Ke(i,"/"==i.charAt(0)?We:Je,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Ke(i,$e)),t.join("")};var Ge=/[#\/\?@]/g,Je=/[#\?:]/g,We=/[#\?]/g,Ve=/[#\?@]/g,$e=/#/g;function qe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ze(t){t.g||(t.g=new Map,t.h=0,t.i&&Le(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function Ze(t,e){ze(t),e=ei(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Qe(t,e){return ze(t),e=ei(t,e),t.g.has(e)}function ti(t,e,i){Ze(t,e),0<i.length&&(t.i=null,t.g.set(ei(t,e),w(i)),t.h+=i.length)}function ei(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function ii(t,e){e&&!t.j&&(ze(t),t.i=null,t.g.forEach(function(t,e){var i=e.toLowerCase();e!=i&&(Ze(this,e),ti(this,i,t))},t)),t.j=e}(n=qe.prototype).add=function(t,e){ze(this),this.i=null,t=ei(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this},n.forEach=function(t,e){ze(this),this.g.forEach(function(i,n){i.forEach(function(i){t.call(e,i,n,this)},this)},this)},n.oa=function(){ze(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){const s=t[n];for(let t=0;t<s.length;t++)i.push(e[n])}return i},n.W=function(t){ze(this);let e=[];if("string"==typeof t)Qe(this,t)&&(e=e.concat(this.g.get(ei(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e},n.set=function(t,e){return ze(this),this.i=null,Qe(this,t=ei(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},n.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];const r=encodeURIComponent(String(n)),o=this.W(n);for(n=0;n<o.length;n++){var s=r;""!==o[n]&&(s+="="+encodeURIComponent(String(o[n]))),t.push(s)}}return this.i=t.join("&")};var ni=class{constructor(t,e){this.h=t,this.g=e}};function si(t){this.l=t||ri,r.PerformanceNavigationTiming?t=0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(r.g&&r.g.Ga&&r.g.Ga()&&r.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ri=10;function oi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function hi(t){return t.h?1:t.g?t.g.size:0}function ai(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function li(t,e){t.g?t.g.add(e):t.h=e}function ui(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ci(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const i of t.g.values())e=e.concat(i.D);return e}return w(t.i)}function fi(){}function gi(){this.g=new fi}function pi(t,e,i){const n=i||"";try{Me(t,function(t,i){let s=t;a(t)&&(s=Et(t)),e.push(n+i+"="+encodeURIComponent(s))})}catch(s){throw e.push(n+"type="+encodeURIComponent("_badmap")),s}}function di(t,e){const i=new Kt;if(r.Image){const n=new Image;n.onload=d(yi,i,n,"TestLoadImage: loaded",!0,e),n.onerror=d(yi,i,n,"TestLoadImage: error",!1,e),n.onabort=d(yi,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=d(yi,i,n,"TestLoadImage: timeout",!1,e),r.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function yi(t,e,i,n,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(n)}catch(r){}}function vi(t){this.l=t.ac||null,this.j=t.jb||!1}function mi(t,e){bt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=bi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}si.prototype.cancel=function(){if(this.i=ci(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},fi.prototype.stringify=function(t){return r.JSON.stringify(t,void 0)},fi.prototype.parse=function(t){return r.JSON.parse(t,void 0)},y(vi,oe),vi.prototype.g=function(){return new mi(this.l,this.j)},vi.prototype.i=function(t){return function(){return t}}({}),y(mi,bt);var bi=0;function wi(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function Ti(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ei(t)}function Ei(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(n=mi.prototype).open=function(t,e){if(this.readyState!=bi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ei(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||r).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Ti(this)),this.readyState=bi},n.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ei(this)),this.g&&(this.readyState=3,Ei(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==r.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wi(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},n.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ti(this):Ei(this),3==this.readyState&&wi(this)}},n.Va=function(t){this.g&&(this.response=this.responseText=t,Ti(this))},n.Ua=function(t){this.g&&(this.response=t,Ti(this))},n.ga=function(){this.g&&Ti(this)},n.setRequestHeader=function(t,e){this.v.append(t,e)},n.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join("\r\n")},Object.defineProperty(mi.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Si=r.JSON.parse;function xi(t){bt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ji,this.K=this.L=!1}y(xi,bt);var ji="",Ci=/^https?$/i,Ii=["POST","PUT"];function Ai(t){return D&&Y()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Ri(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Oi(t),Mi(t)}function Oi(t){t.D||(t.D=!0,wt(t,"complete"),wt(t,"error"))}function Pi(t){if(t.h&&void 0!==s&&(!t.C[1]||4!=Li(t)||2!=t.aa()))if(t.v&&4==Li(t))kt(t.Ha,0,t);else if(wt(t,"readystatechange"),4==Li(t)){t.h=!1;try{const s=t.aa();t:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var i;if(!(i=e)){var n;if(n=0===s){var o=String(t.H).match(De)[1]||null;if(!o&&r.self&&r.self.location){var h=r.self.location.protocol;o=h.substr(0,h.length-1)}n=!Ci.test(o?o.toLowerCase():"")}i=n}if(i)wt(t,"complete"),wt(t,"success");else{t.m=6;try{var a=2<Li(t)?t.g.statusText:""}catch(l){a=""}t.j=a+" ["+t.aa()+"]",Oi(t)}}finally{Mi(t)}}}function Mi(t,e){if(t.g){Di(t);const n=t.g,s=t.C[0]?o:null;t.g=null,t.C=null,e||wt(t,"ready");try{n.onreadystatechange=s}catch(i){}}}function Di(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(r.clearTimeout(t.A),t.A=null)}function Li(t){return t.g?t.g.readyState:0}function Xi(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case ji:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function ki(t){let e="";return Q(t,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function Hi(t,e,i){t:{for(n in i){var n=!1;break t}n=!0}n||(i=ki(i),"string"==typeof t?null!=i&&encodeURIComponent(String(i)):Fe(t,e,i))}function _i(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function Bi(t){this.Ca=0,this.i=[],this.j=new Kt,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=_i("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=_i("baseRetryDelayMs",5e3,t),this.bb=_i("retryDelaySeedMs",1e4,t),this.$a=_i("forwardChannelMaxRetries",2,t),this.ta=_i("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new si(t&&t.concurrentRequestLimit),this.Fa=new gi,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Fi(t){if(Ui(t),3==t.G){var e=t.U++,i=ke(t.F);Fe(i,"SID",t.I),Fe(i,"RID",e),Fe(i,"TYPE","terminate"),Ji(t,i),(e=new pe(t,t.j,e,void 0)).K=2,e.v=Ne(ke(i)),i=!1,r.navigator&&r.navigator.sendBeacon&&(i=r.navigator.sendBeacon(e.v.toString(),"")),!i&&r.Image&&((new Image).src=e.v,i=!0),i||(e.g=rn(e.l,null),e.g.da(e.v)),e.F=Date.now(),xe(e)}nn(t)}function Ni(t){t.g&&(qi(t),t.g.cancel(),t.g=null)}function Ui(t){Ni(t),t.u&&(r.clearTimeout(t.u),t.u=null),Zi(t),t.h.cancel(),t.m&&("number"==typeof t.m&&r.clearTimeout(t.m),t.m=null)}function Ki(t){oi(t.h)||t.m||(t.m=!0,Rt(t.Ja,t),t.C=0)}function Yi(t,e){return!(hi(t.h)>=t.h.j-(t.m?1:0))&&(t.m?(t.i=e.D.concat(t.i),!0):!(1==t.G||2==t.G||t.C>=(t.Za?0:t.$a))&&(t.m=ne(p(t.Ja,t,e),tn(t,t.C)),t.C++,!0))}function Gi(t,e){var i;i=e?e.m:t.U++;const n=ke(t.F);Fe(n,"SID",t.I),Fe(n,"RID",i),Fe(n,"AID",t.T),Ji(t,n),t.o&&t.s&&Hi(n,t.o,t.s),i=new pe(t,t.j,i,t.C+1),null===t.o&&(i.H=t.s),e&&(t.i=e.D.concat(t.i)),e=Wi(t,i,1e3),i.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),li(t.h,i),be(i,n,e)}function Ji(t,e){t.ia&&Q(t.ia,function(t,i){Fe(e,i,t)}),t.l&&Me({},function(t,i){Fe(e,i,t)})}function Wi(t,e,i){i=Math.min(t.i.length,i);var n=t.l?p(t.l.Ra,t.l,t):null;t:{var s=t.i;let e=-1;for(;;){const t=["count="+i];-1==e?0<i?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let h=0;h<i;h++){let i=s[h].h;const a=s[h].g;if(0>(i-=e))e=Math.max(0,s[h].h-100),o=!1;else try{pi(a,t,"req"+i+"_")}catch(r){n&&n(a)}}if(o){n=t.join("&");break t}}}return t=t.i.splice(0,i),e.D=t,n}function Vi(t){t.g||t.u||(t.Z=1,Rt(t.Ia,t),t.A=0)}function $i(t){return!(t.g||t.u||3<=t.A)&&(t.Z++,t.u=ne(p(t.Ia,t),tn(t,t.A)),t.A++,!0)}function qi(t){null!=t.B&&(r.clearTimeout(t.B),t.B=null)}function zi(t){t.g=new pe(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=ke(t.sa);Fe(e,"RID","rpc"),Fe(e,"SID",t.I),Fe(e,"CI",t.L?"0":"1"),Fe(e,"AID",t.T),Fe(e,"TYPE","xmlhttp"),Ji(t,e),t.o&&t.s&&Hi(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var i=t.g;t=t.ka,i.K=1,i.v=Ne(ke(e)),i.s=null,i.P=!0,we(i,t)}function Zi(t){null!=t.v&&(r.clearTimeout(t.v),t.v=null)}function Qi(t,e){var i=null;if(t.g==e){Zi(t),qi(t),t.g=null;var n=2}else{if(!ai(t.h,e))return;i=e.D,ui(t.h,e),n=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==n){i=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;wt(n=zt(),new ie(n,i)),Ki(t)}else Vi(t);else if(3==(s=e.o)||0==s&&0<t.pa||!(1==n&&Yi(t,e)||2==n&&$i(t)))switch(i&&0<i.length&&(e=t.h,e.i=e.i.concat(i)),s){case 1:en(t,5);break;case 4:en(t,10);break;case 3:en(t,6);break;default:en(t,2)}}function tn(t,e){let i=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(i*=2),i*e}function en(t,e){if(t.j.info("Error code "+e),2==e){var i=null;t.l&&(i=null);var n=p(t.kb,t);i||(i=new Xe("//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||He(i,"https"),Ne(i)),di(i.toString(),n)}else ee(2);t.G=0,t.l&&t.l.va(e),nn(t),Ui(t)}function nn(t){if(t.G=0,t.la=[],t.l){const e=ci(t.h);0==e.length&&0==t.i.length||(T(t.la,e),T(t.la,t.i),t.h.i.length=0,w(t.i),t.i.length=0),t.l.ua()}}function sn(t,e,i){var n=i instanceof Xe?ke(i):new Xe(i,void 0);if(""!=n.g)e&&(n.g=e+"."+n.g),_e(n,n.m);else{var s=r.location;n=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new Xe(null,void 0);n&&He(o,n),e&&(o.g=e),s&&_e(o,s),i&&(o.l=i),n=o}return i=t.D,e=t.za,i&&e&&Fe(n,i,e),Fe(n,"VER",t.ma),Ji(t,n),n}function rn(t,e,i){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=i&&t.Da&&!t.ra?new xi(new vi({jb:!0})):new xi(t.ra)).Ka(t.H),e}function on(){}function hn(){if(D&&!(10<=Number(J)))throw Error("Environmental error: no available transport.")}function an(t,e){bt.call(this),this.g=new Bi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!x(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!x(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new cn(this)}function ln(t){ce.call(this);var e=t.__sm__;if(e){t:{for(const i in e){t=i;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function un(){fe.call(this),this.status=1}function cn(t){this.g=t}(n=xi.prototype).Ka=function(t){this.L=t},n.da=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():le.g(),this.C=this.u?he(this.u):he(le),this.g.onreadystatechange=p(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Ri(this,o)}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)i.set(s,n[s]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const t of n.keys())i.set(t,n.get(t))}n=Array.from(i.keys()).find(t=>"content-type"==t.toLowerCase()),s=r.FormData&&t instanceof r.FormData,!(0<=b(Ii,e))||n||s||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[r,h]of i)this.g.setRequestHeader(r,h);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Di(this),0<this.B&&((this.K=Ai(this.g))?(this.g.timeout=this.B,this.g.ontimeout=p(this.qa,this)):this.A=kt(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Ri(this,o)}},n.qa=function(){void 0!==s&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,wt(this,"timeout"),this.abort(8))},n.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,wt(this,"complete"),wt(this,"abort"),Mi(this))},n.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mi(this,!0)),xi.X.M.call(this)},n.Ha=function(){this.s||(this.F||this.v||this.l?Pi(this):this.fb())},n.fb=function(){Pi(this)},n.aa=function(){try{return 2<Li(this)?this.g.status:-1}catch(t){return-1}},n.fa=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},n.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Si(e)}},n.Ea=function(){return this.m},n.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(n=Bi.prototype).ma=8,n.G=1,n.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new pe(this,this.j,t,void 0);let r=this.s;if(this.S&&(r?it(r=tt(r),this.S):r=this.S),null!==this.o||this.N||(s.H=r,r=null),this.O)t:{for(var e=0,i=0;i<this.i.length;i++){var n=this.i[i];if(void 0===(n="__data__"in n.g&&"string"==typeof(n=n.g.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=i;break t}if(4096===e||i===this.i.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wi(this,s,e),Fe(i=ke(this.F),"RID",t),Fe(i,"CVER",22),this.D&&Fe(i,"X-HTTP-Session-Id",this.D),Ji(this,i),r&&(this.N?e="headers="+encodeURIComponent(String(ki(r)))+"&"+e:this.o&&Hi(i,this.o,r)),li(this.h,s),this.Ya&&Fe(i,"TYPE","init"),this.O?(Fe(i,"$req",e),Fe(i,"SID","null"),s.Z=!0,be(s,i,null)):be(s,i,e),this.G=2}}else 3==this.G&&(t?Gi(this,t):0==this.i.length||oi(this.h)||Gi(this))},n.Ia=function(){if(this.u=null,zi(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=ne(p(this.eb,this),t)}},n.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,ee(10),Ni(this),zi(this))},n.cb=function(){null!=this.v&&(this.v=null,Ni(this),$i(this),ee(19))},n.kb=function(t){t?(this.j.info("Successfully pinged google.com"),ee(2)):(this.j.info("Failed to ping google.com"),ee(1))},(n=on.prototype).xa=function(){},n.wa=function(){},n.va=function(){},n.ua=function(){},n.Ra=function(){},hn.prototype.g=function(t,e){return new an(t,e)},y(an,bt),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,i=this.h||void 0;ee(0),t.V=e,t.ia=i||{},t.L=t.Y,t.F=sn(t,null,t.V),Ki(t)},an.prototype.close=function(){Fi(this.g)},an.prototype.u=function(t){var e=this.g;if("string"==typeof t){var i={};i.__data__=t,t=i}else this.v&&((i={}).__data__=Et(t),t=i);e.i.push(new ni(e.ab++,t)),3==e.G&&Ki(e)},an.prototype.M=function(){this.g.l=null,delete this.j,Fi(this.g),delete this.g,an.X.M.call(this)},y(ln,ce),y(un,fe),y(cn,on),cn.prototype.xa=function(){wt(this.g,"a")},cn.prototype.wa=function(t){wt(this.g,new ln(t))},cn.prototype.va=function(t){wt(this.g,new un)},cn.prototype.ua=function(){wt(this.g,"b")},hn.prototype.createWebChannel=hn.prototype.g,an.prototype.send=an.prototype.u,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,se.NO_ERROR=0,se.TIMEOUT=8,se.HTTP_ERROR=6,re.COMPLETE="complete",ae.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",bt.prototype.listen=bt.prototype.N,xi.prototype.listenOnce=xi.prototype.O,xi.prototype.getLastError=xi.prototype.Oa,xi.prototype.getLastErrorCode=xi.prototype.Ea,xi.prototype.getStatus=xi.prototype.aa,xi.prototype.getResponseJson=xi.prototype.Sa,xi.prototype.getResponseText=xi.prototype.fa,xi.prototype.send=xi.prototype.da,xi.prototype.setWithCredentials=xi.prototype.Ka;var fn=i.createWebChannelTransport=function(){return new hn};exports.createWebChannelTransport=fn;var gn=i.getStatEventTarget=function(){return zt()};exports.getStatEventTarget=gn;var pn=i.ErrorCode=se;exports.ErrorCode=pn;var dn=i.EventType=re;exports.EventType=dn;var yn=i.Event=$t;exports.Event=yn;var vn=i.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20};exports.Stat=vn;var mn=i.FetchXmlHttpFactory=vi;exports.FetchXmlHttpFactory=mn;var bn=i.WebChannel=ae;exports.WebChannel=bn;var wn=i.XhrIo=xi;exports.XhrIo=wn;
},{}],"TIij":[function(require,module,exports) {
var define;
var process = require("process");
var e,t=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._FieldPath=exports._EmptyAuthCredentialsProvider=exports._EmptyAppCheckTokenProvider=exports._DocumentKey=exports._DatabaseId=exports.WriteBatch=exports.Transaction=exports.Timestamp=exports.SnapshotMetadata=exports.QueryStartAtConstraint=exports.QuerySnapshot=exports.QueryOrderByConstraint=exports.QueryLimitConstraint=exports.QueryFieldFilterConstraint=exports.QueryEndAtConstraint=exports.QueryDocumentSnapshot=exports.QueryConstraint=exports.QueryCompositeFilterConstraint=exports.Query=exports.LoadBundleTask=exports.GeoPoint=exports.FirestoreError=exports.Firestore=exports.FieldValue=exports.FieldPath=exports.DocumentSnapshot=exports.DocumentReference=exports.CollectionReference=exports.CACHE_SIZE_UNLIMITED=exports.Bytes=exports.AggregateQuerySnapshot=exports.AggregateField=exports.AbstractUserDataWriter=void 0,exports._cast=Xl,exports._debugAssert=J,exports._isBase64Available=ct,exports._logWarn=W,exports._validateIsNotUsedTogether=jl,exports.addDoc=od,exports.aggregateFieldEqual=Gh,exports.aggregateQuerySnapshotEqual=Qh,exports.and=kh,exports.arrayRemove=bd,exports.arrayUnion=xd,exports.average=Bh,exports.clearIndexedDbPersistence=xf,exports.collection=rf,exports.collectionGroup=af,exports.connectFirestoreEmulator=$l,exports.count=Kh,exports.deleteDoc=ud,exports.deleteField=kd,exports.disableNetwork=Tf,exports.doc=uf,exports.documentId=Lf,exports.enableIndexedDbPersistence=gf,exports.enableMultiTabIndexedDbPersistence=kf,exports.enableNetwork=If,exports.endAt=Nh,exports.endBefore=Dh,exports.ensureFirestoreConfigured=pf,exports.executeWrite=ld,exports.getAggregateFromServer=dd,exports.getCountFromServer=hd,exports.getDoc=Jh,exports.getDocFromCache=$h,exports.getDocFromServer=ed,exports.getDocs=td,exports.getDocsFromCache=nd,exports.getDocsFromServer=rd,exports.getFirestore=yf,exports.increment=Id,exports.initializeFirestore=vf,exports.limit=Ih,exports.limitToLast=Th,exports.loadBundle=Sf,exports.namedQuery=_f,exports.onSnapshot=sd,exports.onSnapshotsInSync=cd,exports.or=gh,exports.orderBy=xh,exports.query=vh,exports.queryEqual=sf,exports.refEqual=of,exports.runTransaction=gd,exports.serverTimestamp=wd,exports.setDoc=id,exports.setIndexConfiguration=Ed,exports.setLogLevel=Q,exports.snapshotEqual=Yh,exports.startAfter=_h,exports.startAt=Sh,exports.sum=Uh,exports.terminate=Ef,exports.updateDoc=ad,exports.waitForPendingWrites=bf,exports.where=ph,exports.writeBatch=Td;var n=require("@firebase/app"),r=require("@firebase/component"),i=require("@firebase/logger"),a=require("@firebase/util"),u=require("@firebase/webchannel-wrapper");function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=s(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function c(e,t){return h(e)||f(e,t)||D(e,t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,u,o=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(o.push(r.value),o.length!==t);s=!0);}catch(l){c=!0,i=l}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw i}}return o}}function h(e){if(Array.isArray(e))return e}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||!y(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return v(e,arguments,S(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),x(n,e)})(e)}function v(e,t,n){return(v=E()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&x(i,n.prototype),i}).apply(null,arguments)}function y(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=D(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw a}}}}function m(){"use strict";m=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(D){s=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var a=t&&t.prototype instanceof h?t:h,u=Object.create(a.prototype),o=new S(i||[]);return r(u,"_invoke",{value:b(e,n,o)}),u}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=c;var f={};function h(){}function d(){}function v(){}var y={};s(y,a,function(){return this});var p=Object.getPrototypeOf,g=p&&p(p(_([])));g&&g!==t&&n.call(g,a)&&(y=g);var k=v.prototype=h.prototype=Object.create(y);function w(e){["next","throw","return"].forEach(function(t){s(e,t,function(e){return this._invoke(t,e)})})}function x(e,t){var i;r(this,"_invoke",{value:function(r,a){function u(){return new t(function(i,u){!function r(i,a,u,o){var s=l(e[i],e,a);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==L(f)&&n.call(f,"__await")?t.resolve(f.__await).then(function(e){r("next",e,u,o)},function(e){r("throw",e,u,o)}):t.resolve(f).then(function(e){c.value=e,u(c)},function(e){return r("throw",e,u,o)})}o(s.arg)}(r,a,i,u)})}return i=i?i.then(u,u):u()}})}function b(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return A()}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var o=I(u,n);if(o){if(o===f)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function I(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function _(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return d.prototype=v,r(k,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:d,configurable:!0}),d.displayName=s(v,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,o,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},w(x.prototype),s(x.prototype,u,function(){return this}),e.AsyncIterator=x,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var u=new x(c(t,n,r,i),a);return e.isGeneratorFunction(n)?u:u.next().then(function(e){return e.done?e.value:u.next()})},w(k),s(k,o,"Generator"),s(k,a,function(){return this}),s(k,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=_,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return u.type="throw",u.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var o=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}function g(e,t,n,r,i,a,u){try{var o=e[a](u),s=o.value}catch(c){return void n(c)}o.done?t(s):Promise.resolve(s).then(r,i)}function k(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){g(a,r,i,u,o,"next",e)}function o(e){g(a,r,i,u,o,"throw",e)}u(void 0)})}}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=E();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return T(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e){return C(e)||N(e)||D(e)||A()}function A(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}function N(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e){if(Array.isArray(e))return F(e)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V(r.key),r)}}function O(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function V(e){var t=P(e,"string");return"symbol"===L(t)?t:String(t)}function P(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var q="@firebase/firestore",U=function(){function e(t){R(this,e),this.uid=t}return O(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();U.UNAUTHENTICATED=new U(null),U.GOOGLE_CREDENTIALS=new U("google-credentials-uid"),U.FIRST_PARTY=new U("first-party-uid"),U.MOCK_USER=new U("mock-user");var B="9.18.0",K=new i.Logger("@firebase/firestore");function G(){return K.logLevel}function Q(e){K.setLogLevel(e)}function j(e){if(K.logLevel<=i.LogLevel.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(H);K.debug.apply(K,["Firestore (".concat(B,"): ").concat(e)].concat(_(a)))}}function z(e){if(K.logLevel<=i.LogLevel.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(H);K.error.apply(K,["Firestore (".concat(B,"): ").concat(e)].concat(_(a)))}}function W(e){if(K.logLevel<=i.LogLevel.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(H);K.warn.apply(K,["Firestore (".concat(B,"): ").concat(e)].concat(_(a)))}}function H(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function X(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(B,") INTERNAL ASSERTION FAILED: ")+e;throw z(t),new Error(t)}function Y(e,t){e||X()}function J(e,t){e||X()}function Z(e,t){return e}var $={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ee=function(e){w(n,a.FirebaseError);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return O(n)}();exports.FirestoreError=ee;var te=O(function e(){var t=this;R(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),ne=O(function e(t,n){R(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),re=function(){function e(){R(this,e)}return O(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(U.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}();exports._EmptyAuthCredentialsProvider=re;var ie=function(){function e(t){R(this,e),this.token=t,this.changeListener=null}return O(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),ae=function(){function e(t){R(this,e),this.t=t,this.currentUser=U.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return O(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new te;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new te,e.enqueueRetryable(function(){return i(n.currentUser)})};var u=function(){var t=a;e.enqueueRetryable(k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}},e)})))},o=function(e){j("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),u()};this.t.onInit(function(e){return o(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?o(e):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new te)}},0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Y("string"==typeof n.accessToken),new ne(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Y(null===e||"string"==typeof e),new U(e)}}]),e}(),ue=function(){function e(t,n,r,i){R(this,e),this.h=t,this.l=n,this.m=r,this.g=i,this.type="FirstParty",this.user=U.FIRST_PARTY,this.p=new Map}return O(e,[{key:"I",value:function(){return this.g?this.g():(Y(!("object"!=L(this.h)||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),e}(),oe=function(){function e(t,n,r,i){R(this,e),this.h=t,this.l=n,this.m=r,this.g=i}return O(e,[{key:"getToken",value:function(){return Promise.resolve(new ue(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(U.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),se=O(function e(t){R(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),ce=function(){function e(t){R(this,e),this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}return O(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&j("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,j("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable(function(){return r(t)})};var i=function(e){j("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit(function(e){return i(e)}),setTimeout(function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?i(e):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(Y("string"==typeof t.token),e.A=t.token,new se(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),le=function(){function e(){R(this,e)}return O(e,[{key:"getToken",value:function(){return Promise.resolve(new se(""))}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){}},{key:"shutdown",value:function(){}}]),e}();function fe(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}exports._EmptyAppCheckTokenProvider=le;var he=function(){function e(){R(this,e)}return O(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=fe(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function de(e,t){return e<t?-1:e>t?1:0}function ve(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}function ye(e){return e+"\0"}var pe=function(){function e(t,n){if(R(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new ee($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ee($.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new ee($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ee($.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return O(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?de(this.nanoseconds,e.nanoseconds):de(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}();exports.Timestamp=pe;var me=function(){function e(t){R(this,e),this.timestamp=t}return O(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new pe(0,0))}},{key:"max",value:function(){return new e(new pe(253402300799,999999999))}}]),e}(),ge=function(){function e(t,n,r){R(this,e),void 0===n?n=0:n>t.length&&X(),void 0===r?r=t.length-n:r>t.length-n&&X(),this.segments=t,this.offset=n,this.len=r}return O(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),ke=function(e){w(n,ge);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,u=r;a<u.length;a++){var o=u[a];if(o.indexOf("//")>=0)throw new ee($.INVALID_ARGUMENT,"Invalid segment (".concat(o,"). Paths must not contain // in them."));e.push.apply(e,_(o.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(),we=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xe=function(e){w(n,ge);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return we.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new ee($.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},u=!1;i<e.length;){var o=e[i];if("\\"===o){if(i+1===e.length)throw new ee($.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new ee($.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===o?(u=!u,i++):"."!==o||u?(r+=o,i++):(a(),i++)}if(a(),u)throw new ee($.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}();exports._FieldPath=xe;var be=function(){function e(t){R(this,e),this.path=t}return O(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===ke.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(ke.fromString(t))}},{key:"fromName",value:function(t){return new e(ke.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(ke.emptyPath())}},{key:"comparator",value:function(e,t){return ke.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new ke(t.slice()))}}]),e}();exports._DocumentKey=be;var Ie=O(function e(t,n,r,i){R(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i});function Te(e){return e.fields.find(function(e){return 2===e.kind})}function Ee(e){return e.fields.filter(function(e){return 2!==e.kind})}function Se(e,t){var n=de(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(var r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(0!==(n=Ae(e.fields[r],t.fields[r])))return n;return de(e.fields.length,t.fields.length)}Ie.UNKNOWN_ID=-1;var _e=O(function e(t,n){R(this,e),this.fieldPath=t,this.kind=n});function Ae(e,t){var n=xe.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:de(e.kind,t.kind)}var De=function(){function e(t,n){R(this,e),this.sequenceNumber=t,this.offset=n}return O(e,null,[{key:"empty",value:function(){return new e(0,Fe.min())}}]),e}();function Ne(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=me.fromTimestamp(1e9===r?new pe(n+1,0):new pe(n,r));return new Fe(i,be.empty(),t)}function Ce(e){return new Fe(e.readTime,e.key,-1)}var Fe=function(){function e(t,n,r){R(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return O(e,null,[{key:"min",value:function(){return new e(me.min(),be.empty(),-1)}},{key:"max",value:function(){return new e(me.max(),be.empty(),-1)}}]),e}();function Le(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=be.comparator(e.documentKey,t.documentKey))?n:de(e.largestBatchId,t.largestBatchId)}var Re="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Me=function(){function e(){R(this,e),this.onCommittedListeners=[]}return O(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}();function Oe(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===$.FAILED_PRECONDITION&&t.message===Re){e.next=2;break}throw t;case 2:j("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Pe=function(){function e(t){var n=this;R(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return O(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=p(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),u=0,o=function(){var o=s;n(t[o]).next(function(t){a[o]=t,++u===i&&e(a)},function(e){return r(e)})},s=0;s<i;s++)o()})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}(),qe=function(){function e(t,n){var r=this;R(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.P=new te,this.transaction.oncomplete=function(){r.P.resolve()},this.transaction.onabort=function(){n.error?r.P.reject(new Ke(t,n.error)):r.P.resolve()},this.transaction.onerror=function(e){var n=We(e.target.error);r.P.reject(new Ke(t,n))}}return O(e,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(j("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Qe(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new Ke(n,t)}}}]),e}(),Ue=function(){function e(t,n,r){R(this,e),this.name=t,this.version=n,this.S=r,12.2===e.D((0,a.getUA)())&&z("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return O(e,[{key:"O",value:function(){var e=k(m().mark(function e(t){var n=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return j("SimpleDb","Opening database:",this.name),e.next=5,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Ke(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ee($.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new ee($.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Ke(t,n))},i.onupgradeneeded=function(e){j("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.F(t,i.transaction,e.oldVersion,n.version).next(function(){j("SimpleDb","Database upgrade to version "+n.version+" complete")})}});case 5:this.db=e.sent;case 6:return this.B&&(this.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=k(m().mark(function e(t,n,r,i){var a,u,o,s,c=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,u=0,o=m().mark(function e(){var n,o,s,l;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return++u,e.prev=1,e.next=4,c.O(t);case 4:return c.db=e.sent,n=qe.open(c.db,t,a?"readonly":"readwrite",r),(o=i(n).next(function(e){return n.V(),e}).catch(function(e){return n.abort(e),Pe.reject(e)}).toPromise()).catch(function(){}),e.next=9,n.v;case 9:return e.t0=o,e.abrupt("return",{v:e.t0});case 13:if(e.prev=13,e.t1=e.catch(1),s=e.t1,l="FirebaseError"!==s.name&&u<3,j("SimpleDb","Transaction failed with error:",s.message,"Retrying:",l),c.close(),l){e.next=18;break}return e.abrupt("return",{v:Promise.reject(s)});case 18:case"end":return e.stop()}},e,null,[[1,13]])});case 3:return e.delegateYield(o(),"t0",4);case 4:if("object"!==L(s=e.t0)){e.next=7;break}return e.abrupt("return",s.v);case 7:e.next=3;break;case 9:case"end":return e.stop()}},e)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return j("SimpleDb","Removing database:",e),je(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!(0,a.isIndexedDBAvailable)())return!1;if(e.N())return!0;var t=(0,a.getUA)(),n=e.D(t),r=0<n&&n<10,i=e.k(t),u=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||u)}},{key:"N",value:function(){var e;return void 0!==t&&"YES"===(null===(e=t.env)||void 0===e?void 0:e.$)}},{key:"M",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),Be=function(){function e(t){R(this,e),this.q=t,this.U=!1,this.K=null}return O(e,[{key:"isDone",get:function(){return this.U}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.q=e}},{key:"done",value:function(){this.U=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return je(this.q.delete())}}]),e}(),Ke=function(e){w(n,ee);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,$.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return O(n)}();function Ge(e){return"IndexedDbTransactionError"===e.name}var Qe=function(){function e(t){R(this,e),this.store=t}return O(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(j("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(j("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),je(n)}},{key:"add",value:function(e){return j("SimpleDb","ADD",this.store.name,e,e),je(this.store.add(e))}},{key:"get",value:function(e){var t=this;return je(this.store.get(e)).next(function(n){return void 0===n&&(n=null),j("SimpleDb","GET",t.store.name,e,n),n})}},{key:"delete",value:function(e){return j("SimpleDb","DELETE",this.store.name,e),je(this.store.delete(e))}},{key:"count",value:function(){return j("SimpleDb","COUNT",this.store.name),je(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,function(e,t){i.push(t)}).next(function(){return i})}var a=this.store.getAll(n.range);return new Pe(function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}})}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Pe(function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}})}},{key:"Y",value:function(e,t){j("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Z=!1;var r=this.cursor(n);return this.H(r,function(e,t,n){return n.delete()})}},{key:"X",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new Pe(function(n,r){t.onerror=function(e){var t=We(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})}},{key:"H",value:function(e,t){var n=[];return new Pe(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Be(i),u=t(i.primaryKey,i.value,a);if(u instanceof Pe){var o=u.catch(function(e){return a.done(),Pe.reject(e)});n.push(o)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}}).next(function(){return Pe.waitFor(n)})}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Z?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function je(e){return new Pe(function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=We(e.target.error);n(t)}})}var ze=!1;function We(e){var t=Ue.D((0,a.getUA)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new ee("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return ze||(ze=!0,setTimeout(function(){throw r},0)),r}}return e}var He=function(){function e(t,n){R(this,e),this.asyncQueue=t,this.et=n,this.task=null}return O(e,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(e){var t=this;j("IndexBackiller","Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.task=null,e.prev=1,e.t0=j,e.t1="Documents written: ",e.next=6,t.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!Ge(e.t4)){e.next=17;break}j("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Oe(e.t4);case 19:return e.next=21,t.nt(6e4);case 21:case"end":return e.stop()}},e,null,[[1,11]])})))}}]),e}(),Xe=function(){function e(t,n){R(this,e),this.localStore=t,this.persistence=n}return O(e,[{key:"st",value:function(){var e=k(m().mark(function e(){var t,n=this,r=arguments;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:50,e.abrupt("return",this.persistence.runTransaction("Backfill Indexes","readwrite-primary",function(e){return n.it(e,t)}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Pe.doWhile(function(){return!0===a&&i>0},function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(function(t){if(null!==t&&!r.has(t))return j("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next(function(e){i-=e,r.add(t)});a=!1})}).next(function(){return t-i})}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next(function(n){var a=n.changes;return r.localStore.indexManager.updateIndexEntries(e,a).next(function(){return r.ot(i,n)}).next(function(n){return j("IndexBackiller","Updating offset: ".concat(n)),r.localStore.indexManager.updateCollectionGroup(e,t,n)}).next(function(){return a.size})})})}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach(function(e,t){var r=Ce(t);Le(r,n)>0&&(n=r)}),new Fe(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),e}(),Ye=function(){function e(t,n){var r=this;R(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.ut(e)},this.ct=function(e){return n.writeSequenceNumber(e)})}return O(e,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),e}();Ye.at=-1;var Je=/^[_a-zA-Z][_a-zA-Z0-9]*(?:\.[_a-zA-Z][_a-zA-Z0-9]*)*$/,Ze=function(){function e(t){R(this,e),this.alias=t}return O(e,[{key:"canonicalString",value:function(){var t=this.alias.replace(/\\/g,"\\\\").replace(/`/g,"\\`");return e.ht(t)||(t="`"+t+"`"),t}}],[{key:"ht",value:function(e){return Je.test(e)}}]),e}(),$e=O(function e(t,n,r){R(this,e),this.alias=t,this.lt=n,this.fieldPath=r}),et=O(function e(t,n,r,i,a,u,o,s){R(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=o,this.useFetchStreams=s}),tt=function(){function e(t,n){R(this,e),this.projectId=t,this.database=n||"(default)"}return O(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function nt(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function rt(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function it(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function at(e){return null==e}function ut(e){return 0===e&&1/e==-1/0}function ot(e){return"number"==typeof e&&Number.isInteger(e)&&!ut(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}exports._DatabaseId=tt;var st=function(e){w(n,d(Error));var t=b(n);function n(){var e;return R(this,n),(e=t.apply(this,arguments)).name="Base64DecodeError",e}return O(n)}();function ct(){return"undefined"!=typeof atob}var lt=function(e){function t(e){R(this,t),this.binaryString=e}return O(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return de(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(function(e){try{return atob(e)}catch(e){throw e instanceof DOMException?new st("Invalid base64 string: "+e):e}}(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();lt.EMPTY_BYTE_STRING=new lt("");var ft=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ht(e){if(Y(!!e),"string"==typeof e){var t=0,n=ft.exec(e);if(Y(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:dt(e.seconds),nanos:dt(e.nanos)}}function dt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function vt(e){return"string"==typeof e?lt.fromBase64String(e):lt.fromUint8Array(e)}function yt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pt(e){var t=e.mapValue.fields.__previous_value__;return yt(t)?pt(t):t}function mt(e){var t=ht(e.mapValue.fields.__local_write_time__.timestampValue);return new pe(t.seconds,t.nanos)}var gt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},kt={nullValue:"NULL_VALUE"};function wt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yt(e)?4:Rt(e)?9007199254740991:10:X()}function xt(e,t){if(e===t)return!0;var n=wt(e);if(n!==wt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return mt(e).isEqual(mt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=ht(e.timestampValue),r=ht(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return vt(e.bytesValue).isEqual(vt(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return dt(e.geoPointValue.latitude)===dt(t.geoPointValue.latitude)&&dt(e.geoPointValue.longitude)===dt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return dt(e.integerValue)===dt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=dt(e.doubleValue),r=dt(t.doubleValue);return n===r?ut(n)===ut(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ve(e.arrayValue.values||[],t.arrayValue.values||[],xt);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(nt(n)!==nt(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!xt(n[i],r[i])))return!1;return!0}(e,t);default:return X()}}function bt(e,t){return void 0!==(e.values||[]).find(function(e){return xt(e,t)})}function It(e,t){if(e===t)return 0;var n=wt(e),r=wt(t);if(n!==r)return de(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return de(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=dt(e.integerValue||e.doubleValue),r=dt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Tt(e.timestampValue,t.timestampValue);case 4:return Tt(mt(e),mt(t));case 5:return de(e.stringValue,t.stringValue);case 6:return function(e,t){var n=vt(e),r=vt(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=de(n[i],r[i]);if(0!==a)return a}return de(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=de(dt(e.latitude),dt(t.latitude));return 0!==n?n:de(dt(e.longitude),dt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=It(n[i],r[i]);if(a)return a}return de(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===gt.mapValue&&t===gt.mapValue)return 0;if(e===gt.mapValue)return 1;if(t===gt.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var u=0;u<r.length&&u<a.length;++u){var o=de(r[u],a[u]);if(0!==o)return o;var s=It(n[r[u]],i[a[u]]);if(0!==s)return s}return de(r.length,a.length)}(e.mapValue,t.mapValue);default:throw X()}}function Tt(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return de(e,t);var n=ht(e),r=ht(t),i=de(n.seconds,r.seconds);return 0!==i?i:de(n.nanos,r.nanos)}function Et(e){return St(e)}function St(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=ht(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?vt(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,be.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=p(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=St(a)}}catch(u){i.e(u)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=p(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(St(e.fields[a]))}}catch(u){i.e(u)}finally{i.f()}return n+"}"}(e.mapValue):X();var t,n}function _t(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function At(e){return!!e&&"integerValue"in e}function Dt(e){return!!e&&"arrayValue"in e}function Nt(e){return!!e&&"nullValue"in e}function Ct(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ft(e){return!!e&&"mapValue"in e}function Lt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==L(e.timestampValue))return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return rt(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=Lt(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Lt(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Rt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Mt(e){return"nullValue"in e?kt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?_t(tt.empty(),be.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:X()}function Ot(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?_t(tt.empty(),be.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?gt:X()}function Vt(e,t){var n=It(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Pt(e,t){var n=It(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}var qt=O(function e(t,n){R(this,e),this.position=t,this.inclusive=n});function Ut(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],u=e.position[i];if(r=a.field.isKeyField()?be.comparator(be.fromName(u.referenceValue),n.key):It(u,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Bt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!xt(e.position[n],t.position[n]))return!1;return!0}var Kt=O(function e(){R(this,e)}),Gt=function(e){w(n,Kt);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return O(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(It(t,this.value)):null!==t&&wt(this.value)===wt(t)&&this.matchesComparison(It(t,this.value))}},{key:"matchesComparison",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return X()}}},{key:"isInequality",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}},{key:"getFlattenedFilters",value:function(){return[this]}},{key:"getFilters",value:function(){return[this]}},{key:"getFirstInequalityField",value:function(){return this.isInequality()?this.field:null}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new $t(e,t,r):"array-contains"===t?new rn(e,r):"in"===t?new an(e,r):"not-in"===t?new un(e,r):"array-contains-any"===t?new on(e,r):new n(e,t,r)}},{key:"createKeyFieldInFilter",value:function(e,t,n){return"in"===t?new en(e,n):new tn(e,n)}}]),n}(),Qt=function(e){w(n,Kt);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).filters=e,i.op=r,i.ft=null,i}return O(n,[{key:"matches",value:function(e){return jt(this)?void 0===this.filters.find(function(t){return!t.matches(e)}):void 0!==this.filters.find(function(t){return t.matches(e)})}},{key:"getFlattenedFilters",value:function(){return null!==this.ft||(this.ft=this.filters.reduce(function(e,t){return e.concat(t.getFlattenedFilters())},[])),this.ft}},{key:"getFilters",value:function(){return Object.assign([],this.filters)}},{key:"getFirstInequalityField",value:function(){var e=this.dt(function(e){return e.isInequality()});return null!==e?e.field:null}},{key:"dt",value:function(e){var t,n=p(this.getFlattenedFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(i){n.e(i)}finally{n.f()}return null}}],[{key:"create",value:function(e,t){return new n(e,t)}}]),n}();function jt(e){return"and"===e.op}function zt(e){return"or"===e.op}function Wt(e){return Ht(e)&&jt(e)}function Ht(e){var t,n=p(e.filters);try{for(n.s();!(t=n.n()).done;){if(t.value instanceof Qt)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}function Xt(e){if(e instanceof Gt)return e.field.canonicalString()+e.op.toString()+Et(e.value);if(Wt(e))return e.filters.map(function(e){return Xt(e)}).join(",");var t=e.filters.map(function(e){return Xt(e)}).join(",");return"".concat(e.op,"(").concat(t,")")}function Yt(e,t){return e instanceof Gt?function(e,t){return t instanceof Gt&&e.op===t.op&&e.field.isEqual(t.field)&&xt(e.value,t.value)}(e,t):e instanceof Qt?function(e,t){return t instanceof Qt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(function(e,n,r){return e&&Yt(n,t.filters[r])},!0)}(e,t):void X()}function Jt(e,t){var n=e.filters.concat(t);return Qt.create(n,e.op)}function Zt(e){return e instanceof Gt?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Et(e.value))}(e):e instanceof Qt?function(e){return e.op.toString()+" {"+e.getFilters().map(Zt).join(" ,")+"}"}(e):"Filter"}var $t=function(e){w(n,Gt);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this,e,r,i)).key=be.fromName(i.referenceValue),a}return O(n,[{key:"matches",value:function(e){var t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}]),n}(),en=function(e){w(n,Gt);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e,"in",r)).keys=nn("in",r),i}return O(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(),tn=function(e){w(n,Gt);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e,"not-in",r)).keys=nn("not-in",r),i}return O(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}();function nn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return be.fromName(e.referenceValue)})}var rn=function(e){w(n,Gt);var t=b(n);function n(e,r){return R(this,n),t.call(this,e,"array-contains",r)}return O(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return Dt(t)&&bt(t.arrayValue,this.value)}}]),n}(),an=function(e){w(n,Gt);var t=b(n);function n(e,r){return R(this,n),t.call(this,e,"in",r)}return O(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&bt(this.value.arrayValue,t)}}]),n}(),un=function(e){w(n,Gt);var t=b(n);function n(e,r){return R(this,n),t.call(this,e,"not-in",r)}return O(n,[{key:"matches",value:function(e){if(bt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!bt(this.value.arrayValue,t)}}]),n}(),on=function(e){w(n,Gt);var t=b(n);function n(e,r){return R(this,n),t.call(this,e,"array-contains-any",r)}return O(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!Dt(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return bt(t.value.arrayValue,e)})}}]),n}(),sn=O(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";R(this,e),this.field=t,this.dir=n});function cn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var ln=function(){function e(t,n){R(this,e),this.comparator=t,this.root=n||hn.EMPTY}return O(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,hn.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,hn.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new fn(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new fn(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new fn(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new fn(this.root,e,this.comparator,!0)}}]),e}(),fn=function(){function e(t,n,r,i){R(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return O(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),hn=function(){function e(t,n,r,i,a){R(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return O(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw X();if(this.right.isRed())throw X();var e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}]),e}();hn.EMPTY=null,hn.RED=!0,hn.BLACK=!1,hn.EMPTY=new(function(){function e(){R(this,e),this.size=0}return O(e,[{key:"key",get:function(){throw X()}},{key:"value",get:function(){throw X()}},{key:"color",get:function(){throw X()}},{key:"left",get:function(){throw X()}},{key:"right",get:function(){throw X()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new hn(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var dn=function(){function e(t){R(this,e),this.comparator=t,this.data=new ln(this.comparator)}return O(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new vn(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new vn(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),vn=function(){function e(t){R(this,e),this.iter=t}return O(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function yn(e){return e.hasNext()?e.getNext():void 0}var pn=function(){function e(t){R(this,e),this.fields=t,t.sort(xe.comparator)}return O(e,[{key:"unionWith",value:function(t){var n,r=new dn(xe.comparator),i=p(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var u,o=p(t);try{for(o.s();!(u=o.n()).done;){var s=u.value;r=r.add(s)}}catch(c){o.e(c)}finally{o.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=p(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return ve(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),mn=function(){function e(t){R(this,e),this.value=t}return O(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Ft(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lt(t)}},{key:"setAll",value:function(e){var t=this,n=xe.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var u=t.getFieldsMap(n);t.applyChanges(u,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=Lt(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());Ft(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return xt(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Ft(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){rt(t,function(t,n){return e[t]=n});var r,i=p(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(u){i.e(u)}finally{i.f()}}},{key:"clone",value:function(){return new e(Lt(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function gn(e){var t=[];return rt(e.fields,function(e,n){var r=new xe([e]);if(Ft(n)){var i=gn(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,u=p(i);try{for(u.s();!(a=u.n()).done;){var o=a.value;t.push(r.child(o))}}catch(s){u.e(s)}finally{u.f()}}}else t.push(r)}),new pn(t)}var kn=function(){function e(t,n,r,i,a,u,o){R(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.createTime=a,this.data=u,this.documentState=o}return O(e,[{key:"convertToFoundDocument",value:function(e,t){return!this.createTime.isEqual(me.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=mn.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=mn.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=me.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,me.min(),me.min(),me.min(),mn.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r,i){return new e(t,1,n,me.min(),r,i,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,me.min(),me.min(),mn.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,me.min(),me.min(),mn.empty(),2)}}]),e}(),wn=O(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;R(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=u,this.endAt=o,this._t=null});function xn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new wn(e,t,n,r,i,a,u)}function bn(e){var t=Z(e);if(null===t._t){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return Xt(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return function(e){return e.field.canonicalString()+e.dir}(e)}).join(","),at(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return Et(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return Et(e)}).join(",")),t._t=n}return t._t}function In(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!cn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(!Yt(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Bt(e.startAt,t.startAt)&&Bt(e.endAt,t.endAt)}function Tn(e){return be.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function En(e,t){return e.filters.filter(function(e){return e instanceof Gt&&e.field.isEqual(t)})}function Sn(e,t,n){var r,i=kt,a=!0,u=p(En(e,t));try{for(u.s();!(r=u.n()).done;){var o=r.value,s=kt,c=!0;switch(o.op){case"<":case"<=":s=Mt(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,c=!1;break;case"!=":case"not-in":s=kt}Vt({value:i,inclusive:a},{value:s,inclusive:c})<0&&(i=s,a=c)}}catch(h){u.e(h)}finally{u.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];Vt({value:i,inclusive:a},{value:f,inclusive:n.inclusive})<0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}function _n(e,t,n){var r,i=gt,a=!0,u=p(En(e,t));try{for(u.s();!(r=u.n()).done;){var o=r.value,s=gt,c=!0;switch(o.op){case">=":case">":s=Ot(o.value),c=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,c=!1;break;case"!=":case"not-in":s=gt}Pt({value:i,inclusive:a},{value:s,inclusive:c})>0&&(i=s,a=c)}}catch(h){u.e(h)}finally{u.f()}if(null!==n)for(var l=0;l<e.orderBy.length;++l)if(e.orderBy[l].field.isEqual(t)){var f=n.position[l];Pt({value:i,inclusive:a},{value:f,inclusive:n.inclusive})>0&&(i=f,a=n.inclusive);break}return{value:i,inclusive:a}}var An=O(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;R(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=u,this.startAt=o,this.endAt=s,this.wt=null,this.gt=null,this.startAt,this.endAt});function Dn(e,t,n,r,i,a,u,o){return new An(e,t,n,r,i,a,u,o)}function Nn(e){return new An(e)}function Cn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fn(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Ln(e){var t,n=p(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value.getFirstInequalityField();if(null!==r)return r}}catch(i){n.e(i)}finally{n.f()}return null}function Rn(e){return null!==e.collectionGroup}function Mn(e){var t=Z(e);if(null===t.wt){t.wt=[];var n=Ln(t),r=Fn(t);if(null!==n&&null===r)n.isKeyField()||t.wt.push(new sn(n)),t.wt.push(new sn(xe.keyField(),"asc"));else{var i,a=!1,u=p(t.explicitOrderBy);try{for(u.s();!(i=u.n()).done;){var o=i.value;t.wt.push(o),o.field.isKeyField()&&(a=!0)}}catch(c){u.e(c)}finally{u.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new sn(xe.keyField(),s))}}}return t.wt}function On(e){var t=Z(e);if(!t.gt)if("F"===t.limitType)t.gt=xn(t.path,t.collectionGroup,Mn(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=p(Mn(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,u="desc"===a.dir?"asc":"desc";r.push(new sn(a.field,u))}}catch(c){i.e(c)}finally{i.f()}var o=t.endAt?new qt(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new qt(t.startAt.position,t.startAt.inclusive):null;t.gt=xn(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.gt}function Vn(e,t){t.getFirstInequalityField(),Ln(e);var n=e.filters.concat([t]);return new An(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Pn(e,t,n){return new An(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function qn(e,t){return In(On(e),On(t))&&e.limitType===t.limitType}function Un(e){return"".concat(bn(On(e)),"|lt:").concat(e.limitType)}function Bn(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return Zt(e)}).join(", "),"]")),at(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return Et(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return Et(e)}).join(",")),"Target(".concat(t,")")}(On(e)),"; limitType=").concat(e.limitType,")")}function Kn(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):be.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=p(Mn(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=p(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=Ut(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Mn(e),t))&&!(e.endAt&&!function(e,t,n){var r=Ut(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Mn(e),t))}(e,t)}function Gn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qn(e){return function(t,n){var r,i=!1,a=p(Mn(e));try{for(a.s();!(r=a.n()).done;){var u=r.value,o=jn(u,t,n);if(0!==o)return o;i=i||u.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function jn(e,t,n){var r=e.field.isKeyField()?be.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?It(r,i):X()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}function zn(e,t){if(e.yt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ut(t)?"-0":t}}function Wn(e){return{integerValue:""+e}}function Hn(e,t){return ot(t)?Wn(t):zn(e,t)}var Xn=O(function e(){R(this,e),this._=void 0});function Yn(e,t,n){return e instanceof $n?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof er?tr(e,t):e instanceof nr?rr(e,t):function(e,t){var n=Zn(e,t),r=ar(n)+ar(e.It);return At(n)&&At(e.It)?Wn(r):zn(e.Tt,r)}(e,t)}function Jn(e,t,n){return e instanceof er?tr(e,t):e instanceof nr?rr(e,t):n}function Zn(e,t){return e instanceof ir?At(n=t)||n&&"doubleValue"in n?t:{integerValue:0}:null;var n}var $n=function(e){w(n,Xn);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n)}(),er=function(e){w(n,Xn);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).elements=e,r}return O(n)}();function tr(e,t){var n,r=ur(t),i=p(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return xt(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return{arrayValue:{values:r}}}var nr=function(e){w(n,Xn);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).elements=e,r}return O(n)}();function rr(e,t){var n,r=ur(t),i=p(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!xt(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(u){i.e(u)}finally{i.f()}return{arrayValue:{values:r}}}var ir=function(e){w(n,Xn);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).Tt=e,i.It=r,i}return O(n)}();function ar(e){return dt(e.integerValue||e.doubleValue)}function ur(e){return Dt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var or=O(function e(t,n){R(this,e),this.field=t,this.transform=n});function sr(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof er&&t instanceof er||e instanceof nr&&t instanceof nr?ve(e.elements,t.elements,xt):e instanceof ir&&t instanceof ir?xt(e.It,t.It):e instanceof $n&&t instanceof $n}(e.transform,t.transform)}var cr=O(function e(t,n){R(this,e),this.version=t,this.transformResults=n}),lr=function(){function e(t,n){R(this,e),this.updateTime=t,this.exists=n}return O(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function fr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var hr=O(function e(){R(this,e)});function dr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Er(e.key,lr.none()):new gr(e.key,e.data,lr.none());var n,r=e.data,i=mn.empty(),a=new dn(xe.comparator),u=p(t.fields);try{for(u.s();!(n=u.n()).done;){var o=n.value;if(!a.has(o)){var s=r.field(o);null===s&&o.length>1&&(o=o.popLast(),s=r.field(o)),null===s?i.delete(o):i.set(o,s),a=a.add(o)}}}catch(c){u.e(c)}finally{u.f()}return new kr(e.key,i,new pn(a.toArray()),lr.none())}function vr(e,t,n){e instanceof gr?function(e,t,n){var r=e.value.clone(),i=xr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof kr?function(e,t,n){if(fr(e.precondition,t)){var r=xr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(wr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function yr(e,t,n,r){return e instanceof gr?function(e,t,n,r){if(!fr(e.precondition,t))return n;var i=e.value.clone(),a=br(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof kr?function(e,t,n,r){if(!fr(e.precondition,t))return n;var i=br(e.fieldTransforms,r,t),a=t.data;return a.setAll(wr(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):function(e,t,n){return fr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function pr(e,t){var n,r=null,i=p(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,u=t.data.field(a.field),o=Zn(a.transform,u||null);null!=o&&(null===r&&(r=mn.empty()),r.set(a.field,o))}}catch(s){i.e(s)}finally{i.f()}return r||null}function mr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ve(e,t,function(e,t){return sr(e,t)})}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var gr=function(e){w(n,hr);var t=b(n);function n(e,r,i){var a,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return R(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=u,a.type=0,a}return O(n,[{key:"getFieldMask",value:function(){return null}}]),n}(),kr=function(e){w(n,hr);var t=b(n);function n(e,r,i,a){var u,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return R(this,n),(u=t.call(this)).key=e,u.data=r,u.fieldMask=i,u.precondition=a,u.fieldTransforms=o,u.type=1,u}return O(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}();function wr(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function xr(e,t,n){var r=new Map;Y(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],u=a.transform,o=t.data.field(a.field);r.set(a.field,Jn(u,o,n[i]))}return r}function br(e,t,n){var r,i=new Map,a=p(e);try{for(a.s();!(r=a.n()).done;){var u=r.value,o=u.transform,s=n.data.field(u.field);i.set(u.field,Yn(o,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Ir,Tr,Er=function(e){w(n,hr);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return O(n,[{key:"getFieldMask",value:function(){return null}}]),n}(),Sr=function(e){w(n,hr);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return O(n,[{key:"getFieldMask",value:function(){return null}}]),n}(),_r=O(function e(t){R(this,e),this.count=t});function Ar(e){switch(e){default:return X();case $.CANCELLED:case $.UNKNOWN:case $.DEADLINE_EXCEEDED:case $.RESOURCE_EXHAUSTED:case $.INTERNAL:case $.UNAVAILABLE:case $.UNAUTHENTICATED:return!1;case $.INVALID_ARGUMENT:case $.NOT_FOUND:case $.ALREADY_EXISTS:case $.PERMISSION_DENIED:case $.FAILED_PRECONDITION:case $.ABORTED:case $.OUT_OF_RANGE:case $.UNIMPLEMENTED:case $.DATA_LOSS:return!0}}function Dr(e){if(void 0===e)return z("GRPC error has no .code"),$.UNKNOWN;switch(e){case Ir.OK:return $.OK;case Ir.CANCELLED:return $.CANCELLED;case Ir.UNKNOWN:return $.UNKNOWN;case Ir.DEADLINE_EXCEEDED:return $.DEADLINE_EXCEEDED;case Ir.RESOURCE_EXHAUSTED:return $.RESOURCE_EXHAUSTED;case Ir.INTERNAL:return $.INTERNAL;case Ir.UNAVAILABLE:return $.UNAVAILABLE;case Ir.UNAUTHENTICATED:return $.UNAUTHENTICATED;case Ir.INVALID_ARGUMENT:return $.INVALID_ARGUMENT;case Ir.NOT_FOUND:return $.NOT_FOUND;case Ir.ALREADY_EXISTS:return $.ALREADY_EXISTS;case Ir.PERMISSION_DENIED:return $.PERMISSION_DENIED;case Ir.FAILED_PRECONDITION:return $.FAILED_PRECONDITION;case Ir.ABORTED:return $.ABORTED;case Ir.OUT_OF_RANGE:return $.OUT_OF_RANGE;case Ir.UNIMPLEMENTED:return $.UNIMPLEMENTED;case Ir.DATA_LOSS:return $.DATA_LOSS;default:return X()}}(Tr=Ir||(Ir={}))[Tr.OK=0]="OK",Tr[Tr.CANCELLED=1]="CANCELLED",Tr[Tr.UNKNOWN=2]="UNKNOWN",Tr[Tr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tr[Tr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tr[Tr.NOT_FOUND=5]="NOT_FOUND",Tr[Tr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tr[Tr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tr[Tr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tr[Tr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tr[Tr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tr[Tr.ABORTED=10]="ABORTED",Tr[Tr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tr[Tr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tr[Tr.INTERNAL=13]="INTERNAL",Tr[Tr.UNAVAILABLE=14]="UNAVAILABLE",Tr[Tr.DATA_LOSS=15]="DATA_LOSS";var Nr=function(){function e(t,n){R(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return O(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=p(n);try{for(i.s();!(r=i.n()).done;){var a=c(r.value,2),u=a[0],o=a[1];if(this.equalsFn(u,e))return o}}catch(s){i.e(s)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){rt(this.inner,function(t,n){var r,i=p(n);try{for(i.s();!(r=i.n()).done;){var a=c(r.value,2),u=a[0],o=a[1];e(u,o)}}catch(s){i.e(s)}finally{i.f()}})}},{key:"isEmpty",value:function(){return it(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),Cr=new ln(be.comparator);function Fr(){return Cr}var Lr=new ln(be.comparator);function Rr(){for(var e=Lr,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var u=a[i];e=e.insert(u.key,u)}return e}function Mr(e){var t=Lr;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function Or(){return Pr()}function Vr(){return Pr()}function Pr(){return new Nr(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var qr=new ln(be.comparator),Ur=new dn(be.comparator);function Br(){for(var e=Ur,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var u=a[i];e=e.add(u)}return e}var Kr=new dn(de);function Gr(){return Kr}var Qr=function(){function e(t,n,r,i,a){R(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return O(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n,r){var i=new Map;return i.set(t,jr.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(me.min(),i,Gr(),Fr(),Br())}}]),e}(),jr=function(){function e(t,n,r,i,a){R(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return O(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n,r){return new e(r,n,Br(),Br(),Br())}}]),e}(),zr=O(function e(t,n,r,i){R(this,e),this.Et=t,this.removedTargetIds=n,this.key=r,this.At=i}),Wr=O(function e(t,n){R(this,e),this.targetId=t,this.Rt=n}),Hr=O(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lt.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;R(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),Xr=function(){function e(){R(this,e),this.Pt=0,this.vt=Zr(),this.bt=lt.EMPTY_BYTE_STRING,this.Vt=!1,this.St=!0}return O(e,[{key:"current",get:function(){return this.Vt}},{key:"resumeToken",get:function(){return this.bt}},{key:"Dt",get:function(){return 0!==this.Pt}},{key:"Ct",get:function(){return this.St}},{key:"xt",value:function(e){e.approximateByteSize()>0&&(this.St=!0,this.bt=e)}},{key:"Nt",value:function(){var e=Br(),t=Br(),n=Br();return this.vt.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:X()}}),new jr(this.bt,this.Vt,e,t,n)}},{key:"kt",value:function(){this.St=!1,this.vt=Zr()}},{key:"$t",value:function(e,t){this.St=!0,this.vt=this.vt.insert(e,t)}},{key:"Mt",value:function(e){this.St=!0,this.vt=this.vt.remove(e)}},{key:"Ot",value:function(){this.Pt+=1}},{key:"Ft",value:function(){this.Pt-=1}},{key:"Bt",value:function(){this.St=!0,this.Vt=!0}}]),e}(),Yr=function(){function e(t){R(this,e),this.Lt=t,this.qt=new Map,this.Ut=Fr(),this.Kt=Jr(),this.Gt=new dn(de)}return O(e,[{key:"Qt",value:function(e){var t,n=p(e.Et);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.At&&e.At.isFoundDocument()?this.jt(r,e.At):this.zt(r,e.key,e.At)}}catch(o){n.e(o)}finally{n.f()}var i,a=p(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var u=i.value;this.zt(u,e.key,e.At)}}catch(o){a.e(o)}finally{a.f()}}},{key:"Wt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Ht(n);switch(e.state){case 0:t.Jt(n)&&r.xt(e.resumeToken);break;case 1:r.Ft(),r.Dt||r.kt(),r.xt(e.resumeToken);break;case 2:r.Ft(),r.Dt||t.removeTarget(n);break;case 3:t.Jt(n)&&(r.Bt(),r.xt(e.resumeToken));break;case 4:t.Jt(n)&&(t.Yt(n),r.xt(e.resumeToken));break;default:X()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.qt.forEach(function(e,r){n.Jt(r)&&t(r)})}},{key:"Zt",value:function(e){var t=e.targetId,n=e.Rt.count,r=this.Xt(t);if(r){var i=r.target;if(Tn(i))if(0===n){var a=new be(i.path);this.zt(t,a,kn.newNoDocument(a,me.min()))}else Y(1===n);else this.te(t)!==n&&(this.Yt(t),this.Gt=this.Gt.add(t))}}},{key:"ee",value:function(e){var t=this,n=new Map;this.qt.forEach(function(r,i){var a=t.Xt(i);if(a){if(r.current&&Tn(a.target)){var u=new be(a.target.path);null!==t.Ut.get(u)||t.ne(i,u)||t.zt(i,u,kn.newNoDocument(u,e))}r.Ct&&(n.set(i,r.Nt()),r.kt())}});var r=Br();this.Kt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Xt(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.Ut.forEach(function(t,n){return n.setReadTime(e)});var i=new Qr(e,n,this.Gt,this.Ut,r);return this.Ut=Fr(),this.Kt=Jr(),this.Gt=new dn(de),i}},{key:"jt",value:function(e,t){if(this.Jt(e)){var n=this.ne(e,t.key)?2:0;this.Ht(e).$t(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.Kt=this.Kt.insert(t.key,this.se(t.key).add(e))}}},{key:"zt",value:function(e,t,n){if(this.Jt(e)){var r=this.Ht(e);this.ne(e,t)?r.$t(t,1):r.Mt(t),this.Kt=this.Kt.insert(t,this.se(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}}},{key:"removeTarget",value:function(e){this.qt.delete(e)}},{key:"te",value:function(e){var t=this.Ht(e).Nt();return this.Lt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.Ht(e).Ot()}},{key:"Ht",value:function(e){var t=this.qt.get(e);return t||(t=new Xr,this.qt.set(e,t)),t}},{key:"se",value:function(e){var t=this.Kt.get(e);return t||(t=new dn(de),this.Kt=this.Kt.insert(e,t)),t}},{key:"Jt",value:function(e){var t=null!==this.Xt(e);return t||j("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Xt",value:function(e){var t=this.qt.get(e);return t&&t.Dt?null:this.Lt.ie(e)}},{key:"Yt",value:function(e){var t=this;this.qt.set(e,new Xr),this.Lt.getRemoteKeysForTarget(e).forEach(function(n){t.zt(e,n,null)})}},{key:"ne",value:function(e,t){return this.Lt.getRemoteKeysForTarget(e).has(t)}}]),e}();function Jr(){return new ln(be.comparator)}function Zr(){return new ln(be.comparator)}var $r={asc:"ASCENDING",desc:"DESCENDING"},ei={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ti={and:"AND",or:"OR"},ni=O(function e(t,n){R(this,e),this.databaseId=t,this.yt=n});function ri(e,t){return e.yt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function ii(e,t){return e.yt?t.toBase64():t.toUint8Array()}function ai(e,t){return ri(e,t.toTimestamp())}function ui(e){return Y(!!e),me.fromTimestamp(function(e){var t=ht(e);return new pe(t.seconds,t.nanos)}(e))}function oi(e,t){return function(e){return new ke(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function si(e){var t=ke.fromString(e);return Y(Ri(t)),t}function ci(e,t){return oi(e.databaseId,t.path)}function li(e,t){var n=si(t);if(n.get(1)!==e.databaseId.projectId)throw new ee($.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ee($.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new be(vi(n))}function fi(e,t){return oi(e.databaseId,t)}function hi(e){var t=si(e);return 4===t.length?ke.emptyPath():vi(t)}function di(e){return new ke(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function vi(e){return Y(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function yi(e,t,n){return{name:ci(e,t),fields:n.value.mapValue.fields}}function pi(e,t,n){var r=li(e,t.name),i=ui(t.updateTime),a=t.createTime?ui(t.createTime):me.min(),u=new mn({mapValue:{fields:t.fields}}),o=kn.newFoundDocument(r,i,a,u);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function mi(e,t){return"found"in t?function(e,t){Y(!!t.found),t.found.name,t.found.updateTime;var n=li(e,t.found.name),r=ui(t.found.updateTime),i=t.found.createTime?ui(t.found.createTime):me.min(),a=new mn({mapValue:{fields:t.found.fields}});return kn.newFoundDocument(n,r,i,a)}(e,t):"missing"in t?function(e,t){Y(!!t.missing),Y(!!t.readTime);var n=li(e,t.missing),r=ui(t.readTime);return kn.newNoDocument(n,r)}(e,t):X()}function gi(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:X()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.yt?(Y(void 0===t||"string"==typeof t),lt.fromBase64String(t||"")):(Y(void 0===t||t instanceof Uint8Array),lt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),u=t.targetChange.cause,o=u&&function(e){var t=void 0===e.code?$.UNKNOWN:Dr(e.code);return new ee(t,e.message||"")}(u);n=new Hr(r,i,a,o||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=li(e,s.document.name),l=ui(s.document.updateTime),f=s.document.createTime?ui(s.document.createTime):me.min(),h=new mn({mapValue:{fields:s.document.fields}}),d=kn.newFoundDocument(c,l,f,h),v=s.targetIds||[],y=s.removedTargetIds||[];n=new zr(v,y,d.key,d)}else if("documentDelete"in t){t.documentDelete;var p=t.documentDelete;p.document;var m=li(e,p.document),g=p.readTime?ui(p.readTime):me.min(),k=kn.newNoDocument(m,g),w=p.removedTargetIds||[];n=new zr([],w,k.key,k)}else if("documentRemove"in t){t.documentRemove;var x=t.documentRemove;x.document;var b=li(e,x.document),I=x.removedTargetIds||[];n=new zr([],I,b,null)}else{if(!("filter"in t))return X();t.filter;var T=t.filter;T.targetId;var E=T.count||0,S=new _r(E),_=T.targetId;n=new Wr(_,S)}return n}function ki(e,t){var n;if(t instanceof gr)n={update:yi(e,t.key,t.value)};else if(t instanceof Er)n={delete:ci(e,t.key)};else if(t instanceof kr)n={update:yi(e,t.key,t.data),updateMask:Li(t.fieldMask)};else{if(!(t instanceof Sr))return X();n={verify:ci(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof $n)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof er)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof nr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ir)return{fieldPath:t.field.canonicalString(),increment:n.It};throw X()}(0,e)})),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ai(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:X()}(e,t.precondition)),n}function wi(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?lr.updateTime(ui(e.updateTime)):void 0!==e.exists?lr.exists(e.exists):lr.none()}(t.currentDocument):lr.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(e,t){var n=null;if("setToServerValue"in t)Y("REQUEST_TIME"===t.setToServerValue),n=new $n;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new er(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new nr(i)}else"increment"in t?n=new ir(e,t.increment):X();var a=xe.fromServerFormat(t.fieldPath);return new or(a,n)}(e,t)}):[];if(t.update){t.update.name;var i=li(e,t.update.name),a=new mn({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=function(e){var t=e.fieldPaths||[];return new pn(t.map(function(e){return xe.fromServerFormat(e)}))}(t.updateMask);return new kr(i,a,u,n,r)}return new gr(i,a,n,r)}if(t.delete){var o=li(e,t.delete);return new Er(o,n)}if(t.verify){var s=li(e,t.verify);return new Sr(s,n)}return X()}function xi(e,t){return e&&e.length>0?(Y(void 0!==t),e.map(function(e){return function(e,t){var n=e.updateTime?ui(e.updateTime):ui(t);return n.isEqual(me.min())&&(n=ui(t)),new cr(n,e.transformResults||[])}(e,t)})):[]}function bi(e,t){return{documents:[fi(e,t.path)]}}function Ii(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=fi(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=fi(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length)return Fi(Qt.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return function(e){return{field:Ni(e.field),direction:_i(e.dir)}}(e)})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var u,o=function(e,t){return e.yt||at(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(u=t.startAt).inclusive,values:u.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Ti(e){var t=hi(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Y(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var u=[];n.where&&(u=function(e){var t=Si(n.where);return t instanceof Qt&&Wt(t)?t.getFilters():[t]}());var o=[];n.orderBy&&(o=n.orderBy.map(function(e){return function(e){return new sn(Ci(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)}));var s=null;n.limit&&(s=function(e){var t;return at(t="object"==L(e)?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new qt(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new qt(n,t)}(n.endAt)),Dn(t,i,o,u,s,"F",c,l)}function Ei(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return X()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}function Si(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Ci(e.unaryFilter.field);return Gt.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Ci(e.unaryFilter.field);return Gt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ci(e.unaryFilter.field);return Gt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ci(e.unaryFilter.field);return Gt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(e):void 0!==e.fieldFilter?function(e){return Gt.create(Ci(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Qt.create(e.compositeFilter.filters.map(function(e){return Si(e)}),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return X()}}(e.compositeFilter.op))}(e):X()}function _i(e){return $r[e]}function Ai(e){return ei[e]}function Di(e){return ti[e]}function Ni(e){return{fieldPath:e.canonicalString()}}function Ci(e){return xe.fromServerFormat(e.fieldPath)}function Fi(e){return e instanceof Gt?function(e){if("=="===e.op){if(Ct(e.value))return{unaryFilter:{field:Ni(e.field),op:"IS_NAN"}};if(Nt(e.value))return{unaryFilter:{field:Ni(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ct(e.value))return{unaryFilter:{field:Ni(e.field),op:"IS_NOT_NAN"}};if(Nt(e.value))return{unaryFilter:{field:Ni(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ni(e.field),op:Ai(e.op),value:e.value}}}(e):e instanceof Qt?function(e){var t=e.getFilters().map(function(e){return Fi(e)});return 1===t.length?t[0]:{compositeFilter:{op:Di(e.op),filters:t}}}(e):X()}function Li(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function Ri(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Mi(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Vi(t)),t=Oi(e.get(n),t);return Vi(t)}function Oi(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function Vi(e){return e+""}function Pi(e){var t=e.length;if(Y(t>=2),2===t)return Y(""===e.charAt(0)&&""===e.charAt(1)),ke.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var u=e.indexOf("",a);switch((u<0||u>n)&&X(),e.charAt(u+1)){case"":var o=e.substring(a,u),s=void 0;0===i.length?s=o:(s=i+=o,i=""),r.push(s);break;case"":i+=e.substring(a,u),i+="\0";break;case"":i+=e.substring(a,u+1);break;default:X()}a=u+2}return new ke(r)}var qi=["userId","batchId"];function Ui(e,t){return[e,Mi(t)]}function Bi(e,t,n){return[e,Mi(t),n]}var Ki={},Gi=["prefixPath","collectionGroup","readTime","documentId"],Qi=["prefixPath","collectionGroup","documentId"],ji=["collectionGroup","readTime","prefixPath","documentId"],zi=["canonicalId","targetId"],Wi=["targetId","path"],Hi=["path","targetId"],Xi=["collectionId","parent"],Yi=["indexId","uid"],Ji=["uid","sequenceNumber"],Zi=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$i=["indexId","uid","orderedDocumentKey"],ea=["userId","collectionPath","documentId"],ta=["userId","collectionPath","largestBatchId"],na=["userId","collectionGroup","largestBatchId"],ra=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),ia=[].concat(_(ra),["documentOverlays"]),aa=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ua=aa,oa=[].concat(ua,["indexConfiguration","indexState","indexEntries"]),sa=function(e){w(n,Me);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).re=e,i.currentSequenceNumber=r,i}return O(n)}();function ca(e,t){var n=Z(e);return Ue.M(n.re,t)}var la=function(){function e(t,n,r,i){R(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return O(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&vr(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=p(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=yr(i,e,t,this.localWriteTime))}}catch(s){r.e(s)}finally{r.f()}var a,u=p(this.mutations);try{for(u.s();!(a=u.n()).done;){var o=a.value;o.key.isEqual(e.key)&&(t=yr(o,e,t,this.localWriteTime))}}catch(s){u.e(s)}finally{u.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Vr();return this.mutations.forEach(function(i){var a=e.get(i.key),u=a.overlayedDocument,o=n.applyToLocalView(u,a.mutatedFields),s=dr(u,o=t.has(i.key)?null:o);null!==s&&r.set(i.key,s),u.isValidDocument()||u.convertToNoDocument(me.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Br())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&ve(this.mutations,e.mutations,function(e,t){return mr(e,t)})&&ve(this.baseMutations,e.baseMutations,function(e,t){return mr(e,t)})}}]),e}(),fa=function(){function e(t,n,r,i){R(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return O(e,null,[{key:"from",value:function(t,n,r){Y(t.mutations.length===r.length);for(var i=qr,a=t.mutations,u=0;u<a.length;u++)i=i.insert(a[u].key,r[u].version);return new e(t,n,r,i)}}]),e}(),ha=function(){function e(t,n){R(this,e),this.largestBatchId=t,this.mutation=n}return O(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),da=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:me.min(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:lt.EMPTY_BYTE_STRING;R(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=o}return O(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),va=O(function e(t){R(this,e),this.oe=t});function ya(e,t){var n;if(t.document)n=pi(e.oe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=be.fromSegments(t.noDocument.path),i=ka(t.noDocument.readTime);n=kn.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return X();var a=be.fromSegments(t.unknownDocument.path),u=ka(t.unknownDocument.version);n=kn.newUnknownDocument(a,u)}return t.readTime&&n.setReadTime(function(e){var t=new pe(e[0],e[1]);return me.fromTimestamp(t)}(t.readTime)),n}function pa(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ma(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:ci(e,t.key),fields:t.data.value.mapValue.fields,updateTime:ri(e,t.version.toTimestamp()),createTime:ri(e,t.createTime.toTimestamp())}}(e.oe,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ga(t.version)};else{if(!t.isUnknownDocument())return X();r.unknownDocument={path:n.path.toArray(),version:ga(t.version)}}return r}function ma(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ga(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function ka(e){var t=new pe(e.seconds,e.nanoseconds);return me.fromTimestamp(t)}function wa(e,t){for(var n=(t.baseMutations||[]).map(function(t){return wi(e.oe,t)}),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var u=t.mutations.map(function(t){return wi(e.oe,t)}),o=pe.fromMillis(t.localWriteTimeMs);return new la(t.batchId,o,n,u)}function xa(e){var t,n,r=ka(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?ka(e.lastLimboFreeSnapshotVersion):me.min();return void 0!==e.query.documents?(Y(1===(n=e.query).documents.length),t=On(Nn(hi(n.documents[0])))):t=function(e){return On(Ti(e))}(e.query),new da(t,e.targetId,0,e.lastListenSequenceNumber,r,i,lt.fromBase64String(e.resumeToken))}function ba(e,t){var n,r=ga(t.snapshotVersion),i=ga(t.lastLimboFreeSnapshotVersion);n=Tn(t.target)?bi(e.oe,t.target):Ii(e.oe,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:bn(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function Ia(e){var t=Ti({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Pn(t,t.limit,"L"):t}function Ta(e,t){return new ha(t.largestBatchId,wi(e.oe,t.overlayMutation))}function Ea(e,t){var n=t.path.lastSegment();return[e,Mi(t.path.popLast()),n]}function Sa(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:ga(r.readTime),documentKey:Mi(r.documentKey.path),largestBatchId:r.largestBatchId}}var _a=function(){function e(){R(this,e)}return O(e,[{key:"getBundleMetadata",value:function(e,t){return Aa(e).get(t).next(function(e){if(e)return{id:(t=e).bundleId,createTime:ka(t.createTime),version:t.version};var t})}},{key:"saveBundleMetadata",value:function(e,t){return Aa(e).put({bundleId:(n=t).id,createTime:ga(ui(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return Da(e).get(t).next(function(e){if(e)return{name:(t=e).name,query:Ia(t.bundledQuery),readTime:ka(t.readTime)};var t})}},{key:"saveNamedQuery",value:function(e,t){return Da(e).put(function(e){return{name:e.name,readTime:ga(ui(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function Aa(e){return ca(e,"bundles")}function Da(e){return ca(e,"namedQueries")}var Na=function(){function e(t,n){R(this,e),this.Tt=t,this.userId=n}return O(e,[{key:"getOverlay",value:function(e,t){var n=this;return Ca(e).get(Ea(this.userId,t)).next(function(e){return e?Ta(n.Tt,e):null})}},{key:"getOverlays",value:function(e,t){var n=this,r=Or();return Pe.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach(function(n,a){var u=new ha(t,a);i.push(r.ce(e,u))}),Pe.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach(function(e){return i.add(Mi(e.getCollectionPath()))});var a=[];return i.forEach(function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(Ca(e).Y("collectionPathOverlayIndex",i))}),Pe.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=Or(),a=Mi(t),u=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Ca(e).W("collectionPathOverlayIndex",u).next(function(e){var t,n=p(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,u=Ta(r.Tt,a);i.set(u.getKey(),u)}}catch(o){n.e(o)}finally{n.f()}return i})}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,u=Or(),o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ca(e).X({index:"collectionGroupOverlayIndex",range:o},function(e,t,n){var o=Ta(a.Tt,t);u.size()<r||o.largestBatchId===i?(u.set(o.getKey(),o),i=o.largestBatchId):n.done()}).next(function(){return u})}},{key:"ce",value:function(e,t){return Ca(e).put(function(e,t,n){var r=c(Ea(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:ki(e.oe,n.mutation)}}(this.Tt,this.userId,t))}}],[{key:"ue",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function Ca(e){return ca(e,"documentOverlays")}var Fa=function(){function e(){R(this,e)}return O(e,[{key:"ae",value:function(e,t){this.he(e,t),t.le()}},{key:"he",value:function(e,t){if("nullValue"in e)this.fe(t,5);else if("booleanValue"in e)this.fe(t,10),t.de(e.booleanValue?1:0);else if("integerValue"in e)this.fe(t,15),t.de(dt(e.integerValue));else if("doubleValue"in e){var n=dt(e.doubleValue);isNaN(n)?this.fe(t,13):(this.fe(t,15),ut(n)?t.de(0):t.de(n))}else if("timestampValue"in e){var r=e.timestampValue;this.fe(t,20),"string"==typeof r?t._e(r):(t._e("".concat(r.seconds||"")),t.de(r.nanos||0))}else if("stringValue"in e)this.we(e.stringValue,t),this.me(t);else if("bytesValue"in e)this.fe(t,30),t.ge(vt(e.bytesValue)),this.me(t);else if("referenceValue"in e)this.ye(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.fe(t,45),t.de(i.latitude||0),t.de(i.longitude||0)}else"mapValue"in e?Rt(e)?this.fe(t,Number.MAX_SAFE_INTEGER):(this.pe(e.mapValue,t),this.me(t)):"arrayValue"in e?(this.Ie(e.arrayValue,t),this.me(t)):X()}},{key:"we",value:function(e,t){this.fe(t,25),this.Te(e,t)}},{key:"Te",value:function(e,t){t._e(e)}},{key:"pe",value:function(e,t){var n=e.fields||{};this.fe(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.we(a,t),this.he(n[a],t)}}},{key:"Ie",value:function(e,t){var n=e.values||[];this.fe(t,50);var r,i=p(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.he(a,t)}}catch(u){i.e(u)}finally{i.f()}}},{key:"ye",value:function(e,t){var n=this;this.fe(t,37),be.fromName(e).path.forEach(function(e){n.fe(t,60),n.Te(e,t)})}},{key:"fe",value:function(e,t){e.de(t)}},{key:"me",value:function(e){e.de(2)}}]),e}();function La(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ra(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=La(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Fa.Ee=new Fa;var Ma=function(){function e(){R(this,e),this.buffer=new Uint8Array(1024),this.position=0}return O(e,[{key:"Ae",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Re(n.value),n=t.next();this.Pe()}},{key:"ve",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.be(n.value),n=t.next();this.Ve()}},{key:"Se",value:function(e){var t,n=p(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.Re(i);else if(i<2048)this.Re(960|i>>>6),this.Re(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.Re(480|i>>>12),this.Re(128|63&i>>>6),this.Re(128|63&i);else{var a=r.codePointAt(0);this.Re(240|a>>>18),this.Re(128|63&a>>>12),this.Re(128|63&a>>>6),this.Re(128|63&a)}}}catch(u){n.e(u)}finally{n.f()}this.Pe()}},{key:"De",value:function(e){var t,n=p(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.be(i);else if(i<2048)this.be(960|i>>>6),this.be(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.be(480|i>>>12),this.be(128|63&i>>>6),this.be(128|63&i);else{var a=r.codePointAt(0);this.be(240|a>>>18),this.be(128|63&a>>>12),this.be(128|63&a>>>6),this.be(128|63&a)}}}catch(u){n.e(u)}finally{n.f()}this.Ve()}},{key:"Ce",value:function(e){var t=this.xe(e),n=Ra(t);this.Ne(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"ke",value:function(e){var t=this.xe(e),n=Ra(t);this.Ne(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"$e",value:function(){this.Me(255),this.Me(255)}},{key:"Oe",value:function(){this.Fe(255),this.Fe(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ne(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Be",value:function(){return this.buffer.slice(0,this.position)}},{key:"xe",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"Re",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}},{key:"be",value:function(e){var t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}},{key:"Pe",value:function(){this.Me(0),this.Me(1)}},{key:"Ve",value:function(){this.Fe(0),this.Fe(1)}},{key:"Me",value:function(e){this.Ne(1),this.buffer[this.position++]=e}},{key:"Fe",value:function(e){this.Ne(1),this.buffer[this.position++]=~e}},{key:"Ne",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),Oa=function(){function e(t){R(this,e),this.Le=t}return O(e,[{key:"ge",value:function(e){this.Le.Ae(e)}},{key:"_e",value:function(e){this.Le.Se(e)}},{key:"de",value:function(e){this.Le.Ce(e)}},{key:"le",value:function(){this.Le.$e()}}]),e}(),Va=function(){function e(t){R(this,e),this.Le=t}return O(e,[{key:"ge",value:function(e){this.Le.ve(e)}},{key:"_e",value:function(e){this.Le.De(e)}},{key:"de",value:function(e){this.Le.ke(e)}},{key:"le",value:function(){this.Le.Oe()}}]),e}(),Pa=function(){function e(){R(this,e),this.Le=new Ma,this.qe=new Oa(this.Le),this.Ue=new Va(this.Le)}return O(e,[{key:"seed",value:function(e){this.Le.seed(e)}},{key:"Ke",value:function(e){return 0===e?this.qe:this.Ue}},{key:"Be",value:function(){return this.Le.Be()}},{key:"reset",value:function(){this.Le.reset()}}]),e}(),qa=function(){function e(t,n,r,i){R(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return O(e,[{key:"Ge",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function Ua(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=Ba(e.arrayValue,t.arrayValue))?n:0!==(n=Ba(e.directionalValue,t.directionalValue))?n:be.comparator(e.documentKey,t.documentKey)}function Ba(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var Ka=function(){function e(t){R(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Qe=t.orderBy,this.je=[];var n,r=p(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isInequality()?this.ze=i:this.je.push(i)}}catch(a){r.e(a)}finally{r.f()}}return O(e,[{key:"We",value:function(e){Y(e.collectionGroup===this.collectionId);var t=Te(e);if(void 0!==t&&!this.He(t))return!1;for(var n=Ee(e),r=0,i=0;r<n.length&&this.He(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.ze){var a=n[r];if(!this.Je(this.ze,a)||!this.Ye(this.Qe[i++],a))return!1;++r}for(;r<n.length;++r){var u=n[r];if(i>=this.Qe.length||!this.Ye(this.Qe[i++],u))return!1}return!0}},{key:"He",value:function(e){var t,n=p(this.je);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.Je(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"Je",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"Ye",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}();function Ga(e){var t,n;if(Y(e instanceof Gt||e instanceof Qt),e instanceof Gt){if(e instanceof an){var r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(function(t){return Gt.create(e.field,"==",t)}))||[];return Qt.create(r,"or")}return e}var i=e.filters.map(function(e){return Ga(e)});return Qt.create(i,e.op)}function Qa(e){if(0===e.getFilters().length)return[];var t=Ha(Ga(e));return Y(Wa(t)),ja(t)||za(t)?[t]:t.getFilters()}function ja(e){return e instanceof Gt}function za(e){return e instanceof Qt&&Wt(e)}function Wa(e){return ja(e)||za(e)||function(e){if(e instanceof Qt&&zt(e)){var t,n=p(e.getFilters());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!ja(r)&&!za(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}return!1}(e)}function Ha(e){if(Y(e instanceof Gt||e instanceof Qt),e instanceof Gt)return e;if(1===e.filters.length)return Ha(e.filters[0]);var t=e.filters.map(function(e){return Ha(e)}),n=Qt.create(t,e.op);return Wa(n=Ja(n))?n:(Y(n instanceof Qt),Y(jt(n)),Y(n.filters.length>1),n.filters.reduce(function(e,t){return Xa(e,t)}))}function Xa(e,t){return Y(e instanceof Gt||e instanceof Qt),Y(t instanceof Gt||t instanceof Qt),Ja(e instanceof Gt?t instanceof Gt?function(e,t){return Qt.create([e,t],"and")}(e,t):Ya(e,t):t instanceof Gt?Ya(t,e):function(e,t){if(Y(e.filters.length>0&&t.filters.length>0),jt(e)&&jt(t))return Jt(e,t.getFilters());var n=zt(e)?e:t,r=zt(e)?t:e,i=n.filters.map(function(e){return Xa(e,r)});return Qt.create(i,"or")}(e,t))}function Ya(e,t){if(jt(t))return Jt(t,e.getFilters());var n=t.filters.map(function(t){return Xa(e,t)});return Qt.create(n,"or")}function Ja(e){if(Y(e instanceof Gt||e instanceof Qt),e instanceof Gt)return e;var t=e.getFilters();if(1===t.length)return Ja(t[0]);if(Ht(e))return e;var n=t.map(function(e){return Ja(e)}),r=[];return n.forEach(function(t){t instanceof Gt?r.push(t):t instanceof Qt&&(t.op===e.op?r.push.apply(r,_(t.filters)):r.push(t))}),1===r.length?r[0]:Qt.create(r,e.op)}var Za=function(){function e(){R(this,e),this.Ze=new $a}return O(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Ze.add(t),Pe.resolve()}},{key:"getCollectionParents",value:function(e,t){return Pe.resolve(this.Ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Pe.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Pe.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Pe.resolve(null)}},{key:"getIndexType",value:function(e,t){return Pe.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Pe.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Pe.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Pe.resolve(Fe.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Pe.resolve(Fe.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Pe.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Pe.resolve()}}]),e}(),$a=function(){function e(){R(this,e),this.index={}}return O(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new dn(ke.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new dn(ke.comparator)).toArray()}}]),e}(),eu=new Uint8Array(0),tu=function(){function e(t,n){R(this,e),this.user=t,this.databaseId=n,this.Xe=new $a,this.tn=new Nr(function(e){return bn(e)},function(e,t){return In(e,t)}),this.uid=t.uid||""}return O(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.Xe.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.Xe.add(t)});var a={collectionId:r,parent:Mi(i)};return nu(e).put(a)}return Pe.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[ye(t),""],!1,!0);return nu(e).W(r).next(function(e){var r,i=p(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(Pi(a.parent))}}catch(u){i.e(u)}finally{i.f()}return n})}},{key:"addFieldIndex",value:function(e,t){var n=this,r=iu(e),i=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(function(e){return[e.fieldPath.canonicalString(),e.kind]})}}(t);delete i.indexId;var a=r.add(i);if(t.indexState){var u=au(e);return a.next(function(e){u.put(Sa(e,n.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=iu(e),r=au(e),i=ru(e);return n.delete(t.indexId).next(function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}).next(function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=ru(e),i=!0,a=new Map;return Pe.forEach(this.en(t),function(t){return n.nn(e,t).next(function(e){i&&(i=!!e),a.set(t,e)})}).next(function(){if(i){var e=Br(),u=[];return Pe.forEach(a,function(i,a){var o;j("IndexedDbIndexManager","Using index ".concat((o=i,"id=".concat(o.indexId,"|cg=").concat(o.collectionGroup,"|f=").concat(o.fields.map(function(e){return"".concat(e.fieldPath,":").concat(e.kind)}).join(",")))," to execute ").concat(bn(t)));var s=function(e,t){var n=Te(i);if(void 0===n)return null;var r,a=p(En(e,n.fieldPath));try{for(a.s();!(r=a.n()).done;){var u=r.value;switch(u.op){case"array-contains-any":return u.value.arrayValue.values||[];case"array-contains":return[u.value]}}}catch(o){a.e(o)}finally{a.f()}return null}(a),c=function(e,t){var n,r=new Map,i=p(Ee(t));try{for(i.s();!(n=i.n()).done;){var a,u=n.value,o=p(En(e,u.fieldPath));try{for(o.s();!(a=o.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(u.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(u.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){o.e(c)}finally{o.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),l=function(e,t){var n,r=[],a=!0,u=p(Ee(i));try{for(u.s();!(n=u.n()).done;){var o=n.value,s=0===o.kind?Sn(e,o.fieldPath,e.startAt):_n(e,o.fieldPath,e.startAt);r.push(s.value),a&&(a=s.inclusive)}}catch(c){u.e(c)}finally{u.f()}return new qt(r,a)}(a),f=function(e,t){var n,r=[],a=!0,u=p(Ee(i));try{for(u.s();!(n=u.n()).done;){var o=n.value,s=0===o.kind?_n(e,o.fieldPath,e.endAt):Sn(e,o.fieldPath,e.endAt);r.push(s.value),a&&(a=s.inclusive)}}catch(c){u.e(c)}finally{u.f()}return new qt(r,a)}(a),h=n.sn(i,a,l),d=n.sn(i,a,f),v=n.rn(i,a,c),y=n.on(i.indexId,s,h,l.inclusive,d,f.inclusive,v);return Pe.forEach(y,function(n){return r.J(n,t.limit).next(function(t){t.forEach(function(t){var n=be.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),u.push(n))})})})}).next(function(){return u})}return Pe.resolve(null)})}},{key:"en",value:function(e){var t=this.tn.get(e);return t||(t=0===e.filters.length?[e]:Qa(Qt.create(e.filters,"and")).map(function(t){return xn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)}),this.tn.set(e,t),t)}},{key:"on",value:function(e,t,n,r,i,a,u){for(var o=this,s=(null!=t?t.length:1)*Math.max(n.length,i.length),c=s/(null!=t?t.length:1),l=[],f=function(){var s=t?o.un(t[h/c]):eu,f=o.cn(e,s,n[h%c],r),d=o.an(e,s,i[h%c],a),v=u.map(function(t){return o.cn(e,s,t,!0)});l.push.apply(l,_(o.createRange(f,d,v)))},h=0;h<s;++h)f();return l}},{key:"cn",value:function(e,t,n,r){var i=new qa(e,be.empty(),t,n);return r?i:i.Ge()}},{key:"an",value:function(e,t,n,r){var i=new qa(e,be.empty(),t,n);return r?i.Ge():i}},{key:"nn",value:function(e,t){var n=new Ka(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(function(e){var t,r=null,i=p(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;n.We(a)&&(!r||a.fields.length>r.fields.length)&&(r=a)}}catch(u){i.e(u)}finally{i.f()}return r})}},{key:"getIndexType",value:function(e,t){var n=this,r=2,i=this.en(t);return Pe.forEach(i,function(t){return n.nn(e,t).next(function(e){e?0!==r&&e.fields.length<function(e){var t,n=new dn(xe.comparator),r=!1,i=p(e.filters);try{for(i.s();!(t=i.n()).done;){var a,u=p(t.value.getFlattenedFilters());try{for(u.s();!(a=u.n()).done;){var o=a.value;o.field.isKeyField()||("array-contains"===o.op||"array-contains-any"===o.op?r=!0:n=n.add(o.field))}}catch(f){u.e(f)}finally{u.f()}}}catch(f){i.e(f)}finally{i.f()}var s,c=p(e.orderBy);try{for(c.s();!(s=c.n()).done;){var l=s.value;l.field.isKeyField()||(n=n.add(l.field))}}catch(f){c.e(f)}finally{c.f()}return n.size+(r?1:0)}(t)&&(r=1):r=0})}).next(function(){return null!==t.limit&&i.length>1&&2===r?1:r})}},{key:"hn",value:function(e,t){var n,r=new Pa,i=p(Ee(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,u=t.data.field(a.fieldPath);if(null==u)return null;var o=r.Ke(a.kind);Fa.Ee.ae(u,o)}}catch(s){i.e(s)}finally{i.f()}return r.Be()}},{key:"un",value:function(e){var t=new Pa;return Fa.Ee.ae(e,t.Ke(0)),t.Be()}},{key:"ln",value:function(e,t){var n=new Pa;return Fa.Ee.ae(_t(this.databaseId,t),n.Ke(function(e){var t=Ee(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Be()}},{key:"rn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new Pa);var i,a=0,u=p(Ee(e));try{for(u.s();!(i=u.n()).done;){var o,s=i.value,c=n[a++],l=p(r);try{for(l.s();!(o=l.n()).done;){var f=o.value;if(this.fn(t,s.fieldPath)&&Dt(c))r=this.dn(r,s,c);else{var h=f.Ke(s.kind);Fa.Ee.ae(c,h)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){u.e(d)}finally{u.f()}return this._n(r)}},{key:"sn",value:function(e,t,n){return this.rn(e,t,n.position)}},{key:"_n",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Be();return t}},{key:"dn",value:function(e,t,n){var r,i=_(e),a=[],u=p(n.arrayValue.values||[]);try{for(u.s();!(r=u.n()).done;){var o,s=r.value,c=p(i);try{for(c.s();!(o=c.n()).done;){var l=o.value,f=new Pa;f.seed(l.Be()),Fa.Ee.ae(s,f.Ke(t.kind)),a.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){u.e(h)}finally{u.f()}return a}},{key:"fn",value:function(e,t){return!!e.filters.find(function(e){return e instanceof Gt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)})}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=iu(e),i=au(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(function(e){var t=[];return Pe.forEach(e,function(e){return i.get([e.indexId,n.uid]).next(function(n){t.push(function(e,t){var n=t?new De(t.sequenceNumber,new Fe(ka(t.readTime),new be(Pi(t.documentKey)),t.largestBatchId)):De.empty(),r=e.fields.map(function(e){var t=c(e,2),n=t[0],r=t[1];return new _e(xe.fromServerFormat(n),r)});return new Ie(e.indexId,e.collectionGroup,r,n)}(e,n))})}).next(function(){return t})})}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next(function(e){return 0===e.length?null:(e.sort(function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:de(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup)})}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=iu(e),a=au(e);return this.wn(e).next(function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(function(t){return Pe.forEach(t,function(t){return a.put(Sa(t.indexId,r.user,e,n))})})})}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Pe.forEach(t,function(t,i){var a=r.get(t.collectionGroup);return(a?Pe.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next(function(a){return r.set(t.collectionGroup,a),Pe.forEach(a,function(r){return n.mn(e,t,r).next(function(t){var a=n.gn(i,r);return t.isEqual(a)?Pe.resolve():n.yn(e,i,r,t,a)})})})})}},{key:"pn",value:function(e,t,n,r){return ru(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.ln(n,t.key),documentKey:t.key.path.toArray()})}},{key:"In",value:function(e,t,n,r){return ru(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.ln(n,t.key),t.key.path.toArray()])}},{key:"mn",value:function(e,t,n){var r=ru(e),i=new dn(Ua);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.ln(n,t)])},function(e,r){i=i.add(new qa(n.indexId,t,r.arrayValue,r.directionalValue))}).next(function(){return i})}},{key:"gn",value:function(e,t){var n=new dn(Ua),r=this.hn(t,e);if(null==r)return n;var i=Te(t);if(null!=i){var a=e.data.field(i.fieldPath);if(Dt(a)){var u,o=p(a.arrayValue.values||[]);try{for(o.s();!(u=o.n()).done;){var s=u.value;n=n.add(new qa(t.indexId,e.key,this.un(s),r))}}catch(c){o.e(c)}finally{o.f()}}}else n=n.add(new qa(t.indexId,e.key,eu,r));return n}},{key:"yn",value:function(e,t,n,r,i){var a=this;j("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var u=[];return function(e,t,n,r,i){for(var a=e.getIterator(),u=t.getIterator(),o=yn(a),s=yn(u);o||s;){var c=!1,l=!1;if(o&&s){var f=n(o,s);f<0?l=!0:f>0&&(c=!0)}else null!=o?l=!0:c=!0;c?(r(s),s=yn(u)):l?(i(o),o=yn(a)):(o=yn(a),s=yn(u))}}(r,i,Ua,function(r){u.push(a.pn(e,t,n,r))},function(r){u.push(a.In(e,t,n,r))}),Pe.waitFor(u)}},{key:"wn",value:function(e){var t=1;return au(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},function(e,n,r){r.done(),t=n.sequenceNumber+1}).next(function(){return t})}},{key:"createRange",value:function(e,t,n){n=n.sort(function(e,t){return Ua(e,t)}).filter(function(e,t,n){return!t||0!==Ua(e,n[t-1])});var r=[];r.push(e);var i,a=p(n);try{for(a.s();!(i=a.n()).done;){var u=i.value,o=Ua(u,e),s=Ua(u,t);if(0===o)r[0]=e.Ge();else if(o>0&&s<0)r.push(u),r.push(u.Ge());else if(s>0)break}}catch(d){a.e(d)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2){if(this.Tn(r[l],r[l+1]))return[];var f=[r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,eu,[]],h=[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,eu,[]];c.push(IDBKeyRange.bound(f,h))}return c}},{key:"Tn",value:function(e,t){return Ua(e,t)>0}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(uu)}},{key:"getMinOffset",value:function(e,t){var n=this;return Pe.mapArray(this.en(t),function(t){return n.nn(e,t).next(function(e){return e||X()})}).next(uu)}}]),e}();function nu(e){return ca(e,"collectionParents")}function ru(e){return ca(e,"indexEntries")}function iu(e){return ca(e,"indexConfiguration")}function au(e){return ca(e,"indexState")}function uu(e){Y(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;Le(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Fe(t.readTime,t.documentKey,n)}var ou={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},su=function(){function e(t,n,r){R(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return O(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function cu(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],u=IDBKeyRange.only(n.batchId),o=0,s=r.X({range:u},function(e,t,n){return o++,n.delete()});a.push(s.next(function(){Y(1===o)}));var c,l=[],f=p(n.mutations);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=Bi(t,h.key.path,n.batchId);a.push(i.delete(d)),l.push(h.key)}}catch(v){f.e(v)}finally{f.f()}return Pe.waitFor(a).next(function(){return l})}function lu(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw X();t=e.noDocument}return JSON.stringify(t).length}su.DEFAULT_COLLECTION_PERCENTILE=10,su.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,su.DEFAULT=new su(41943040,su.DEFAULT_COLLECTION_PERCENTILE,su.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),su.DISABLED=new su(-1,0,0);var fu=function(){function e(t,n,r,i){R(this,e),this.userId=t,this.Tt=n,this.indexManager=r,this.referenceDelegate=i,this.En={}}return O(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return du(e).X({index:"userMutationsIndex",range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=vu(e),u=du(e);return u.add({}).next(function(o){Y("number"==typeof o);var s,c=new la(o,t,n,r),l=function(e,t,n){var r=n.baseMutations.map(function(t){return ki(e.oe,t)}),i=n.mutations.map(function(t){return ki(e.oe,t)});return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.Tt,i.userId,c),f=[],h=new dn(function(e,t){return de(e.canonicalString(),t.canonicalString())}),d=p(r);try{for(d.s();!(s=d.n()).done;){var v=s.value,y=Bi(i.userId,v.key.path,o);h=h.add(v.key.path.popLast()),f.push(u.put(l)),f.push(a.put(y,Ki))}}catch(m){d.e(m)}finally{d.f()}return h.forEach(function(t){f.push(i.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.En[o]=c.keys()}),Pe.waitFor(f).next(function(){return c})})}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return du(e).get(t).next(function(e){return e?(Y(e.userId===n.userId),wa(n.Tt,e)):null})}},{key:"An",value:function(e,t){var n=this;return this.En[t]?Pe.resolve(this.En[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.En[t]=r,r}return null})}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return du(e).X({index:"userMutationsIndex",range:i},function(e,t,i){t.userId===n.userId&&(Y(t.batchId>=r),a=wa(n.Tt,t)),i.done()}).next(function(){return a})}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return du(e).X({index:"userMutationsIndex",range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return du(e).W("userMutationsIndex",n).next(function(e){return e.map(function(e){return wa(t.Tt,e)})})}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=Ui(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return vu(e).X({range:i},function(r,i,u){var o=c(r,3),s=o[0],l=o[1],f=o[2],h=Pi(l);if(s===n.userId&&t.path.isEqual(h))return du(e).get(f).next(function(e){if(!e)throw X();Y(e.userId===n.userId),a.push(wa(n.Tt,e))});u.done()}).next(function(){return a})}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new dn(de),i=[];return t.forEach(function(t){var a=Ui(n.userId,t.path),u=IDBKeyRange.lowerBound(a),o=vu(e).X({range:u},function(e,i,a){var u=c(e,3),o=u[0],s=u[1],l=u[2],f=Pi(s);o===n.userId&&t.path.isEqual(f)?r=r.add(l):a.done()});i.push(o)}),Pe.waitFor(i).next(function(){return n.Rn(e,r)})}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=Ui(this.userId,r),u=IDBKeyRange.lowerBound(a),o=new dn(de);return vu(e).X({range:u},function(e,t,a){var u=c(e,3),s=u[0],l=u[1],f=u[2],h=Pi(l);s===n.userId&&r.isPrefixOf(h)?h.length===i&&(o=o.add(f)):a.done()}).next(function(){return n.Rn(e,o)})}},{key:"Rn",value:function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(du(e).get(t).next(function(e){if(null===e)throw X();Y(e.userId===n.userId),r.push(wa(n.Tt,e))}))}),Pe.waitFor(i).next(function(){return r})}},{key:"removeMutationBatch",value:function(e,t){var n=this;return cu(e.re,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.Pn(t.batchId)}),Pe.forEach(r,function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)})})}},{key:"Pn",value:function(e){delete this.En[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return Pe.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return vu(e).X({range:r},function(e,n,r){if(e[0]===t.userId){var a=Pi(e[1]);i.push(a)}else r.done()}).next(function(){Y(0===i.length)})})}},{key:"containsKey",value:function(e,t){return hu(e,this.userId,t)}},{key:"vn",value:function(e){var t=this;return yu(e).get(this.userId).next(function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}})}}],[{key:"ue",value:function(t,n,r,i){return Y(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function hu(e,t,n){var r=Ui(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),u=!1;return vu(e).X({range:a,Z:!0},function(e,n,r){var a=c(e,3),o=a[0],s=a[1];a[2];o===t&&s===i&&(u=!0),r.done()}).next(function(){return u})}function du(e){return ca(e,"mutations")}function vu(e){return ca(e,"documentMutations")}function yu(e){return ca(e,"mutationQueues")}var pu=function(){function e(t){R(this,e),this.bn=t}return O(e,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Vn",value:function(){return new e(0)}},{key:"Sn",value:function(){return new e(-1)}}]),e}(),mu=function(){function e(t,n){R(this,e),this.referenceDelegate=t,this.Tt=n}return O(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.Dn(e).next(function(n){var r=new pu(n.highestTargetId);return n.highestTargetId=r.next(),t.Cn(e,n).next(function(){return n.highestTargetId})})}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Dn(e).next(function(e){return me.fromTimestamp(new pe(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})}},{key:"getHighestSequenceNumber",value:function(e){return this.Dn(e).next(function(e){return e.highestListenSequenceNumber})}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Dn(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Cn(e,i)})}},{key:"addTargetData",value:function(e,t){var n=this;return this.xn(e,t).next(function(){return n.Dn(e).next(function(r){return r.targetCount+=1,n.Nn(t,r),n.Cn(e,r)})})}},{key:"updateTargetData",value:function(e,t){return this.xn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return gu(e).delete(t.targetId)}).next(function(){return n.Dn(e)}).next(function(t){return Y(t.targetCount>0),t.targetCount-=1,n.Cn(e,t)})}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return gu(e).X(function(u,o){var s=xa(o);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))}).next(function(){return Pe.waitFor(a)}).next(function(){return i})}},{key:"forEachTarget",value:function(e,t){return gu(e).X(function(e,n){var r=xa(n);t(r)})}},{key:"Dn",value:function(e){return ku(e).get("targetGlobalKey").next(function(e){return Y(null!==e),e})}},{key:"Cn",value:function(e,t){return ku(e).put("targetGlobalKey",t)}},{key:"xn",value:function(e,t){return gu(e).put(ba(this.Tt,t))}},{key:"Nn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Dn(e).next(function(e){return e.targetCount})}},{key:"getTargetData",value:function(e,t){var n=bn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return gu(e).X({range:r,index:"queryTargetsIndex"},function(e,n,r){var a=xa(n);In(t,a.target)&&(i=a,r.done())}).next(function(){return i})}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=wu(e);return t.forEach(function(t){var u=Mi(t.path);i.push(a.put({targetId:n,path:u})),i.push(r.referenceDelegate.addReference(e,n,t))}),Pe.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=wu(e);return Pe.forEach(t,function(t){var a=Mi(t.path);return Pe.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])})}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=wu(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=wu(e),i=Br();return r.X({range:n,Z:!0},function(e,t,n){var r=Pi(e[1]),a=new be(r);i=i.add(a)}).next(function(){return i})}},{key:"containsKey",value:function(e,t){var n=Mi(t.path),r=IDBKeyRange.bound([n],[ye(n)],!1,!0),i=0;return wu(e).X({index:"documentTargetsIndex",Z:!0,range:r},function(e,t,n){var r=c(e,2),a=r[0];r[1];0!==a&&(i++,n.done())}).next(function(){return i>0})}},{key:"ie",value:function(e,t){return gu(e).get(t).next(function(e){return e?xa(e):null})}}]),e}();function gu(e){return ca(e,"targets")}function ku(e){return ca(e,"targetGlobal")}function wu(e){return ca(e,"targetDocuments")}function xu(e,t){var n=c(e,2),r=n[0],i=n[1],a=c(t,2),u=a[0],o=a[1],s=de(r,u);return 0===s?de(i,o):s}var bu=function(){function e(t){R(this,e),this.kn=t,this.buffer=new dn(xu),this.$n=0}return O(e,[{key:"Mn",value:function(){return++this.$n}},{key:"On",value:function(e){var t=[e,this.Mn()];if(this.buffer.size<this.kn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();xu(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),Iu=function(){function e(t,n,r){R(this,e),this.garbageCollector=t,this.asyncQueue=n,this.localStore=r,this.Fn=null}return O(e,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Bn(6e4)}},{key:"stop",value:function(){this.Fn&&(this.Fn.cancel(),this.Fn=null)}},{key:"started",get:function(){return null!==this.Fn}},{key:"Bn",value:function(e){var t=this;j("LruGarbageCollector","Garbage collection scheduled in ".concat(e,"ms")),this.Fn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Fn=null,e.prev=1,e.next=4,t.localStore.collectGarbage(t.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!Ge(e.t0)){e.next=12;break}j("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Oe(e.t0);case 14:return e.next=16,t.Bn(3e5);case 16:case"end":return e.stop()}},e,null,[[1,6]])})))}}]),e}(),Tu=function(){function e(t,n){R(this,e),this.Ln=t,this.params=n}return O(e,[{key:"calculateTargetCount",value:function(e,t){return this.Ln.qn(e).next(function(e){return Math.floor(t/100*e)})}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Pe.resolve(Ye.at);var r=new bu(t);return this.Ln.forEachTarget(e,function(e){return r.On(e.sequenceNumber)}).next(function(){return n.Ln.Un(e,function(e){return r.On(e)})}).next(function(){return r.maxValue})}},{key:"removeTargets",value:function(e,t,n){return this.Ln.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.Ln.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(ou)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),ou):n.Kn(e,t)})}},{key:"getCacheSize",value:function(e){return this.Ln.getCacheSize(e)}},{key:"Kn",value:function(e,t){var n,r,a,u,o,s,c,l=this,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>l.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(l.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=l.params.maximumSequenceNumbersToCollect):r=t,u=Date.now(),l.nthSequenceNumber(e,r)}).next(function(r){return n=r,o=Date.now(),l.removeTargets(e,n,t)}).next(function(t){return a=t,s=Date.now(),l.removeOrphanedDocuments(e,n)}).next(function(e){return c=Date.now(),G()<=i.LogLevel.DEBUG&&j("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(u-f,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-u)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-s)+"ms\n"+"Total Duration: ".concat(c-f,"ms")),Pe.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:e})})}}]),e}(),Eu=function(){function e(t,n){R(this,e),this.db=t,this.garbageCollector=function(e,t){return new Tu(e,t)}(this,n)}return O(e,[{key:"qn",value:function(e){var t=this.Gn(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})}},{key:"Gn",value:function(e){var t=0;return this.Un(e,function(e){t++}).next(function(){return t})}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Un",value:function(e,t){return this.Qn(e,function(e,n){return t(n)})}},{key:"addReference",value:function(e,t,n){return Su(e,n)}},{key:"removeReference",value:function(e,t,n){return Su(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return Su(e,t)}},{key:"jn",value:function(e,t){return function(e,t){var n=!1;return yu(e).tt(function(r){return hu(e,r,t).next(function(e){return e&&(n=!0),Pe.resolve(!e)})}).next(function(){return n})}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Qn(e,function(u,o){if(o<=t){var s=n.jn(e,u).next(function(t){if(!t)return a++,r.getEntry(e,u).next(function(){return r.removeEntry(u,me.min()),wu(e).delete([0,Mi(u.path)])})});i.push(s)}}).next(function(){return Pe.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return a})}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return Su(e,t)}},{key:"Qn",value:function(e,t){var n,r=wu(e),i=Ye.at;return r.X({index:"documentTargetsIndex"},function(e,r){var a=c(e,2),u=a[0],o=(a[1],r.path),s=r.sequenceNumber;0===u?(i!==Ye.at&&t(new be(Pi(n)),i),i=s,n=o):i=Ye.at}).next(function(){i!==Ye.at&&t(new be(Pi(n)),i)})}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function Su(e,t){return wu(e).put(function(e,t){return{targetId:0,path:Mi(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var _u=function(){function e(){R(this,e),this.changes=new Nr(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return O(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,kn.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Pe.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),Au=function(){function e(t){R(this,e),this.Tt=t}return O(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return Fu(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return Fu(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],ma(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.zn(e,r)})}},{key:"getEntry",value:function(e,t){var n=this,r=kn.newInvalidDocument(t);return Fu(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(t))},function(e,i){r=n.Wn(t,i)}).next(function(){return r})}},{key:"Hn",value:function(e,t){var n=this,r={size:0,document:kn.newInvalidDocument(t)};return Fu(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Lu(t))},function(e,i){r={document:n.Wn(t,i),size:lu(i)}}).next(function(){return r})}},{key:"getEntries",value:function(e,t){var n=this,r=Fr();return this.Jn(e,t,function(e,t){var i=n.Wn(e,t);r=r.insert(e,i)}).next(function(){return r})}},{key:"Yn",value:function(e,t){var n=this,r=Fr(),i=new ln(be.comparator);return this.Jn(e,t,function(e,t){var a=n.Wn(e,t);r=r.insert(e,a),i=i.insert(e,lu(t))}).next(function(){return{documents:r,Zn:i}})}},{key:"Jn",value:function(e,t,n){if(t.isEmpty())return Pe.resolve();var r=new dn(Mu);t.forEach(function(e){return r=r.add(e)});var i=IDBKeyRange.bound(Lu(r.first()),Lu(r.last())),a=r.getIterator(),u=a.getNext();return Fu(e).X({index:"documentKeyIndex",range:i},function(e,t,r){for(var i=be.fromSegments([].concat(_(t.prefixPath),[t.collectionGroup,t.documentId]));u&&Mu(u,i)<0;)n(u,null),u=a.getNext();u&&u.isEqual(i)&&(n(u,t),u=a.hasNext()?a.getNext():null),u?r.j(Lu(u)):r.done()}).next(function(){for(;u;)n(u,null),u=a.hasNext()?a.getNext():null})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this,a=t.path,u=[a.popLast().toArray(),a.lastSegment(),ma(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fu(e).W(IDBKeyRange.bound(u,o,!0)).next(function(e){var n,a=Fr(),u=p(e);try{for(u.s();!(n=u.n()).done;){var o=n.value,s=i.Wn(be.fromSegments(o.prefixPath.concat(o.collectionGroup,o.documentId)),o);s.isFoundDocument()&&(Kn(t,s)||r.has(s.key))&&(a=a.insert(s.key,s))}}catch(c){u.e(c)}finally{u.f()}return a})}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=Fr(),u=Ru(t,n),o=Ru(t,Fe.max());return Fu(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(u,o,!0)},function(e,t,n){var u=i.Wn(be.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(u.key,u)).size===r&&n.done()}).next(function(){return a})}},{key:"newChangeBuffer",value:function(e){return new Nu(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next(function(e){return e.byteSize})}},{key:"getMetadata",value:function(e){return Cu(e).get("remoteDocumentGlobalKey").next(function(e){return Y(!!e),e})}},{key:"zn",value:function(e,t){return Cu(e).put("remoteDocumentGlobalKey",t)}},{key:"Wn",value:function(e,t){if(t){var n=ya(this.Tt,t);if(!n.isNoDocument()||!n.version.isEqual(me.min()))return n}return kn.newInvalidDocument(e)}}]),e}();function Du(e){return new Au(e)}var Nu=function(e){w(n,_u);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).Xn=e,i.trackRemovals=r,i.ts=new Nr(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),i}return O(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new dn(function(e,t){return de(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(a,u){var o=t.ts.get(a);if(n.push(t.Xn.removeEntry(e,a,o.readTime)),u.isValidDocument()){var s=pa(t.Xn.Tt,u);i=i.add(a.path.popLast());var c=lu(s);r+=c-o.size,n.push(t.Xn.addEntry(e,a,s))}else if(r-=o.size,t.trackRemovals){var l=pa(t.Xn.Tt,u.convertToNoDocument(me.min()));n.push(t.Xn.addEntry(e,a,l))}}),i.forEach(function(r){n.push(t.Xn.indexManager.addToCollectionParentIndex(e,r))}),n.push(this.Xn.updateMetadata(e,r)),Pe.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Xn.Hn(e,t).next(function(e){return n.ts.set(t,{size:e.size,readTime:e.document.readTime}),e.document})}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Xn.Yn(e,t).next(function(e){var t=e.documents;return e.Zn.forEach(function(e,r){n.ts.set(e,{size:r,readTime:t.get(e).readTime})}),t})}}]),n}();function Cu(e){return ca(e,"remoteDocumentGlobal")}function Fu(e){return ca(e,"remoteDocumentsV14")}function Lu(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Ru(e,t){var n=t.documentKey.path.toArray();return[e,ma(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Mu(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=de(n[a],r[a]))return i;return(i=de(n.length,r.length))||((i=de(n[n.length-2],r[r.length-2]))||de(n[n.length-1],r[r.length-1]))}var Ou=O(function e(t,n){R(this,e),this.overlayedDocument=t,this.mutatedFields=n}),Vu=function(){function e(t,n,r,i){R(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return O(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.remoteDocumentCache.getEntry(e,t)}).next(function(e){return null!==r&&yr(r.mutation,e,pn.empty(),pe.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,Br()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Br(),i=Or();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=Rr();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=Or();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,Br())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=Fr(),a=Pr(),u=Pr();return t.forEach(function(e,t){var u=n.get(t.key);r.has(t.key)&&(void 0===u||u.mutation instanceof kr)?i=i.insert(t.key,t):void 0!==u?(a.set(t.key,u.mutation.getFieldMask()),yr(u.mutation,t,u.mutation.getFieldMask(),pe.now())):a.set(t.key,pn.empty())}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return u.set(e,new Ou(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),u})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Pr(),i=new ln(function(e,t){return e-t}),a=Br();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=p(e);try{var u=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var u=r.get(n)||pn.empty();u=e.applyToLocalView(a,u),r.set(n,u);var o=(i.get(e.batchId)||Br()).add(n);i=i.insert(e.batchId,o)}})};for(a.s();!(n=a.n()).done;)u()}catch(o){a.e(o)}finally{a.f()}}).next(function(){for(var u=[],o=i.getReverseIterator(),s=function(){var i=o.getNext(),s=i.key,c=i.value,l=Vr();c.forEach(function(e){if(!a.has(e)){var n=dr(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),u.push(n.documentOverlayCache.saveOverlays(e,s,l))};o.hasNext();)s();return Pe.waitFor(u)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return be.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var u=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Pe.resolve(Or()),o=-1,s=a;return u.next(function(t){return Pe.forEach(t,function(t,n){return o<n.largestBatchId&&(o=n.largestBatchId),a.get(t)?Pe.resolve():i.remoteDocumentCache.getEntry(e,t).next(function(e){s=s.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,s,t,Br())}).next(function(e){return{batchId:o,changes:Mr(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new be(t)).next(function(e){var t=Rr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=Rr();return this.indexManager.getCollectionParents(e,i).next(function(u){return Pe.forEach(u,function(u){var o=function(e,t){return new An(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,u.child(i));return r.getDocumentsMatchingCollectionQuery(e,o,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(function(a){return r=a,i.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)}).next(function(e){r.forEach(function(t,n){var r=n.getKey();null===e.get(r)&&(e=e.insert(r,kn.newInvalidDocument(r)))});var n=Rr();return e.forEach(function(e,i){var a=r.get(e);void 0!==a&&yr(a.mutation,i,pn.empty(),pe.now()),Kn(t,i)&&(n=n.insert(e,i))}),n})}}]),e}(),Pu=function(){function e(t){R(this,e),this.Tt=t,this.es=new Map,this.ns=new Map}return O(e,[{key:"getBundleMetadata",value:function(e,t){return Pe.resolve(this.es.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.es.set(t.id,{id:(n=t).id,version:n.version,createTime:ui(n.createTime)}),Pe.resolve()}},{key:"getNamedQuery",value:function(e,t){return Pe.resolve(this.ns.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ns.set(t.name,function(e){return{name:e.name,query:Ia(e.bundledQuery),readTime:ui(e.readTime)}}(t)),Pe.resolve()}}]),e}(),qu=function(){function e(){R(this,e),this.overlays=new ln(be.comparator),this.ss=new Map}return O(e,[{key:"getOverlay",value:function(e,t){return Pe.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=Or();return Pe.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ce(e,t,i)}),Pe.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.ss.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.ss.delete(n)),Pe.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=Or(),i=t.length+1,a=new be(t.child("")),u=this.overlays.getIteratorFrom(a);u.hasNext();){var o=u.getNext().value,s=o.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&o.largestBatchId>n&&r.set(o.getKey(),o)}return Pe.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new ln(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>n){var o=i.get(u.largestBatchId);null===o&&(o=Or(),i=i.insert(u.largestBatchId,o)),o.set(u.getKey(),u)}}for(var s=Or(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return s.set(e,t)}),!(s.size()>=r)););return Pe.resolve(s)}},{key:"ce",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.ss.get(r.largestBatchId).delete(n.key);this.ss.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new ha(t,n));var a=this.ss.get(t);void 0===a&&(a=Br(),this.ss.set(t,a)),this.ss.set(t,a.add(n.key))}}]),e}(),Uu=function(){function e(){R(this,e),this.rs=new dn(Bu.os),this.us=new dn(Bu.cs)}return O(e,[{key:"isEmpty",value:function(){return this.rs.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Bu(e,t);this.rs=this.rs.add(n),this.us=this.us.add(n)}},{key:"hs",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.ls(new Bu(e,t))}},{key:"fs",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"ds",value:function(e){var t=this,n=new be(new ke([])),r=new Bu(n,e),i=new Bu(n,e+1),a=[];return this.us.forEachInRange([r,i],function(e){t.ls(e),a.push(e.key)}),a}},{key:"_s",value:function(){var e=this;this.rs.forEach(function(t){return e.ls(t)})}},{key:"ls",value:function(e){this.rs=this.rs.delete(e),this.us=this.us.delete(e)}},{key:"ws",value:function(e){var t=new be(new ke([])),n=new Bu(t,e),r=new Bu(t,e+1),i=Br();return this.us.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new Bu(e,0),n=this.rs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Bu=function(){function e(t,n){R(this,e),this.key=t,this.gs=n}return O(e,null,[{key:"os",value:function(e,t){return be.comparator(e.key,t.key)||de(e.gs,t.gs)}},{key:"cs",value:function(e,t){return de(e.gs,t.gs)||be.comparator(e.key,t.key)}}]),e}(),Ku=function(){function e(t,n){R(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.ys=1,this.ps=new dn(Bu.os)}return O(e,[{key:"checkEmpty",value:function(e){return Pe.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ys;this.ys++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new la(i,t,n,r);this.mutationQueue.push(a);var u,o=p(r);try{for(o.s();!(u=o.n()).done;){var s=u.value;this.ps=this.ps.add(new Bu(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){o.e(c)}finally{o.f()}return Pe.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Pe.resolve(this.Is(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.Ts(n),i=r<0?0:r;return Pe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Pe.resolve(0===this.mutationQueue.length?-1:this.ys-1)}},{key:"getAllMutationBatches",value:function(e){return Pe.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Bu(t,0),i=new Bu(t,Number.POSITIVE_INFINITY),a=[];return this.ps.forEachInRange([r,i],function(e){var t=n.Is(e.gs);a.push(t)}),Pe.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new dn(de);return t.forEach(function(e){var t=new Bu(e,0),i=new Bu(e,Number.POSITIVE_INFINITY);n.ps.forEachInRange([t,i],function(e){r=r.add(e.gs)})}),Pe.resolve(this.Es(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;be.isDocumentKey(i)||(i=i.child(""));var a=new Bu(new be(i),0),u=new dn(de);return this.ps.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(u=u.add(e.gs)),!0)},a),Pe.resolve(this.Es(u))}},{key:"Es",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t.Is(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Y(0===this.As(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ps;return Pe.forEach(t.mutations,function(i){var a=new Bu(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ps=r})}},{key:"Pn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Bu(t,0),r=this.ps.firstAfterOrEqual(n);return Pe.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Pe.resolve()}},{key:"As",value:function(e,t){return this.Ts(e)}},{key:"Ts",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"Is",value:function(e){var t=this.Ts(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Gu=function(){function e(t){R(this,e),this.Rs=t,this.docs=new ln(be.comparator),this.size=0}return O(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Rs(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Pe.resolve(n?n.document.mutableCopy():kn.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=Fr();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():kn.newInvalidDocument(e))}),Pe.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){for(var i=Fr(),a=t.path,u=new be(a.child("")),o=this.docs.getIteratorFrom(u);o.hasNext();){var s=o.getNext(),c=s.key,l=s.value.document;if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Le(Ce(l),n)<=0||(r.has(l.key)||Kn(t,l))&&(i=i.insert(l.key,l.mutableCopy()))}return Pe.resolve(i)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){X()}},{key:"Ps",value:function(e,t){return Pe.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new Qu(this)}},{key:"getSize",value:function(e){return Pe.resolve(this.size)}}]),e}(),Qu=function(e){w(n,_u);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).Xn=e,r}return O(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.Xn.addEntry(e,i)):t.Xn.removeEntry(r)}),Pe.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Xn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Xn.getEntries(e,t)}}]),n}(),ju=function(){function e(t){R(this,e),this.persistence=t,this.vs=new Nr(function(e){return bn(e)},In),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.bs=0,this.Vs=new Uu,this.targetCount=0,this.Ss=pu.Vn()}return O(e,[{key:"forEachTarget",value:function(e,t){return this.vs.forEach(function(e,n){return t(n)}),Pe.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Pe.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ss.next(),Pe.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Pe.resolve()}},{key:"xn",value:function(e){this.vs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ss=new pu(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.xn(t),this.targetCount+=1,Pe.resolve()}},{key:"updateTargetData",value:function(e,t){return this.xn(t),Pe.resolve()}},{key:"removeTargetData",value:function(e,t){return this.vs.delete(t.target),this.Vs.ds(t.targetId),this.targetCount-=1,Pe.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.vs.forEach(function(u,o){o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r.vs.delete(u),a.push(r.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),Pe.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return Pe.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.vs.get(t)||null;return Pe.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Vs.hs(t,n),Pe.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Vs.fs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Pe.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Vs.ds(t),Pe.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Vs.ws(t);return Pe.resolve(n)}},{key:"containsKey",value:function(e,t){return Pe.resolve(this.Vs.containsKey(t))}}]),e}(),zu=function(){function e(t,n){var r=this;R(this,e),this.Ds={},this.overlays={},this.Cs=new Ye(0),this.xs=!1,this.xs=!0,this.referenceDelegate=t(this),this.Ns=new ju(this),this.indexManager=new Za,this.remoteDocumentCache=new Gu(function(e){return r.referenceDelegate.ks(e)}),this.Tt=new va(n),this.$s=new Pu(this.Tt)}return O(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.xs=!1,Promise.resolve()}},{key:"started",get:function(){return this.xs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new qu,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Ds[e.toKey()];return n||(n=new Ku(t,this.referenceDelegate),this.Ds[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Ns}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.$s}},{key:"runTransaction",value:function(e,t,n){var r=this;j("MemoryPersistence","Starting transaction:",e);var i=new Wu(this.Cs.next());return this.referenceDelegate.Ms(),n(i).next(function(e){return r.referenceDelegate.Os(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Fs",value:function(e,t){return Pe.or(Object.values(this.Ds).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),Wu=function(e){w(n,Me);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return O(n)}(),Hu=function(){function e(t){R(this,e),this.persistence=t,this.Bs=new Uu,this.Ls=null}return O(e,[{key:"Us",get:function(){if(this.Ls)return this.Ls;throw X()}},{key:"addReference",value:function(e,t,n){return this.Bs.addReference(n,t),this.Us.delete(n.toString()),Pe.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Bs.removeReference(n,t),this.Us.add(n.toString()),Pe.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Us.add(t.toString()),Pe.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Bs.ds(t.targetId).forEach(function(e){return n.Us.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Us.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Ms",value:function(){this.Ls=new Set}},{key:"Os",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.Us,function(r){var i=be.fromPath(r);return t.Ks(e,i).next(function(e){e||n.removeEntry(i,me.min())})}).next(function(){return t.Ls=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Ks(e,t).next(function(e){e?n.Us.delete(t.toString()):n.Us.add(t.toString())})}},{key:"ks",value:function(e){return 0}},{key:"Ks",value:function(e,t){var n=this;return Pe.or([function(){return Pe.resolve(n.Bs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Fs(e,t)}])}}],[{key:"qs",value:function(t){return new e(t)}}]),e}(),Xu=function(){function e(t){R(this,e),this.Tt=t}return O(e,[{key:"F",value:function(e,t,n,r){var i=this,a=new qe("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qi,{unique:!0}),e.createObjectStore("documentMutations")}(e),Yu(e),function(e){e.createObjectStore("remoteDocuments")}(e));var u=Pe.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Yu(e)),u=u.next(function(){return e=a.store("targetGlobal"),t={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:me.min().toTimestamp(),targetCount:0},e.put("targetGlobalKey",t);var e,t})),n<4&&r>=4&&(0!==n&&(u=u.next(function(){return function(e,t){return t.store("mutations").W().next(function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qi,{unique:!0});var r=t.store("mutations"),i=n.map(function(e){return r.put(e)});return Pe.waitFor(i)})}(e,a)})),u=u.next(function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(u=u.next(function(){return i.Gs(a)})),n<6&&r>=6&&(u=u.next(function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Qs(a)})),n<7&&r>=7&&(u=u.next(function(){return i.js(a)})),n<8&&r>=8&&(u=u.next(function(){return i.zs(e,a)})),n<9&&r>=9&&(u=u.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(u=u.next(function(){return i.Ws(a)})),n<11&&r>=11&&(u=u.next(function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(u=u.next(function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:ea});t.createIndex("collectionPathOverlayIndex",ta,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",na,{unique:!1})}(e)})),n<13&&r>=13&&(u=u.next(function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:Gi});t.createIndex("documentKeyIndex",Qi),t.createIndex("collectionGroupIndex",ji)}(e)}).next(function(){return i.Hs(e,a)}).next(function(){return e.deleteObjectStore("remoteDocuments")})),n<14&&r>=14&&(u=u.next(function(){return i.Js(e,a)})),n<15&&r>=15&&(u=u.next(function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Yi}).createIndex("sequenceNumberIndex",Ji,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Zi}).createIndex("documentKeyIndex",$i,{unique:!1})}(e)})),u}},{key:"Qs",value:function(e){var t=0;return e.store("remoteDocuments").X(function(e,n){t+=lu(n)}).next(function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}},{key:"Gs",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(function(n){return Pe.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",i).next(function(r){return Pe.forEach(r,function(r){Y(r.userId===n.userId);var i=wa(t.Tt,r);return cu(e,n.userId,i).next(function(){})})})})})}},{key:"js",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(function(e){var r=[];return n.X(function(n,i){var a=new ke(n),u=[0,Mi(a)];r.push(t.get(u).next(function(n){return n?Pe.resolve():function(n){return t.put({targetId:0,path:Mi(n),sequenceNumber:e.highestListenSequenceNumber})}(a)}))}).next(function(){return Pe.waitFor(r)})})}},{key:"zs",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:Xi});var n=t.store("collectionParents"),r=new $a,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Mi(i)})}};return t.store("remoteDocuments").X({Z:!0},function(e,t){var n=new ke(e);return i(n.popLast())}).next(function(){return t.store("documentMutations").X({Z:!0},function(e,t){var n=c(e,3),r=(n[0],n[1]),a=(n[2],Pi(r));return i(a.popLast())})})}},{key:"Ws",value:function(e){var t=this,n=e.store("targets");return n.X(function(e,r){var i=xa(r),a=ba(t.Tt,i);return n.put(a)})}},{key:"Hs",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.X(function(e,n){var i,a=t.store("remoteDocumentsV14"),u=(i=n,i.document?new be(ke.fromString(i.document.name).popFirst(5)):i.noDocument?be.fromSegments(i.noDocument.path):i.unknownDocument?be.fromSegments(i.unknownDocument.path):X()).path.toArray(),o={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(o))}).next(function(){return Pe.waitFor(r)})}},{key:"Js",value:function(e,t){var n=this,r=t.store("mutations"),i=Du(this.Tt),a=new zu(Hu.qs,this.Tt.oe);return r.W().next(function(e){var r=new Map;return e.forEach(function(e){var t,i=null!==(t=r.get(e.userId))&&void 0!==t?t:Br();wa(n.Tt,e).keys().forEach(function(e){return i=i.add(e)}),r.set(e.userId,i)}),Pe.forEach(r,function(e,r){var u=new U(r),o=Na.ue(n.Tt,u),s=a.getIndexManager(u),c=fu.ue(u,n.Tt,s,a.referenceDelegate);return new Vu(i,c,o,s).recalculateAndSaveOverlaysForDocumentKeys(new sa(t,Ye.at),e).next()})})}}]),e}();function Yu(e){e.createObjectStore("targetDocuments",{keyPath:Wi}).createIndex("documentTargetsIndex",Hi,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",zi,{unique:!0}),e.createObjectStore("targetGlobal")}var Ju="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Zu=function(){function e(t,n,r,i,a,u,o,s,c,l){var f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(R(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Ys=a,this.window=u,this.document=o,this.Zs=c,this.Xs=l,this.ti=f,this.Cs=null,this.xs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ei=null,this.inForeground=!1,this.ni=null,this.si=null,this.ii=Number.NEGATIVE_INFINITY,this.ri=function(e){return Promise.resolve()},!e.C())throw new ee($.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Eu(this,i),this.oi=n+"main",this.Tt=new va(s),this.ui=new Ue(this.oi,this.ti,new Xu(this.Tt)),this.Ns=new mu(this.referenceDelegate,this.Tt),this.remoteDocumentCache=Du(this.Tt),this.$s=new _a,this.window&&this.window.localStorage?this.ci=this.window.localStorage:(this.ci=null,!1===l&&z("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return O(e,[{key:"start",value:function(){var e=this;return this.ai().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new ee($.FAILED_PRECONDITION,Ju);return e.hi(),e.li(),e.fi(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ns.getHighestSequenceNumber(t)})}).then(function(t){e.Cs=new Ye(t,e.Zs)}).then(function(){e.xs=!0}).catch(function(t){return e.ui&&e.ui.close(),Promise.reject(t)})}},{key:"di",value:function(e){var t=this;return this.ri=function(){var n=k(m().mark(function n(r){return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.ui.L(function(){var t=k(m().mark(function t(n){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ys.enqueueAndForget(k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.ai();case 4:case"end":return e.stop()}},e)}))))}},{key:"ai",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return eo(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next(function(){if(e.isPrimary)return e._i(t).next(function(t){t||(e.isPrimary=!1,e.Ys.enqueueRetryable(function(){return e.ri(!1)}))})}).next(function(){return e.wi(t)}).next(function(n){return e.isPrimary&&!n?e.mi(t).next(function(){return!1}):!!n&&e.gi(t).next(function(){return!0})})}).catch(function(t){if(Ge(t))return j("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return j("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.Ys.enqueueRetryable(function(){return e.ri(t)}),e.isPrimary=t})}},{key:"_i",value:function(e){var t=this;return $u(e).get("owner").next(function(e){return Pe.resolve(t.yi(e))})}},{key:"pi",value:function(e){return eo(e).delete(this.clientId)}},{key:"Ii",value:function(){var e=k(m().mark(function e(){var t,n,r,i,a=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.Ti(this.ii,18e5)){e.next=6;break}return this.ii=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var t=ca(e,"clientMetadata");return t.W().next(function(e){var n=a.Ei(e,18e5),r=e.filter(function(e){return-1===n.indexOf(e)});return Pe.forEach(r,function(e){return t.delete(e.clientId)}).next(function(){return r})})}).catch(function(){return[]});case 4:if(t=e.sent,this.ci){n=p(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.ci.removeItem(this.Ai(i.clientId))}catch(u){n.e(u)}finally{n.f()}}case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fi",value:function(){var e=this;this.si=this.Ys.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.ai().then(function(){return e.Ii()}).then(function(){return e.fi()})})}},{key:"yi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"wi",value:function(e){var t=this;return this.Xs?Pe.resolve(!0):$u(e).get("owner").next(function(n){if(null!==n&&t.Ti(n.leaseTimestampMs,5e3)&&!t.Ri(n.ownerId)){if(t.yi(n)&&t.networkEnabled)return!0;if(!t.yi(n)){if(!n.allowTabSynchronization)throw new ee($.FAILED_PRECONDITION,Ju);return!1}}return!(!t.networkEnabled||!t.inForeground)||eo(e).W().next(function(e){return void 0===t.Ei(e,5e3).find(function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(e){return t.isPrimary!==e&&j("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e})}},{key:"shutdown",value:function(){var e=k(m().mark(function e(){var t=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.xs=!1,this.Pi(),this.si&&(this.si.cancel(),this.si=null),this.vi(),this.bi(),e.next=7,this.ui.runTransaction("shutdown","readwrite",["owner","clientMetadata"],function(e){var n=new sa(e,Ye.at);return t.mi(n).next(function(){return t.pi(n)})});case 7:this.ui.close(),this.Vi();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Ei",value:function(e,t){var n=this;return e.filter(function(e){return n.Ti(e.updateTimeMs,t)&&!n.Ri(e.clientId)})}},{key:"Si",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return eo(t).W().next(function(t){return e.Ei(t,18e5).map(function(e){return e.clientId})})})}},{key:"started",get:function(){return this.xs}},{key:"getMutationQueue",value:function(e,t){return fu.ue(e,this.Tt,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Ns}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new tu(e,this.Tt.oe.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return Na.ue(this.Tt,e)}},{key:"getBundleCache",value:function(){return this.$s}},{key:"runTransaction",value:function(e,t,n){var r=this;j("IndexedDbPersistence","Starting transaction:",e);var i,a,u="readonly"===t?"readonly":"readwrite",o=15===(i=this.ti)?oa:14===i?ua:13===i?aa:12===i?ia:11===i?ra:void X();return this.ui.runTransaction(e,u,o,function(i){return a=new sa(i,r.Cs?r.Cs.next():Ye.at),"readwrite-primary"===t?r._i(a).next(function(e){return!!e||r.wi(a)}).next(function(t){if(!t)throw z("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Ys.enqueueRetryable(function(){return r.ri(!1)}),new ee($.FAILED_PRECONDITION,Re);return n(a)}).next(function(e){return r.gi(a).next(function(){return e})}):r.Di(a).next(function(){return n(a)})}).then(function(e){return a.raiseOnCommittedEvent(),e})}},{key:"Di",value:function(e){var t=this;return $u(e).get("owner").next(function(e){if(null!==e&&t.Ti(e.leaseTimestampMs,5e3)&&!t.Ri(e.ownerId)&&!t.yi(e)&&!(t.Xs||t.allowTabSynchronization&&e.allowTabSynchronization))throw new ee($.FAILED_PRECONDITION,Ju)})}},{key:"gi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return $u(e).put("owner",t)}},{key:"mi",value:function(e){var t=this,n=$u(e);return n.get("owner").next(function(e){return t.yi(e)?(j("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Pe.resolve()})}},{key:"Ti",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(z("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"hi",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ni=function(){e.Ys.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.ai()})},this.document.addEventListener("visibilitychange",this.ni),this.inForeground="visible"===this.document.visibilityState)}},{key:"vi",value:function(){this.ni&&(this.document.removeEventListener("visibilitychange",this.ni),this.ni=null)}},{key:"li",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ei=function(){t.Pi();var e=/(?:Version|Mobile)\/1[456]/;(0,a.isSafari)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&t.Ys.enterRestrictedMode(!0),t.Ys.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("pagehide",this.ei))}},{key:"bi",value:function(){this.ei&&(this.window.removeEventListener("pagehide",this.ei),this.ei=null)}},{key:"Ri",value:function(e){var t;try{var n=null!==(null===(t=this.ci)||void 0===t?void 0:t.getItem(this.Ai(e)));return j("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return z("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Pi",value:function(){if(this.ci)try{this.ci.setItem(this.Ai(this.clientId),String(Date.now()))}catch(e){z("Failed to set zombie client id.",e)}}},{key:"Vi",value:function(){if(this.ci)try{this.ci.removeItem(this.Ai(this.clientId))}catch(e){}}},{key:"Ai",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return Ue.C()}}]),e}();function $u(e){return ca(e,"owner")}function eo(e){return ca(e,"clientMetadata")}function to(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var no=function(){function e(t,n,r,i){R(this,e),this.targetId=t,this.fromCache=n,this.Ci=r,this.xi=i}return O(e,null,[{key:"Ni",value:function(t,n){var r,i=Br(),a=Br(),u=p(n.docChanges);try{for(u.s();!(r=u.n()).done;){var o=r.value;switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}}}catch(s){u.e(s)}finally{u.f()}return new e(t,n.fromCache,i,a)}}]),e}(),ro=function(){function e(){R(this,e),this.ki=!1}return O(e,[{key:"initialize",value:function(e,t){this.$i=e,this.indexManager=t,this.ki=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Mi(e,t).next(function(a){return a||i.Oi(e,t,r,n)}).next(function(n){return n||i.Fi(e,t)})}},{key:"Mi",value:function(e,t){var n=this;if(Cn(t))return Pe.resolve(null);var r=On(t);return this.indexManager.getIndexType(e,r).next(function(i){return 0===i?null:(null!==t.limit&&1===i&&(t=Pn(t,null,"F"),r=On(t)),n.indexManager.getDocumentsMatchingTarget(e,r).next(function(i){var a=Br.apply(void 0,_(i));return n.$i.getDocuments(e,a).next(function(i){return n.indexManager.getMinOffset(e,r).next(function(r){var u=n.Bi(t,i);return n.Li(t,u,a,r.readTime)?n.Mi(e,Pn(t,null,"F")):n.qi(e,u,t,r)})})}))})}},{key:"Oi",value:function(e,t,n,r){var a=this;return Cn(t)||r.isEqual(me.min())?this.Fi(e,t):this.$i.getDocuments(e,n).next(function(u){var o=a.Bi(t,u);return a.Li(t,o,n,r)?a.Fi(e,t):(G()<=i.LogLevel.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Bn(t)),a.qi(e,o,t,Ne(r,-1)))})}},{key:"Bi",value:function(e,t){var n=new dn(Qn(e));return t.forEach(function(t,r){Kn(e,r)&&(n=n.add(r))}),n}},{key:"Li",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Fi",value:function(e,t){return G()<=i.LogLevel.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Bn(t)),this.$i.getDocumentsMatchingQuery(e,t,Fe.min())}},{key:"qi",value:function(e,t,n,r){return this.$i.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),io=function(){function e(t,n,r,i){R(this,e),this.persistence=t,this.Ui=n,this.Tt=i,this.Ki=new ln(de),this.Gi=new Nr(function(e){return bn(e)},In),this.Qi=new Map,this.ji=t.getRemoteDocumentCache(),this.Ns=t.getTargetCache(),this.$s=t.getBundleCache(),this.zi(r)}return O(e,[{key:"zi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vu(this.ji,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ji.setIndexManager(this.indexManager),this.Ui.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.Ki)})}}]),e}();function ao(e,t,n,r){return new io(e,t,n,r)}function uo(e,t){return oo.apply(this,arguments)}function oo(){return(oo=k(m().mark(function e(t,n){var r;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.zi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],u=[],o=Br(),s=p(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,f=p(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;o=o.add(h.key)}}catch(w){f.e(w)}finally{f.f()}}}catch(w){s.e(w)}finally{s.f()}var d,v=p(n);try{for(v.s();!(d=v.n()).done;){var y=d.value;u.push(y.batchId);var m,g=p(y.mutations);try{for(g.s();!(m=g.n()).done;){var k=m.value;o=o.add(k.key)}}catch(w){g.e(w)}finally{g.f()}}}catch(w){v.e(w)}finally{v.f()}return r.localDocuments.getDocuments(e,o).next(function(e){return{Wi:e,removedBatchIds:a,addedBatchIds:u}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function so(e,t){var n=Z(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r=t.batch.keys(),i=n.ji.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),u=Pe.resolve();return a.forEach(function(e){u=u.next(function(){return r.getEntry(t,e)}).next(function(t){var a=n.docVersions.get(e);Y(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),u.next(function(){return e.mutationQueue.removeMutationBatch(t,i)})}(n,e,t,i).next(function(){return i.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Br(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,r)})})}function co(e){var t=Z(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Ns.getLastRemoteSnapshotVersion(e)})}function lo(e,t){var n=Z(e),r=t.snapshotVersion,i=n.Ki;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.ji.newChangeBuffer({trackRemovals:!0});i=n.Ki;var u=[];t.targetChanges.forEach(function(a,o){var s=i.get(o);if(s){u.push(n.Ns.removeMatchingKeys(e,a.removedDocuments,o).next(function(){return n.Ns.addMatchingKeys(e,a.addedDocuments,o)}));var c=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(o)?c=c.withResumeToken(lt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&u.push(n.Ns.updateTargetData(e,c))}});var o=Fr(),s=Br();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),u.push(fo(e,a,t.documentUpdates).next(function(e){o=e.Hi,s=e.Ji})),!r.isEqual(me.min())){var c=n.Ns.getLastRemoteSnapshotVersion(e).next(function(t){return n.Ns.setTargetsMetadata(e,e.currentSequenceNumber,r)});u.push(c)}return Pe.waitFor(u).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,o,s)}).next(function(){return o})}).then(function(e){return n.Ki=i,e})}function fo(e,t,n){var r=Br(),i=Br();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=Fr();return n.forEach(function(n,a){var u=e.get(n);a.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(me.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!u.isValidDocument()||a.version.compareTo(u.version)>0||0===a.version.compareTo(u.version)&&u.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):j("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",a.version)}),{Hi:r,Ji:i}})}function ho(e,t){var n=Z(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function vo(e,t){var n=Z(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Ns.getTargetData(e,t).next(function(i){return i?(r=i,Pe.resolve(r)):n.Ns.allocateTargetId(e).next(function(i){return r=new da(t,i,0,e.currentSequenceNumber),n.Ns.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.Ki.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ki=n.Ki.insert(e.targetId,e),n.Gi.set(t,e.targetId)),e})}function yo(e,t,n){return po.apply(this,arguments)}function po(){return(po=k(m().mark(function e(t,n,r){var i,a,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Z(t),a=i.Ki.get(n),u=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",u,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Ge(e.t1)){e.next=12;break}throw e.t1;case 12:j("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.Ki=i.Ki.remove(n),i.Gi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function mo(e,t,n){var r=Z(e),i=me.min(),a=Br();return r.persistence.runTransaction("Execute query","readonly",function(e){return function(e,t,n){var r=Z(e),i=r.Gi.get(n);return void 0!==i?Pe.resolve(r.Ki.get(i)):r.Ns.getTargetData(t,n)}(r,e,On(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ns.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Ui.getDocumentsMatchingQuery(e,t,n?i:me.min(),n?a:Br())}).next(function(e){return wo(r,Gn(t),e),{documents:e,Yi:a}})})}function go(e,t){var n=Z(e),r=Z(n.Ns),i=n.Ki.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.ie(e,t).next(function(e){return e?e.target:null})})}function ko(e,t){var n=Z(e),r=n.Qi.get(t)||me.min();return n.persistence.runTransaction("Get new document changes","readonly",function(e){return n.ji.getAllFromCollectionGroup(e,t,Ne(r,-1),Number.MAX_SAFE_INTEGER)}).then(function(e){return wo(n,t,e),e})}function wo(e,t,n){var r=e.Qi.get(t)||me.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Qi.set(t,r)}function xo(e,t,n,r){return bo.apply(this,arguments)}function bo(){return(bo=k(m().mark(function e(t,n,r,i){var a,u,o,s,c,l,f,h,d,v;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=Z(t),u=Br(),o=Fr(),s=p(r);try{for(s.s();!(c=s.n()).done;)l=c.value,f=n.Zi(l.metadata.name),l.document&&(u=u.add(f)),(h=n.Xi(l)).setReadTime(n.tr(l.metadata.readTime)),o=o.insert(f,h)}catch(y){s.e(y)}finally{s.f()}return d=a.ji.newChangeBuffer({trackRemovals:!0}),e.next=7,vo(a,function(e){return On(Nn(ke.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return v=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return fo(e,d,o).next(function(t){return d.apply(e),t}).next(function(t){return a.Ns.removeMatchingKeysForTargetId(e,v.targetId).next(function(){return a.Ns.addMatchingKeys(e,u,v.targetId)}).next(function(){return a.localDocuments.getLocalViewOfDocuments(e,t.Hi,t.Ji)}).next(function(){return t.Hi})})}));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Io(e,t){return To.apply(this,arguments)}function To(){return(To=k(m().mark(function e(t,n){var r,i,a,u=arguments;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:Br(),e.next=3,vo(t,On(Ia(n.bundledQuery)));case 3:return i=e.sent,a=Z(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",function(e){var t=ui(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.$s.saveNamedQuery(e,n);var u=i.withResumeToken(lt.EMPTY_BYTE_STRING,t);return a.Ki=a.Ki.insert(u.targetId,u),a.Ns.updateTargetData(e,u).next(function(){return a.Ns.removeMatchingKeysForTargetId(e,i.targetId)}).next(function(){return a.Ns.addMatchingKeys(e,r,i.targetId)}).next(function(){return a.$s.saveNamedQuery(e,n)})}));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Eo(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function So(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function _o(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var Ao=function(){function e(t,n,r,i){R(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return O(e,[{key:"nr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"er",value:function(t,n,r){var i,a=JSON.parse(r),u="object"==L(a)&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==L(a.error));return u&&a.error&&((u="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new ee(a.error.code,a.error.message))),u?new e(t,n,a.state,i):(z("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),Do=function(){function e(t,n,r){R(this,e),this.targetId=t,this.state=n,this.error=r}return O(e,[{key:"nr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"er",value:function(t,n){var r,i=JSON.parse(n),a="object"==L(i)&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==L(i.error));return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ee(i.error.code,i.error.message))),a?new e(t,i.state,r):(z("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),No=function(){function e(t,n){R(this,e),this.clientId=t,this.activeTargetIds=n}return O(e,null,[{key:"er",value:function(t,n){for(var r=JSON.parse(n),i="object"==L(r)&&r.activeTargetIds instanceof Array,a=Gr(),u=0;i&&u<r.activeTargetIds.length;++u)i=ot(r.activeTargetIds[u]),a=a.add(r.activeTargetIds[u]);return i?new e(t,a):(z("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),Co=function(){function e(t,n){R(this,e),this.clientId=t,this.onlineState=n}return O(e,null,[{key:"er",value:function(t){var n=JSON.parse(t);return"object"==L(n)&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(z("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),Fo=function(){function e(){R(this,e),this.activeTargetIds=Gr()}return O(e,[{key:"sr",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"ir",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"nr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),Lo=function(){function e(t,n,r,i,a){R(this,e),this.window=t,this.Ys=n,this.persistenceKey=r,this.rr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ur=this.cr.bind(this),this.ar=new ln(de),this.started=!1,this.hr=[];var u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.lr=Eo(this.persistenceKey,this.rr),this.dr=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.ar=this.ar.insert(this.rr,new Fo),this._r=new RegExp("^firestore_clients_".concat(u,"_([^_]*)$")),this.wr=new RegExp("^firestore_mutations_".concat(u,"_(\\d+)(?:_(.*))?$")),this.mr=new RegExp("^firestore_targets_".concat(u,"_(\\d+)$")),this.gr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.yr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ur)}return O(e,[{key:"start",value:function(){var e=k(m().mark(function e(){var t,n,r,i,a,u,o,s,c,l,f,h=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.Si();case 2:t=e.sent,n=p(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.rr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(Eo(this.persistenceKey,i)))&&(u=No.er(i,a))&&(this.ar=this.ar.insert(u.clientId,u));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.pr(),(o=this.storage.getItem(this.gr))&&(s=this.Ir(o))&&this.Tr(s),c=p(this.hr);try{for(c.s();!(l=c.n()).done;)f=l.value,this.cr(f)}catch(d){c.e(d)}finally{c.f()}this.hr=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0;case 28:case"end":return e.stop()}},e,this,[[4,16,19,22]])}));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.dr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Er(this.ar)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ar.forEach(function(n,r){r.activeTargetIds.has(e)&&(t=!0)}),t}},{key:"addPendingMutation",value:function(e){this.Ar(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Ar(e,t,n),this.Rr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(_o(this.persistenceKey,e));if(n){var r=Do.er(e,n);r&&(t=r.state)}}return this.Pr.sr(e),this.pr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Pr.ir(e),this.pr()}},{key:"isLocalQueryTarget",value:function(e){return this.Pr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(_o(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.vr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach(function(e){r.Rr(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Vr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ur),this.removeItem(this.lr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return j("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){j("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){j("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"cr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(j("SharedClientState","EVENT",n.key,n.newValue),n.key===this.lr)return void z("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ys.enqueueRetryable(k(m().mark(function e(){var r,i,a,u,o,s,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t._r.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Sr(n.key),e.abrupt("return",t.Dr(r,null));case 6:if(!(i=t.Cr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.Dr(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.wr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Nr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.kr(a));case 16:e.next=41;break;case 18:if(!t.mr.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(u=t.$r(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Mr(u));case 23:e.next=41;break;case 25:if(n.key!==t.gr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(o=t.Ir(n.newValue))){e.next=30;break}return e.abrupt("return",t.Tr(o));case 30:e.next=41;break;case 32:if(n.key!==t.dr){e.next=37;break}(s=function(e){var t=Ye.at;if(null!=e)try{var n=JSON.parse(e);Y("number"==typeof n),t=n}catch(e){z("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==Ye.at&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.yr){e.next=41;break}return c=t.Or(n.newValue),e.next=41,Promise.all(c.map(function(e){return t.syncEngine.Fr(e)}));case 41:e.next=44;break;case 43:t.hr.push(n);case 44:case"end":return e.stop()}},e)})))}}},{key:"Pr",get:function(){return this.ar.get(this.rr)}},{key:"pr",value:function(){this.setItem(this.lr,this.Pr.nr())}},{key:"Ar",value:function(e,t,n){var r=new Ao(this.currentUser,e,t,n),i=So(this.persistenceKey,this.currentUser,e);this.setItem(i,r.nr())}},{key:"Rr",value:function(e){var t=So(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.rr,onlineState:e};this.storage.setItem(this.gr,JSON.stringify(t))}},{key:"vr",value:function(e,t,n){var r=_o(this.persistenceKey,e),i=new Do(e,t,n);this.setItem(r,i.nr())}},{key:"Vr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.yr,t)}},{key:"Sr",value:function(e){var t=this._r.exec(e);return t?t[1]:null}},{key:"Cr",value:function(e,t){var n=this.Sr(e);return No.er(n,t)}},{key:"Nr",value:function(e,t){var n=this.wr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ao.er(new U(i),r,t)}},{key:"$r",value:function(e,t){var n=this.mr.exec(e),r=Number(n[1]);return Do.er(r,t)}},{key:"Ir",value:function(e){return Co.er(e)}},{key:"Or",value:function(e){return JSON.parse(e)}},{key:"kr",value:function(){var e=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.Br(t.batchId,t.state,t.error));case 2:j("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Mr",value:function(e){return this.syncEngine.Lr(e.targetId,e.state,e.error)}},{key:"Dr",value:function(e,t){var n=this,r=t?this.ar.insert(e,t):this.ar.remove(e),i=this.Er(this.ar),a=this.Er(r),u=[],o=[];return a.forEach(function(e){i.has(e)||u.push(e)}),i.forEach(function(e){a.has(e)||o.push(e)}),this.syncEngine.qr(u,o).then(function(){n.ar=r})}},{key:"Tr",value:function(e){this.ar.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Er",value:function(e){var t=Gr();return e.forEach(function(e,n){t=t.unionWith(n.activeTargetIds)}),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),e}(),Ro=function(){function e(){R(this,e),this.Ur=new Fo,this.Kr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return O(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Ur.sr(e),this.Kr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Kr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Ur.ir(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Ur.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Kr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Ur.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Ur.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Ur=new Fo,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),Mo=function(){function e(){R(this,e)}return O(e,[{key:"Gr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),Oo=function(){function e(){var t=this;R(this,e),this.Qr=function(){return t.jr()},this.zr=function(){return t.Wr()},this.Hr=[],this.Jr()}return O(e,[{key:"Gr",value:function(e){this.Hr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Qr),window.removeEventListener("offline",this.zr)}},{key:"Jr",value:function(){window.addEventListener("online",this.Qr),window.addEventListener("offline",this.zr)}},{key:"jr",value:function(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=p(this.Hr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Wr",value:function(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=p(this.Hr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),Vo=null;function Po(){return null===Vo?Vo=268435456+Math.round(2147483648*Math.random()):Vo++,"0x"+Vo.toString(16)}var qo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Uo=function(){function e(t){R(this,e),this.Yr=t.Yr,this.Zr=t.Zr}return O(e,[{key:"Xr",value:function(e){this.eo=e}},{key:"no",value:function(e){this.so=e}},{key:"onMessage",value:function(e){this.io=e}},{key:"close",value:function(){this.Zr()}},{key:"send",value:function(e){this.Yr(e)}},{key:"ro",value:function(){this.eo()}},{key:"oo",value:function(e){this.so(e)}},{key:"uo",value:function(e){this.io(e)}}]),e}(),Bo="WebChannelConnection",Ko=function(e){w(n,function(){function e(t){R(this,e);this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.co=n+"://"+t.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}O(e,[{key:"ho",get:function e(){return!1}},{key:"lo",value:function e(t,n,r,i,a){var u=Po(),o=this.fo(t,n);j("RestConnection","Sending RPC '".concat(t,"' ").concat(u,":"),o,r);var s={};return this._o(s,i,a),this.wo(t,o,s,r).then(function(e){return j("RestConnection","Received RPC '".concat(t,"' ").concat(u,": "),e),e},function(e){throw W("RestConnection","RPC '".concat(t,"' ").concat(u," failed with error: "),e,"url: ",o,"request:",r),e})}},{key:"mo",value:function e(t,n,r,i,a,u){return this.lo(t,n,r,i,a)}},{key:"_o",value:function e(t,n,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+B,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(function(e,n){return t[n]=e}),r&&r.headers.forEach(function(e,n){return t[n]=e})}},{key:"fo",value:function e(t,n){var r=qo[t];return"".concat(this.co,"/v1/").concat(n,":").concat(r)}}]);return e}());var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return O(n,[{key:"wo",value:function(e,t,n,r){var i=Po();return new Promise(function(a,o){var s=new u.XhrIo;s.setWithCredentials(!0),s.listenOnce(u.EventType.COMPLETE,function(){try{switch(s.getLastErrorCode()){case u.ErrorCode.NO_ERROR:var t=s.getResponseJson();j(Bo,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case u.ErrorCode.TIMEOUT:j(Bo,"RPC '".concat(e,"' ").concat(i," timed out")),o(new ee($.DEADLINE_EXCEEDED,"Request time out"));break;case u.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(j(Bo,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson();Array.isArray(r)&&(r=r[0]);var c=null==r?void 0:r.error;if(c&&c.status&&c.message){var l=(f=c.status.toLowerCase().replace(/_/g,"-"),Object.values($).indexOf(f)>=0?f:$.UNKNOWN);o(new ee(l,c.message))}else o(new ee($.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ee($.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{j(Bo,"RPC '".concat(e,"' ").concat(i," completed."))}var f});var c=JSON.stringify(r);j(Bo,"RPC '".concat(e,"' ").concat(i," sending request:"),r),s.send(t,"POST",c,n,15)})}},{key:"yo",value:function(e,t,n){var r=Po(),i=[this.co,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=(0,u.createWebChannelTransport)(),o=(0,u.getStatEventTarget)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new u.FetchXmlHttpFactory({})),this._o(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;var c=i.join("");j(Bo,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),s);var l=a.createWebChannel(c,s),f=!1,h=!1,d=new Uo({Yr:function(t){h?j(Bo,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(f||(j(Bo,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),l.open(),f=!0),j(Bo,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),l.send(t))},Zr:function(){return l.close()}}),v=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return v(l,u.WebChannel.EventType.OPEN,function(){h||j(Bo,"RPC '".concat(e,"' stream ").concat(r," transport opened."))}),v(l,u.WebChannel.EventType.CLOSE,function(){h||(h=!0,j(Bo,"RPC '".concat(e,"' stream ").concat(r," transport closed")),d.oo())}),v(l,u.WebChannel.EventType.ERROR,function(t){h||(h=!0,W(Bo,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),d.oo(new ee($.UNAVAILABLE,"The operation could not be completed")))}),v(l,u.WebChannel.EventType.MESSAGE,function(t){var n;if(!h){var i=t.data[0];Y(!!i);var a=i,u=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(u){j(Bo,"RPC '".concat(e,"' stream ").concat(r," received error:"),u);var o=u.status,s=function(e){var t=Ir[o];if(void 0!==t)return Dr(t)}(),c=u.message;void 0===s&&(s=$.INTERNAL,c="Unknown error status: "+o+" with message "+u.message),h=!0,d.oo(new ee(s,c)),l.close()}else j(Bo,"RPC '".concat(e,"' stream ").concat(r," received:"),i),d.uo(i)}}),v(o,u.Event.STAT_EVENT,function(t){t.stat===u.Stat.PROXY?j(Bo,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===u.Stat.NOPROXY&&j(Bo,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(function(){d.ro()},0),d}}]),n}();function Go(){return"undefined"!=typeof window?window:null}function Qo(){return"undefined"!=typeof document?document:null}function jo(e){return new ni(e,!0)}var zo=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;R(this,e),this.Ys=t,this.timerId=n,this.po=r,this.Io=i,this.To=a,this.Eo=0,this.Ao=null,this.Ro=Date.now(),this.reset()}return O(e,[{key:"reset",value:function(){this.Eo=0}},{key:"Po",value:function(){this.Eo=this.To}},{key:"vo",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Eo+this.bo()),r=Math.max(0,Date.now()-this.Ro),i=Math.max(0,n-r);i>0&&j("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Eo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Ao=this.Ys.enqueueAfterDelay(this.timerId,i,function(){return t.Ro=Date.now(),e()}),this.Eo*=this.Io,this.Eo<this.po&&(this.Eo=this.po),this.Eo>this.To&&(this.Eo=this.To)}},{key:"Vo",value:function(){null!==this.Ao&&(this.Ao.skipDelay(),this.Ao=null)}},{key:"cancel",value:function(){null!==this.Ao&&(this.Ao.cancel(),this.Ao=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Eo}}]),e}(),Wo=function(){function e(t,n,r,i,a,u,o,s){R(this,e),this.Ys=t,this.So=r,this.Do=i,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.Co=0,this.xo=null,this.No=null,this.stream=null,this.ko=new zo(t,n)}return O(e,[{key:"$o",value:function(){return 1===this.state||5===this.state||this.Mo()}},{key:"Mo",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.$o(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Fo",value:function(){this.state=0,this.ko.reset()}},{key:"Bo",value:function(){var e=this;this.Mo()&&null===this.xo&&(this.xo=this.Ys.enqueueAfterDelay(this.So,6e4,function(){return e.Lo()}))}},{key:"qo",value:function(e){this.Uo(),this.stream.send(e)}},{key:"Lo",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Mo()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Uo",value:function(){this.xo&&(this.xo.cancel(),this.xo=null)}},{key:"Ko",value:function(){this.No&&(this.No.cancel(),this.No=null)}},{key:"close",value:function(){var e=k(m().mark(function e(t,n){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.Uo(),this.Ko(),this.ko.cancel(),this.Co++,4!==t?this.ko.reset():n&&n.code===$.RESOURCE_EXHAUSTED?(z(n.toString()),z("Using maximum backoff delay to prevent overloading the backend."),this.ko.Po()):n&&n.code===$.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Go(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.no(n);case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"Go",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Qo(this.Co),n=this.Co;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=c(t,2),i=r[0],a=r[1];e.Co===n&&e.jo(i,a)},function(n){t(function(){var t=new ee($.UNKNOWN,"Fetching auth token failed: "+n.message);return e.zo(t)})})}},{key:"jo",value:function(e,t){var n=this,r=this.Qo(this.Co);this.stream=this.Wo(e,t),this.stream.Xr(function(){r(function(){return n.state=2,n.No=n.Ys.enqueueAfterDelay(n.Do,1e4,function(){return n.Mo()&&(n.state=3),Promise.resolve()}),n.listener.Xr()})}),this.stream.no(function(e){r(function(){return n.zo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"Oo",value:function(){var e=this;this.state=5,this.ko.vo(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"zo",value:function(e){return j("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Qo",value:function(e){var t=this;return function(n){t.Ys.enqueueAndForget(function(){return t.Co===e?n():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),Ho=function(e){w(n,Wo);var t=b(n);function n(e,r,i,a,u,o){var s;return R(this,n),(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,o)).Tt=u,s}return O(n,[{key:"Wo",value:function(e,t){return this.connection.yo("Listen",e,t)}},{key:"onMessage",value:function(e){this.ko.reset();var t=gi(this.Tt,e),n=function(e){if(!("targetChange"in e))return me.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?me.min():t.readTime?ui(t.readTime):me.min()}(e);return this.listener.Ho(t,n)}},{key:"Jo",value:function(e){var t={};t.database=di(this.Tt),t.addTarget=function(e,t){var n,r=t.target;return(n=Tn(r)?{documents:bi(e,r)}:{query:Ii(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=ii(e,t.resumeToken):t.snapshotVersion.compareTo(me.min())>0&&(n.readTime=ri(e,t.snapshotVersion.toTimestamp())),n}(this.Tt,e);var n=Ei(this.Tt,e);n&&(t.labels=n),this.qo(t)}},{key:"Yo",value:function(e){var t={};t.database=di(this.Tt),t.removeTarget=e,this.qo(t)}}]),n}(),Xo=function(e){w(n,Wo);var t=b(n);function n(e,r,i,a,u,o){var s;return R(this,n),(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,o)).Tt=u,s.Zo=!1,s}return O(n,[{key:"Xo",get:function(){return this.Zo}},{key:"start",value:function(){this.Zo=!1,this.lastStreamToken=void 0,o(S(n.prototype),"start",this).call(this)}},{key:"Go",value:function(){this.Zo&&this.tu([])}},{key:"Wo",value:function(e,t){return this.connection.yo("Write",e,t)}},{key:"onMessage",value:function(e){if(Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Zo){this.ko.reset();var t=xi(e.writeResults,e.commitTime),n=ui(e.commitTime);return this.listener.eu(n,t)}return Y(!e.writeResults||0===e.writeResults.length),this.Zo=!0,this.listener.nu()}},{key:"su",value:function(){var e={};e.database=di(this.Tt),this.qo(e)}},{key:"tu",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return ki(t.Tt,e)})};this.qo(n)}}]),n}(),Yo=function(e){w(n,function(){function e(){R(this,e)}return O(e)}());var t=b(n);function n(e,r,i,a){var u;return R(this,n),(u=t.call(this)).authCredentials=e,u.appCheckCredentials=r,u.connection=i,u.Tt=a,u.iu=!1,u}return O(n,[{key:"ru",value:function(){if(this.iu)throw new ee($.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"lo",value:function(e,t,n){var r=this;return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=c(i,2),u=a[0],o=a[1];return r.connection.lo(e,t,n,u,o)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===$.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new ee($.UNKNOWN,e.toString())})}},{key:"mo",value:function(e,t,n,r){var i=this;return this.ru(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var u=c(a,2),o=u[0],s=u[1];return i.connection.mo(e,t,n,o,s,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===$.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new ee($.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.iu=!0}}]),n}();function Jo(e,t,n){return Zo.apply(this,arguments)}function Zo(){return(Zo=k(m().mark(function e(t,n,r){var i,a,u,o,s,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Z(t),a=function(e,t,n){var r=Ii(e,t),i=[];return n.forEach(function(e){"count"===e.lt?i.push({alias:e.alias.canonicalString(),count:{}}):"avg"===e.lt?i.push({alias:e.alias.canonicalString(),avg:{field:Ni(e.fieldPath)}}):"sum"===e.lt&&i.push({alias:e.alias.canonicalString(),sum:{field:Ni(e.fieldPath)}})}),{structuredAggregationQuery:{aggregations:i,structuredQuery:r.structuredQuery},parent:r.parent}}(i.Tt,On(n),r),u=a.parent,i.connection.ho||delete a.parent,e.next=4,i.mo("RunAggregationQuery",u,a,1);case 4:return o=e.sent.filter(function(e){return!!e.result}),e.abrupt("return",(Y(1===o.length),(s=o[0]).result,s.result.aggregateFields,new mn({mapValue:{fields:null===(c=s.result)||void 0===c?void 0:c.aggregateFields}})));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $o=function(){function e(t,n){R(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.ou=0,this.uu=null,this.cu=!0}return O(e,[{key:"au",value:function(){var e=this;0===this.ou&&(this.hu("Unknown"),this.uu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.uu=null,e.lu("Backend didn't respond within 10 seconds."),e.hu("Offline"),Promise.resolve()}))}},{key:"fu",value:function(e){"Online"===this.state?this.hu("Unknown"):(this.ou++,this.ou>=1&&(this.du(),this.lu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.hu("Offline")))}},{key:"set",value:function(e){this.du(),this.ou=0,"Online"===e&&(this.cu=!1),this.hu(e)}},{key:"hu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"lu",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.cu?(z(t),this.cu=!1):j("OnlineStateTracker",t)}},{key:"du",value:function(){null!==this.uu&&(this.uu.cancel(),this.uu=null)}}]),e}(),es=O(function e(t,n,r,i,a){var u=this;R(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this._u=[],this.wu=new Map,this.mu=new Set,this.gu=[],this.yu=a,this.yu.Gr(function(e){r.enqueueAndForget(k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=fs(u),!e.t0){e.next=5;break}return j("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=k(m().mark(function e(t){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Z(t)).mu.add(4),e.next=4,rs(n);case 4:return n.pu.set("Unknown"),n.mu.delete(4),e.next=8,ts(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(u);case 5:case"end":return e.stop()}},e)})))}),this.pu=new $o(r,i)});function ts(e){return ns.apply(this,arguments)}function ns(){return(ns=k(m().mark(function e(t){var n,r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!fs(t)){e.next=18;break}n=p(t.gu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function rs(e){return is.apply(this,arguments)}function is(){return(is=k(m().mark(function e(t){var n,r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=p(t.gu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function as(e,t){var n=Z(e);n.wu.has(t.targetId)||(n.wu.set(t.targetId,t),ls(n)?cs(n):Us(n).Mo()&&os(n,t))}function us(e,t){var n=Z(e),r=Us(n);n.wu.delete(t),r.Mo()&&ss(n,t),0===n.wu.size&&(r.Mo()?r.Bo():fs(n)&&n.pu.set("Unknown"))}function os(e,t){e.Iu.Ot(t.targetId),Us(e).Jo(t)}function ss(e,t){e.Iu.Ot(t),Us(e).Yo(t)}function cs(e){e.Iu=new Yr({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},ie:function(t){return e.wu.get(t)||null}}),Us(e).start(),e.pu.au()}function ls(e){return fs(e)&&!Us(e).$o()&&e.wu.size>0}function fs(e){return 0===Z(e).mu.size}function hs(e){e.Iu=void 0}function ds(e){return vs.apply(this,arguments)}function vs(){return(vs=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.wu.forEach(function(e,n){os(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ys(e,t){return ps.apply(this,arguments)}function ps(){return(ps=k(m().mark(function e(t,n){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:hs(t),ls(t)?(t.pu.fu(n),cs(t)):t.pu.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ms(e,t,n){return gs.apply(this,arguments)}function gs(){return(gs=k(m().mark(function e(t,n,r){var i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.pu.set("Online"),!(n instanceof Hr&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=k(m().mark(function e(t,n){var r,i,a,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=p(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(u=a.value,e.t0=t.wu.has(u),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(u,r);case 10:t.wu.delete(u),t.Iu.removeTarget(u);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),j("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,ks(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof zr?t.Iu.Qt(n):n instanceof Wr?t.Iu.Zt(n):t.Iu.Wt(n),r.isEqual(me.min())){e.next=29;break}return e.prev=14,e.next=17,co(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Iu.ee(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.wu.get(r);i&&e.wu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.wu.get(t);if(n){e.wu.set(t,n.withResumeToken(lt.EMPTY_BYTE_STRING,n.snapshotVersion)),ss(e,t);var r=new da(n.target,t,1,n.sequenceNumber);os(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),j("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,ks(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function ks(e,t,n){return ws.apply(this,arguments)}function ws(){return(ws=k(m().mark(function e(t,n,r){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ge(n)){e.next=2;break}throw n;case 2:return t.mu.add(1),e.next=5,rs(t);case 5:t.pu.set("Offline"),r||(r=function(){return co(t.localStore)}),t.asyncQueue.enqueueRetryable(k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.mu.delete(1),e.next=6,ts(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xs(e,t){return t().catch(function(n){return ks(e,n,t)})}function bs(e){return Is.apply(this,arguments)}function Is(){return(Is=k(m().mark(function e(t){var n,r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Z(t),r=Bs(n),i=n._u.length>0?n._u[n._u.length-1].batchId:-1;case 2:if(!Ts(n)){e.next=19;break}return e.prev=3,e.next=6,ho(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n._u.length&&r.Bo(),e.abrupt("break",19);case 10:i=a.batchId,Es(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,ks(n,e.t0);case 17:e.next=2;break;case 19:Ss(n)&&_s(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function Ts(e){return fs(e)&&e._u.length<10}function Es(e,t){e._u.push(t);var n=Bs(e);n.Mo()&&n.Xo&&n.tu(t.mutations)}function Ss(e){return fs(e)&&!Bs(e).$o()&&e._u.length>0}function _s(e){Bs(e).start()}function As(e){return Ds.apply(this,arguments)}function Ds(){return(Ds=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Bs(t).su();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ns(e){return Cs.apply(this,arguments)}function Cs(){return(Cs=k(m().mark(function e(t){var n,r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Bs(t),r=p(t._u);try{for(r.s();!(i=r.n()).done;)a=i.value,n.tu(a.mutations)}catch(u){r.e(u)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fs(e,t,n){return Ls.apply(this,arguments)}function Ls(){return(Ls=k(m().mark(function e(t,n,r){var i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t._u.shift(),a=fa.from(i,n,r),e.next=3,xs(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,bs(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rs(e,t){return Ms.apply(this,arguments)}function Ms(){return(Ms=k(m().mark(function e(t,n){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&Bs(t).Xo,!e.t0){e.next=4;break}return e.next=4,function(){var e=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ar(i=n.code)||i===$.ABORTED){e.next=7;break}return r=t._u.shift(),Bs(t).Fo(),e.next=5,xs(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,bs(t);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Ss(t)&&_s(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Os(e,t){return Vs.apply(this,arguments)}function Vs(){return(Vs=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Z(t)).asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials"),i=fs(r),r.mu.add(3),e.next=6,rs(r);case 6:return i&&r.pu.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.mu.delete(3),e.next=12,ts(r);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ps(e,t){return qs.apply(this,arguments)}function qs(){return(qs=k(m().mark(function e(t,n){var r;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Z(t),!n){e.next=7;break}return r.mu.delete(2),e.next=5,ts(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.mu.add(2),e.next=12,rs(r);case 12:r.pu.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Us(e){return e.Tu||(e.Tu=function(e,t,n){var r=Z(e);return r.ru(),new Ho(t,r.connection,r.authCredentials,r.appCheckCredentials,r.Tt,n)}(e.datastore,e.asyncQueue,{Xr:ds.bind(null,e),no:ys.bind(null,e),Ho:ms.bind(null,e)}),e.gu.push(function(){var t=k(m().mark(function t(n){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Tu.Fo(),ls(e)?cs(e):e.pu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Tu.stop();case 6:hs(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Tu}function Bs(e){return e.Eu||(e.Eu=function(e,t,n){var r=Z(e);return r.ru(),new Xo(t,r.connection,r.authCredentials,r.appCheckCredentials,r.Tt,n)}(e.datastore,e.asyncQueue,{Xr:As.bind(null,e),no:Rs.bind(null,e),nu:Ns.bind(null,e),eu:Fs.bind(null,e)}),e.gu.push(function(){var t=k(m().mark(function t(n){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Eu.Fo(),t.next=4,bs(e);case 4:t.next=9;break;case 6:return t.next=8,e.Eu.stop();case 8:e._u.length>0&&(j("RemoteStore","Stopping write stream with ".concat(e._u.length," pending writes")),e._u=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Eu}var Ks=function(){function e(t,n,r,i,a){R(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new te,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return O(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ee($.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var u=new e(t,n,Date.now()+r,i,a);return u.start(r),u}}]),e}();function Gs(e,t){if(z("AsyncQueue","".concat(t,": ").concat(e)),Ge(e))return new ee($.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var Qs=function(){function e(t){R(this,e),this.comparator=t?function(e,n){return t(e,n)||be.comparator(e.key,n.key)}:function(e,t){return be.comparator(e.key,t.key)},this.keyedMap=Rr(),this.sortedSet=new ln(this.comparator)}return O(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),js=function(){function e(){R(this,e),this.Au=new ln(be.comparator)}return O(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Au.get(t);n?0!==e.type&&3===n.type?this.Au=this.Au.insert(t,e):3===e.type&&1!==n.type?this.Au=this.Au.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Au=this.Au.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Au=this.Au.remove(t):1===e.type&&2===n.type?this.Au=this.Au.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Au=this.Au.insert(t,{type:2,doc:e.doc}):X():this.Au=this.Au.insert(t,e)}},{key:"Ru",value:function(){var e=[];return this.Au.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),zs=function(){function e(t,n,r,i,a,u,o,s,c){R(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}return O(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i,a){var u=[];return n.forEach(function(e){u.push({type:0,doc:e})}),new e(t,n,Qs.emptySet(n),u,r,i,!0,!1,a)}}]),e}(),Ws=O(function e(){R(this,e),this.Pu=void 0,this.listeners=[]}),Hs=O(function e(){R(this,e),this.queries=new Nr(function(e){return Un(e)},qn),this.onlineState="Unknown",this.vu=new Set});function Xs(e,t){return Ys.apply(this,arguments)}function Ys(){return(Ys=k(m().mark(function e(t,n){var r,i,a,u,o;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Z(t),i=n.query,a=!1,(u=r.queries.get(i))||(a=!0,u=new Ws),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:u.Pu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),o=Gs(e.t0,"Initialization of query '".concat(Bn(n.query),"' failed")),e.abrupt("return",void n.onError(o));case 13:r.queries.set(i,u),u.listeners.push(n),n.bu(r.onlineState),u.Pu&&n.Vu(u.Pu)&&tc(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function Js(e,t){return Zs.apply(this,arguments)}function Zs(){return(Zs=k(m().mark(function e(t,n){var r,i,a,u,o;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Z(t),i=n.query,a=!1,(u=r.queries.get(i))&&(o=u.listeners.indexOf(n))>=0&&(u.listeners.splice(o,1),a=0===u.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $s(e,t){var n,r=Z(e),i=!1,a=p(t);try{for(a.s();!(n=a.n()).done;){var u=n.value,o=u.query,s=r.queries.get(o);if(s){var c,l=p(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Vu(u)&&(i=!0)}}catch(f){l.e(f)}finally{l.f()}s.Pu=u}}}catch(f){a.e(f)}finally{a.f()}i&&tc(r)}function ec(e,t,n){var r=Z(e),i=r.queries.get(t);if(i){var a,u=p(i.listeners);try{for(u.s();!(a=u.n()).done;){a.value.onError(n)}}catch(o){u.e(o)}finally{u.f()}}r.queries.delete(t)}function tc(e){e.vu.forEach(function(e){e.next()})}var nc=function(){function e(t,n,r){R(this,e),this.query=t,this.Su=n,this.Du=!1,this.Cu=null,this.onlineState="Unknown",this.options=r||{}}return O(e,[{key:"Vu",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=p(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(u){r.e(u)}finally{r.f()}e=new zs(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}var a=!1;return this.Du?this.xu(e)&&(this.Su.next(e),a=!0):this.Nu(e,this.onlineState)&&(this.ku(e),a=!0),this.Cu=e,a}},{key:"onError",value:function(e){this.Su.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Cu&&!this.Du&&this.Nu(this.Cu,e)&&(this.ku(this.Cu),t=!0),t}},{key:"Nu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.$u||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}},{key:"xu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Cu&&this.Cu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"ku",value:function(e){e=zs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Du=!0,this.Su.next(e)}}]),e}(),rc=function(){function e(t,n){R(this,e),this.Mu=t,this.byteLength=n}return O(e,[{key:"Ou",value:function(){return"metadata"in this.Mu}}]),e}(),ic=function(){function e(t){R(this,e),this.Tt=t}return O(e,[{key:"Zi",value:function(e){return li(this.Tt,e)}},{key:"Xi",value:function(e){return e.metadata.exists?pi(this.Tt,e.document,!1):kn.newNoDocument(this.Zi(e.metadata.name),this.tr(e.metadata.readTime))}},{key:"tr",value:function(e){return ui(e)}}]),e}(),ac=function(){function e(t,n,r){R(this,e),this.Fu=t,this.localStore=n,this.Tt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=uc(t)}return O(e,[{key:"Bu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.Mu.namedQuery)this.queries.push(e.Mu.namedQuery);else if(e.Mu.documentMetadata){this.documents.push({metadata:e.Mu.documentMetadata}),e.Mu.documentMetadata.exists||++t;var n=ke.fromString(e.Mu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Mu.document&&(this.documents[this.documents.length-1].document=e.Mu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"Lu",value:function(e){var t,n=new Map,r=new ic(this.Tt),i=p(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var u,o=r.Zi(a.metadata.name),s=p(a.metadata.queries);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=(n.get(c)||Br()).add(o);n.set(c,l)}}catch(f){s.e(f)}finally{s.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=k(m().mark(function e(){var t,n,r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xo(this.localStore,new ic(this.Tt),this.documents,this.Fu.id);case 2:t=e.sent,n=this.Lu(this.documents),r=p(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,Io(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,qu:this.collectionGroups,Uu:t}));case 22:case"end":return e.stop()}},e,this,[[5,15,18,21]])}));return function(){return e.apply(this,arguments)}}()}]),e}();function uc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var oc=O(function e(t){R(this,e),this.key=t}),sc=O(function e(t){R(this,e),this.key=t}),cc=function(){function e(t,n){R(this,e),this.query=t,this.Ku=n,this.Gu=null,this.hasCachedResults=!1,this.current=!1,this.Qu=Br(),this.mutatedKeys=Br(),this.ju=Qn(t),this.zu=new Qs(this.ju)}return O(e,[{key:"Wu",get:function(){return this.Ku}},{key:"Hu",value:function(e,t){var n=this,r=t?t.Ju:new js,i=t?t.zu:this.zu,a=t?t.mutatedKeys:this.mutatedKeys,u=i,o=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=Kn(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Yu(l,f)||(r.track({type:2,doc:f}),v=!0,(s&&n.ju(f,s)>0||c&&n.ju(f,c)<0)&&(o=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(o=!0)),v&&(f?(u=u.add(f),a=d?a.add(e):a.delete(e)):(u=u.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;u.size>this.query.limit;){var l="F"===this.query.limitType?u.last():u.first();u=u.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{zu:u,Ju:r,Li:o,mutatedKeys:a}}},{key:"Yu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.zu;this.zu=e.zu,this.mutatedKeys=e.mutatedKeys;var a=e.Ju.Ru();a.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return n(e)-n(t)}(e.type,t.type)||r.ju(e.doc,t.doc)}),this.Zu(n);var u=t?this.Xu():[],o=0===this.Qu.size&&this.current?1:0,s=o!==this.Gu;return this.Gu=o,0!==a.length||s?{snapshot:new zs(this.query,e.zu,i,a,e.mutatedKeys,0===o,s,!1,!!n&&n.resumeToken.approximateByteSize()>0),tc:u}:{tc:u}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({zu:this.zu,Ju:new js,mutatedKeys:this.mutatedKeys,Li:!1},!1)):{tc:[]}}},{key:"ec",value:function(e){return!this.Ku.has(e)&&!!this.zu.has(e)&&!this.zu.get(e).hasLocalMutations}},{key:"Zu",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Ku=t.Ku.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Ku=t.Ku.delete(e)}),this.current=e.current)}},{key:"Xu",value:function(){var e=this;if(!this.current)return[];var t=this.Qu;this.Qu=Br(),this.zu.forEach(function(t){e.ec(t.key)&&(e.Qu=e.Qu.add(t.key))});var n=[];return t.forEach(function(t){e.Qu.has(t)||n.push(new sc(t))}),this.Qu.forEach(function(e){t.has(e)||n.push(new oc(e))}),n}},{key:"nc",value:function(e){this.Ku=e.Yi,this.Qu=Br();var t=this.Hu(e.documents);return this.applyChanges(t,!0)}},{key:"sc",value:function(){return zs.fromInitialDocuments(this.query,this.zu,this.mutatedKeys,0===this.Gu,this.hasCachedResults)}}]),e}(),lc=O(function e(t,n,r){R(this,e),this.query=t,this.targetId=n,this.view=r}),fc=O(function e(t){R(this,e),this.key=t,this.ic=!1}),hc=function(){function e(t,n,r,i,a,u){R(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.rc={},this.oc=new Nr(function(e){return Un(e)},qn),this.uc=new Map,this.cc=new Set,this.ac=new ln(be.comparator),this.hc=new Map,this.lc=new Uu,this.fc={},this.dc=new Map,this._c=pu.Sn(),this.onlineState="Unknown",this.wc=void 0}return O(e,[{key:"isPrimaryClient",get:function(){return!0===this.wc}}]),e}();function dc(e,t){return vc.apply(this,arguments)}function vc(){return(vc=k(m().mark(function e(t,n){var r,i,a,u,o,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ul(t),!(u=r.oc.get(n))){e.next=6;break}i=u.targetId,r.sharedClientState.addLocalQueryTarget(i),a=u.view.sc(),e.next=15;break;case 6:return e.next=8,vo(r.localStore,On(n));case 8:return o=e.sent,r.isPrimaryClient&&as(r.remoteStore,o),s=r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.targetId,e.next=14,yc(r,n,i,"current"===s,o.resumeToken);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function yc(e,t,n,r,i){return pc.apply(this,arguments)}function pc(){return(pc=k(m().mark(function e(t,n,r,i,a){var u,o,s,c,l,f;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.mc=function(e,n,r){return(i=k(m().mark(function e(t,n,r,i){var a,u,o;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Hu(r),e.t0=a.Li,!e.t0){e.next=6;break}return e.next=5,mo(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Hu(t,a)});case 5:a=e.sent;case 6:return u=i&&i.targetChanges.get(n.targetId),o=n.view.applyChanges(a,t.isPrimaryClient,u),e.abrupt("return",(Oc(t,n.targetId,o.tc),o.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,mo(t.localStore,n,!0);case 3:return u=e.sent,o=new cc(n,u.Yi),s=o.Hu(u.documents),c=jr.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState,a),l=o.applyChanges(s,t.isPrimaryClient,c),Oc(t,r,l.tc),f=new lc(n,r,o),e.abrupt("return",(t.oc.set(n,f),t.uc.has(r)?t.uc.get(r).push(n):t.uc.set(r,[n]),l.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mc(e,t){return gc.apply(this,arguments)}function gc(){return(gc=k(m().mark(function e(t,n){var r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Z(t),i=r.oc.get(n),!((a=r.uc.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.uc.set(i.targetId,a.filter(function(e){return!qn(e,n)})),void r.oc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,yo(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),us(r.remoteStore,i.targetId),Rc(r,i.targetId)}).catch(Oe);case 9:e.next=14;break;case 11:return Rc(r,i.targetId),e.next=14,yo(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function kc(e,t,n){return wc.apply(this,arguments)}function wc(){return(wc=k(m().mark(function e(t,n,r){var i,a,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=ol(t),e.prev=1,e.next=4,function(e,t){var n,r,i=Z(e),a=pe.now(),u=t.reduce(function(e,t){return e.add(t.key)},Br());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var o=Fr(),s=Br();return i.ji.getEntries(e,u).next(function(e){(o=e).forEach(function(e,t){t.isValidDocument()||(s=s.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,o)}).next(function(r){n=r;var u,o=[],s=p(t);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=pr(c,n.get(c.key).overlayedDocument);null!=l&&o.push(new kr(c.key,l,gn(l.value.mapValue),lr.exists(!0)))}}catch(f){s.e(f)}finally{s.f()}return i.mutationQueue.addMutationBatch(e,a,o,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:Mr(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.fc[e.currentUser.toKey()];r||(r=new ln(de)),r=r.insert(t,n),e.fc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,qc(i,a.changes);case 9:return e.next=11,bs(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=Gs(e.t0,"Failed to persist write"),r.reject(u);case 17:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function xc(e,t){return bc.apply(this,arguments)}function bc(){return(bc=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),e.prev=1,e.next=4,lo(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.hc.get(t);n&&(Y(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.ic=!0:e.modifiedDocuments.size>0?Y(n.ic):e.removedDocuments.size>0&&(Y(n.ic),n.ic=!1))}),e.next=8,qc(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Oe(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function Ic(e,t,n){var r=Z(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.oc.forEach(function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=Z(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=p(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.bu(t)&&(r=!0)}}catch(u){a.e(u)}finally{a.f()}}),r&&tc(n)}(r.eventManager,t),i.length&&r.rc.Ho(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Tc(e,t,n){return Ec.apply(this,arguments)}function Ec(){return(Ec=k(m().mark(function e(t,n,r){var i,a,u,o,s,c;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=Z(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.hc.get(n),!(u=a&&a.key)){e.next=14;break}return o=(o=new ln(be.comparator)).insert(u,kn.newNoDocument(u,me.min())),s=Br().add(u),c=new Qr(me.min(),new Map,new dn(de),o,s),e.next=9,xc(i,c);case 9:i.ac=i.ac.remove(u),i.hc.delete(n),Pc(i),e.next=16;break;case 14:return e.next=16,yo(i.localStore,n,!1).then(function(){return Rc(i,n,r)}).catch(Oe);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Sc(e,t){return _c.apply(this,arguments)}function _c(){return(_c=k(m().mark(function e(t,n){var r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),i=n.batch.batchId,e.prev=1,e.next=4,so(r.localStore,n);case 4:return a=e.sent,Lc(r,i,null),Fc(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,qc(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Oe(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function Ac(e,t,n){return Dc.apply(this,arguments)}function Dc(){return(Dc=k(m().mark(function e(t,n,r){var i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Z(t),e.prev=1,e.next=4,function(e,t){var n=Z(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return Y(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,Lc(i,n,r),Fc(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,qc(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Oe(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function Nc(e,t){return Cc.apply(this,arguments)}function Cc(){return(Cc=k(m().mark(function e(t,n){var r,i,a,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return fs((r=Z(t)).remoteStore)||j("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=Z(r.localStore);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)})}();case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.dc.get(i)||[]).push(n),r.dc.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),u=Gs(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(u);case 16:case"end":return e.stop()}},e,null,[[2,12]])}))).apply(this,arguments)}function Fc(e,t){(e.dc.get(t)||[]).forEach(function(e){e.resolve()}),e.dc.delete(t)}function Lc(e,t,n){var r=Z(e),i=r.fc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.fc[r.currentUser.toKey()]=i}}function Rc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=p(e.uc.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.oc.delete(a),n&&e.rc.gc(a,n)}}catch(u){i.e(u)}finally{i.f()}e.uc.delete(t),e.isPrimaryClient&&e.lc.ds(t).forEach(function(t){e.lc.containsKey(t)||Mc(e,t)})}function Mc(e,t){e.cc.delete(t.path.canonicalString());var n=e.ac.get(t);null!==n&&(us(e.remoteStore,n),e.ac=e.ac.remove(t),e.hc.delete(n),Pc(e))}function Oc(e,t,n){var r,i=p(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof oc?(e.lc.addReference(a.key,t),Vc(e,a)):a instanceof sc?(j("SyncEngine","Document no longer in limbo: "+a.key),e.lc.removeReference(a.key,t),e.lc.containsKey(a.key)||Mc(e,a.key)):X()}}catch(u){i.e(u)}finally{i.f()}}function Vc(e,t){var n=t.key,r=n.path.canonicalString();e.ac.get(n)||e.cc.has(r)||(j("SyncEngine","New document in limbo: "+n),e.cc.add(r),Pc(e))}function Pc(e){for(;e.cc.size>0&&e.ac.size<e.maxConcurrentLimboResolutions;){var t=e.cc.values().next().value;e.cc.delete(t);var n=new be(ke.fromString(t)),r=e._c.next();e.hc.set(r,new fc(n)),e.ac=e.ac.insert(n,r),as(e.remoteStore,new da(On(Nn(n.path)),r,2,Ye.at))}}function qc(e,t,n){return Uc.apply(this,arguments)}function Uc(){return(Uc=k(m().mark(function e(t,n,r){var i,a,u,o;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Z(t),a=[],u=[],o=[],e.t0=i.oc.isEmpty(),e.t0){e.next=9;break}return i.oc.forEach(function(e,t){o.push(i.mc(t,n,r).then(function(e){if((e||r)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){a.push(e);var n=no.Ni(t.targetId,e);u.push(n)}}))}),e.next=6,Promise.all(o);case 6:return i.rc.Ho(a),e.next=9,function(){var e=k(m().mark(function e(t,n){var r,i,a,u,o,s,c,l;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Pe.forEach(n,function(t){return Pe.forEach(t.Ci,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return Pe.forEach(t.xi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Ge(e.t0)){e.next=10;break}throw e.t0;case 10:j("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=p(n);try{for(i.s();!(a=i.n()).done;)u=a.value,o=u.targetId,u.fromCache||(s=r.Ki.get(o),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.Ki=r.Ki.insert(o,l))}catch(f){i.e(f)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,u);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Bc(e,t){return Kc.apply(this,arguments)}function Kc(){return(Kc=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Z(t)).currentUser.isEqual(n)){e.next=11;break}return j("SyncEngine","User change. New user:",n.toKey()),e.next=5,uo(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.dc.forEach(function(e){e.forEach(function(e){e.reject(new ee($.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.dc.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,qc(r,i.Wi);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gc(e,t){var n=Z(e),r=n.hc.get(t);if(r&&r.ic)return Br().add(r.key);var i=Br(),a=n.uc.get(t);if(!a)return i;var u,o=p(a);try{for(o.s();!(u=o.n()).done;){var s=u.value,c=n.oc.get(s);i=i.unionWith(c.view.Wu)}}catch(l){o.e(l)}finally{o.f()}return i}function Qc(e,t){return jc.apply(this,arguments)}function jc(){return(jc=k(m().mark(function e(t,n){var r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),e.next=3,mo(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.nc(i),e.abrupt("return",(r.isPrimaryClient&&Oc(r,n.targetId,a.tc),a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zc(e,t){return Wc.apply(this,arguments)}function Wc(){return(Wc=k(m().mark(function e(t,n){var r;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),e.abrupt("return",ko(r.localStore,n).then(function(e){return qc(r,e)}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Hc(e,t,n,r){return Xc.apply(this,arguments)}function Xc(){return(Xc=k(m().mark(function e(t,n,r,i){var a,u;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Z(t),e.next=3,function(e,t){var n=Z(e),r=Z(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return r.An(e,t).next(function(t){return t?n.localDocuments.getDocuments(e,t):Pe.resolve(null)})})}(a.localStore,n);case 3:if(null===(u=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,bs(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(Lc(a,n,i||null),Fc(a,n),function(e,t){Z(Z(e).mutationQueue).Pn(t)}(a.localStore,n)):X();case 11:return e.next=13,qc(a,u);case 13:e.next=16;break;case 15:j("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Yc(e,t){return Jc.apply(this,arguments)}function Jc(){return(Jc=k(m().mark(function e(t,n){var r,i,a,u,o,s,c,l;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ul(r=Z(t)),ol(r),!0!==n||!0===r.wc){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,Zc(r,i.toArray());case 5:return a=e.sent,r.wc=!0,e.next=9,Ps(r.remoteStore,!0);case 9:u=p(a);try{for(u.s();!(o=u.n()).done;)s=o.value,as(r.remoteStore,s)}catch(f){u.e(f)}finally{u.f()}e.next=25;break;case 13:if(!1!==n||!1===r.wc){e.next=25;break}return c=[],l=Promise.resolve(),r.uc.forEach(function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then(function(){return Rc(r,t),yo(r.localStore,t,!0)}),us(r.remoteStore,t)}),e.next=19,l;case 19:return e.next=21,Zc(r,c);case 21:return function(e){var t=Z(r);t.hc.forEach(function(e,n){us(t.remoteStore,n)}),t.lc._s(),t.hc=new Map,t.ac=new ln(be.comparator)}(),r.wc=!1,e.next=25,Ps(r.remoteStore,!1);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zc(e,t,n){return $c.apply(this,arguments)}function $c(){return($c=k(m().mark(function e(t,n,r){var i,a,u,o,s,c,l,f,h,d,v,y,g,k;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=Z(t),a=[],u=[],o=p(n),e.prev=2,o.s();case 4:if((s=o.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(f=i.uc.get(c))||0===f.length){e.next=34;break}return e.next=11,vo(i.localStore,On(f[0]));case 11:l=e.sent,h=p(f),e.prev=13,h.s();case 15:if((d=h.n()).done){e.next=24;break}return v=d.value,y=i.oc.get(v),e.next=20,Qc(i,y);case 20:(g=e.sent).snapshot&&u.push(g.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),h.e(e.t0);case 29:return e.prev=29,h.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,go(i.localStore,c);case 36:return k=e.sent,e.next=39,vo(i.localStore,k);case 39:return l=e.sent,e.next=42,yc(i,el(k),c,!1,l.resumeToken);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),o.e(e.t1);case 50:return e.prev=50,o.f(),e.finish(50);case 53:return e.abrupt("return",(i.rc.Ho(u),a));case 54:case"end":return e.stop()}},e,null,[[2,47,50,53],[13,26,29,32]])}))).apply(this,arguments)}function el(e){return Dn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function tl(e){var t=Z(e);return Z(Z(t.localStore).persistence).Si()}function nl(e,t,n,r){return rl.apply(this,arguments)}function rl(){return(rl=k(m().mark(function e(t,n,r,i){var a,u,o,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=Z(t)).wc){e.next=3;break}return e.abrupt("return",void j("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((u=a.uc.get(n))&&u.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0?8:"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,ko(a.localStore,Gn(u[0]));case 10:return o=e.sent,s=Qr.createSynthesizedRemoteEventForCurrentChange(n,"current"===r,lt.EMPTY_BYTE_STRING),e.next=14,qc(a,o,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,yo(a.localStore,n,!0);case 17:return Rc(a,n,i),e.abrupt("break",20);case 19:X();case 20:case"end":return e.stop()}},e)}))).apply(this,arguments)}function il(e,t,n){return al.apply(this,arguments)}function al(){return(al=k(m().mark(function e(t,n,r){var i,a,u,o,s,c,l,f,h;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=ul(t)).wc){e.next=45;break}a=p(n),e.prev=3,a.s();case 5:if((u=a.n()).done){e.next=21;break}if(o=u.value,!i.uc.has(o)){e.next=10;break}return j("SyncEngine","Adding an already active target "+o),e.abrupt("continue",19);case 10:return e.next=12,go(i.localStore,o);case 12:return s=e.sent,e.next=15,vo(i.localStore,s);case 15:return c=e.sent,e.next=18,yc(i,el(s),c.targetId,!1,c.resumeToken);case 18:as(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=p(r),e.prev=30,h=m().mark(function e(){var t;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.value,e.t0=i.uc.has(t),!e.t0){e.next=5;break}return e.next=5,yo(i.localStore,t,!1).then(function(){us(i.remoteStore,t),Rc(i,t)}).catch(Oe);case 5:case"end":return e.stop()}},e)}),l.s();case 33:if((f=l.n()).done){e.next=37;break}return e.delegateYield(h(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}},e,null,[[3,23,26,29],[30,39,42,45]])}))).apply(this,arguments)}function ul(e){var t=Z(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=xc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Gc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Tc.bind(null,t),t.rc.Ho=$s.bind(null,t.eventManager),t.rc.gc=ec.bind(null,t.eventManager),t}function ol(e){var t=Z(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Sc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ac.bind(null,t),t}function sl(e,t,n){var r,i=Z(e);(r=k(m().mark(function e(t,n,r){var i,a,u,o,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=Z(e),r=ui(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",function(e){return n.$s.getBundleMetadata(e,t.id)}).then(function(e){return!!e&&e.createTime.compareTo(r)>=0})}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(uc(i)),a=new ac(i,t.localStore,n.Tt),e.next=15,n.yc();case 15:u=e.sent;case 16:if(!u){e.next=26;break}return e.next=19,a.Bu(u);case 19:return(o=e.sent)&&r._updateProgress(o),e.next=23,n.yc();case 23:u=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,qc(t,s.Uu,void 0);case 31:return e.next=33,function(e,t){var n=Z(e);return n.persistence.runTransaction("Save bundle","readwrite",function(e){return n.$s.saveBundleMetadata(e,t)})}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.qu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(W("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}},e,null,[[0,37]])})),function(e,t,n){return r.apply(this,arguments)})(i,t,n).then(function(e){i.sharedClientState.notifyBundleLoaded(e)})}var cl=function(){function e(){R(this,e),this.synchronizeTabs=!1}return O(e,[{key:"initialize",value:function(){var e=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.Tt=jo(t.databaseInfo.databaseId),this.sharedClientState=this.Ic(t),this.persistence=this.Tc(t),e.next=5,this.persistence.start();case 5:this.localStore=this.Ec(t),this.gcScheduler=this.Ac(t,this.localStore),this.indexBackfillerScheduler=this.Rc(t,this.localStore);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Ac",value:function(e,t){return null}},{key:"Rc",value:function(e,t){return null}},{key:"Ec",value:function(e){return ao(this.persistence,new ro,e.initialUser,this.Tt)}},{key:"Tc",value:function(e){return new zu(Hu.qs,this.Tt)}},{key:"Ic",value:function(e){return new Ro}},{key:"terminate",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),ll=function(e){w(n,cl);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this)).Pc=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return O(n,[{key:"initialize",value:function(){var e=k(m().mark(function e(t){var r=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(S(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.Pc.initialize(this,t);case 4:return e.next=6,ol(this.Pc.syncEngine);case 6:return e.next=8,bs(this.Pc.remoteStore);case 8:return e.next=10,this.persistence.di(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Ec",value:function(e){return ao(this.persistence,new ro,e.initialUser,this.Tt)}},{key:"Ac",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new Iu(n,e.asyncQueue,t)}},{key:"Rc",value:function(e,t){var n=new Xe(t,this.persistence);return new He(e.asyncQueue,n)}},{key:"Tc",value:function(e){var t=to(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?su.withCacheSize(this.cacheSizeBytes):su.DEFAULT;return new Zu(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Go(),Qo(),this.Tt,this.sharedClientState,!!this.forceOwnership)}},{key:"Ic",value:function(e){return new Ro}}]),n}(),fl=function(e){w(n,ll);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e,r,!1)).Pc=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return O(n,[{key:"initialize",value:function(){var e=k(m().mark(function e(t){var r,i=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(S(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.Pc.syncEngine,e.t0=this.sharedClientState instanceof Lo,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={Br:Hc.bind(null,r),Lr:nl.bind(null,r),qr:il.bind(null,r),Si:tl.bind(null,r),Fr:zc.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.di(function(){var e=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yc(i.Pc.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start():t||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(t&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():t||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Ic",value:function(e){var t=Go();if(!Lo.C(t))throw new ee($.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=to(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Lo(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(),hl=function(){function e(){R(this,e)}return O(e,[{key:"initialize",value:function(){var e=k(m().mark(function e(t,n){var r=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return Ic(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Bc.bind(null,this.syncEngine),e.next=12,Ps(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new Hs}},{key:"createDatastore",value:function(e){var t,n=jo(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new Ko(t));return function(e,t,n,r){return new Yo(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,u=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return Ic(u.syncEngine,e,0)},a=Oo.C()?new Oo:new Mo,new es(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,u){var o=new hc(e,t,n,r,i,a);return u&&(o.wc=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return(e=k(m().mark(function e(t){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z(t),j("RemoteStore","RemoteStore shutting down."),n.mu.add(5),e.next=5,rs(n);case 5:n.yu.shutdown(),n.pu.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}();function dl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return k(m().mark(function r(){var i;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}},r)}))()},cancel:function(){return k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()},releaseLock:function(){},closed:Promise.resolve()}}var vl=function(){function e(t){R(this,e),this.observer=t,this.muted=!1}return O(e,[{key:"next",value:function(e){this.observer.next&&this.vc(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.vc(this.observer.error,e):z("Uncaught Error in snapshot listener:",e.toString())}},{key:"bc",value:function(){this.muted=!0}},{key:"vc",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),yl=function(){function e(t,n){var r=this;R(this,e),this.Vc=t,this.Tt=n,this.metadata=new te,this.buffer=new Uint8Array,this.Sc=new TextDecoder("utf-8"),this.Dc().then(function(e){e&&e.Ou()?r.metadata.resolve(e.Mu.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.Mu))))},function(e){return r.metadata.reject(e)})}return O(e,[{key:"close",value:function(){return this.Vc.cancel()}},{key:"getMetadata",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"yc",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Dc());case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Dc",value:function(){var e=k(m().mark(function e(){var t,n,r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Cc();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.Sc.decode(t),r=Number(n),isNaN(r)&&this.xc("length string (".concat(n,") is not valid number")),e.next=9,this.Nc(r);case 9:return i=e.sent,e.abrupt("return",new rc(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"kc",value:function(){return this.buffer.findIndex(function(e){return e==="{".charCodeAt(0)})}},{key:"Cc",value:function(){var e=k(m().mark(function e(){var t,n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.kc()<0)){e.next=7;break}return e.next=3,this.$c();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.kc())<0&&this.xc("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Nc",value:function(){var e=k(m().mark(function e(t){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.$c();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.xc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.Sc.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"xc",value:function(e){throw this.Vc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"$c",value:function(){var e=k(m().mark(function e(){var t,n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Vc.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),pl=function(){function e(t){R(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return O(e,[{key:"lookup",value:function(){var e=k(m().mark(function e(t){var n,r=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new ee($.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=k(m().mark(function e(t,n){var r,i,a,u,o,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),i=di(r.Tt)+"/documents",a={documents:n.map(function(e){return ci(r.Tt,e)})},e.next=5,r.mo("BatchGetDocuments",i,a,n.length);case 5:return u=e.sent,o=new Map,u.forEach(function(e){var t=mi(r.Tt,e);o.set(t.key.toString(),t)}),s=[],e.abrupt("return",(n.forEach(function(e){var t=o.get(e.toString());Y(!!t),s.push(t)}),s));case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach(function(e){return r.recordVersion(e)}),n));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new Er(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=k(m().mark(function e(){var t,n=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(e,t){var r=be.fromPath(t);n.mutations.push(new Sr(r,n.precondition(r)))}),e.next=7,function(){var e=k(m().mark(function e(t,n){var r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),i=di(r.Tt)+"/documents",a={writes:n.map(function(e){return ki(r.Tt,e)})},e.next=3,r.lo("Commit",i,a);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw X();t=me.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ee($.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(me.min())?lr.exists(!1):lr.updateTime(t):lr.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(me.min()))throw new ee($.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return lr.updateTime(t)}return lr.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),ml=function(){function e(t,n,r,i,a){R(this,e),this.asyncQueue=t,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=a,this.Mc=r.maxAttempts,this.ko=new zo(this.asyncQueue,"transaction_retry")}return O(e,[{key:"run",value:function(){this.Mc-=1,this.Oc()}},{key:"Oc",value:function(){var e=this;this.ko.vo(k(m().mark(function t(){var n,r;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=new pl(e.datastore),(r=e.Fc(n))&&r.then(function(t){e.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){e.deferred.resolve(t)}).catch(function(t){e.Bc(t)})})}).catch(function(t){e.Bc(t)});case 2:case"end":return t.stop()}},t)})))}},{key:"Fc",value:function(e){try{var t=this.updateFunction(e);return!at(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Bc",value:function(e){var t=this;this.Mc>0&&this.Lc(e)?(this.Mc-=1,this.asyncQueue.enqueueAndForget(function(){return t.Oc(),Promise.resolve()})):this.deferred.reject(e)}},{key:"Lc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Ar(t)}return!1}}]),e}(),gl=function(){function e(t,n,r,i){var a=this;R(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=U.UNAUTHENTICATED,this.clientId=he.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return j("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,function(e){return j("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return O(e,[{key:"getConfiguration",value:function(){var e=k(m().mark(function e(){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new ee($.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new te;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(k(m().mark(function n(){var r;return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=Gs(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function kl(e,t){return wl.apply(this,arguments)}function wl(){return(wl=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,uo(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xl(e,t){return bl.apply(this,arguments)}function bl(){return(bl=k(m().mark(function e(t,n){var r,i;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,Il(t);case 3:return r=e.sent,j("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return Os(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return Os(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Il(e){return Tl.apply(this,arguments)}function Tl(){return(Tl=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return j("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,kl(t,new cl);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function El(e){return Sl.apply(this,arguments)}function Sl(){return(Sl=k(m().mark(function e(t){return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return j("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,xl(t,new hl);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function _l(e){return Il(e).then(function(e){return e.persistence})}function Al(e){return Il(e).then(function(e){return e.localStore})}function Dl(e){return El(e).then(function(e){return e.remoteStore})}function Nl(e){return El(e).then(function(e){return e.syncEngine})}function Cl(e){return El(e).then(function(e){return e.datastore})}function Fl(e){return Ll.apply(this,arguments)}function Ll(){return(Ll=k(m().mark(function e(t){var n,r;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,El(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=dc.bind(null,n.syncEngine),r.onUnlisten=mc.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Rl(e){return e.asyncQueue.enqueue(k(m().mark(function t(){var n,r;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_l(e);case 2:return n=t.sent,t.next=5,Dl(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=Z(r);return t.mu.delete(0),ts(t)}()));case 7:case"end":return t.stop()}},t)})))}function Ml(e){return e.asyncQueue.enqueue(k(m().mark(function t(){var n,r;return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_l(e);case 2:return n=t.sent,t.next=5,Dl(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=k(m().mark(function e(t){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Z(t)).mu.add(0),e.next=4,rs(n);case 4:n.pu.set("Offline");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}},t)})))}function Ol(e,t){var n=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function r(){return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=k(m().mark(function e(t,n,r){var i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=Z(e);return n.persistence.runTransaction("read document","readonly",function(e){return n.localDocuments.getDocument(e,t)})}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new ee($.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=Gs(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,Al(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function Vl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function i(){return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new vl({next:function(a){t.enqueueAndForget(function(){return Js(e,u)});var o=a.docs.has(n);!o&&a.fromCache?i.reject(new ee($.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&a.fromCache&&r&&"server"===r.source?i.reject(new ee($.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),u=new nc(Nn(n.path),a,{includeMetadataChanges:!0,$u:!0});return Xs(e,u)},i.next=3,Fl(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function Pl(e,t){var n=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function r(){return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=k(m().mark(function e(t,n,r){var i,a,u,o,s;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,mo(t,n,!0);case 3:i=e.sent,a=new cc(n,i.Yi),u=a.Hu(i.documents),o=a.applyChanges(u,!1),r.resolve(o.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=Gs(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,Al(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function ql(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function i(){return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new vl({next:function(n){t.enqueueAndForget(function(){return Js(e,u)}),n.fromCache&&"server"===r.source?i.reject(new ee($.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),u=new nc(n,a,{includeMetadataChanges:!0,$u:!0});return Xs(e,u)},i.next=3,Fl(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function Ul(e,t){var n=new vl(t);return e.asyncQueue.enqueueAndForget(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Z(e).vu.add(t),t.next()},t.next=3,Fl(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){n.bc(),e.asyncQueue.enqueueAndForget(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){Z(e).vu.delete(t)},t.next=3,Fl(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}function Bl(e,t,n,r){var i=function(e,t){return function(e,t){return new yl(e,t)}(function(e,t){if(e instanceof Uint8Array)return dl(e,t);if(e instanceof ArrayBuffer)return dl(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,jo(t));e.asyncQueue.enqueueAndForget(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=sl,t.next=3,Nl(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}},t)})))}function Kl(e,t){return e.asyncQueue.enqueue(k(m().mark(function n(){return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=Z(e);return n.persistence.runTransaction("Get named query","readonly",function(e){return n.$s.getNamedQuery(e,t)})},n.next=3,Al(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)})))}var Gl=new Map;function Ql(e,t,n){if(!n)throw new ee($.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function jl(e,t,n,r){if(!0===t&&!0===r)throw new ee($.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function zl(e){if(!be.isDocumentKey(e))throw new ee($.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Wl(e){if(be.isDocumentKey(e))throw new ee($.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Hl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==L(e)){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":X()}function Xl(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ee($.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Hl(e);throw new ee($.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function Yl(e,t){if(t<=0)throw new ee($.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Jl=function(){function e(t){var n;if(R(this,e),void 0===t.host){if(void 0!==t.ssl)throw new ee($.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ee($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,jl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return O(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),Zl=function(){function e(t,n,r,i){R(this,e),this._authCredentials=t,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jl({}),this._settingsFrozen=!1}return O(e,[{key:"app",get:function(){if(!this._app)throw new ee($.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new ee($.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jl(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new re;switch(e.type){case"gapi":var t=e.client;return new oe(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ee($.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=Gl.get(e))&&(j("ComponentProvider","Removing Datastore"),Gl.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();function $l(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=(e=Xl(e,Zl))._getSettings();if("firestore.googleapis.com"!==u.host&&u.host!==t&&W("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},u),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,s;if("string"==typeof i.mockUserToken)o=i.mockUserToken,s=U.MOCK_USER;else{o=(0,a.createMockUserToken)(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=i.mockUserToken.sub||i.mockUserToken.user_id;if(!c)throw new ee($.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new U(c)}e._authCredentials=new ie(new ne(o,s))}}var ef=function(){function e(t,n,r){R(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return O(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new nf(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}();exports.DocumentReference=ef;var tf=function(){function e(t,n,r){R(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return O(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}();exports.Query=tf;var nf=function(e){w(n,tf);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this,e,r,Nn(i)))._path=i,a.type="collection",a}return O(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new ef(this.firestore,null,new be(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}();function rf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,a.getModularInstance)(e),Ql("collection","path",t),e instanceof Zl){var u=ke.fromString.apply(ke,[t].concat(r));return Wl(u),new nf(e,null,u)}if(!(e instanceof ef||e instanceof nf))throw new ee($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ke.fromString.apply(ke,[t].concat(r)));return Wl(o),new nf(e.firestore,null,o)}function af(e,t){if(e=Xl(e,Zl),Ql("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new ee($.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new tf(e,null,function(e){return new An(ke.emptyPath(),e)}(t))}function uf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,a.getModularInstance)(e),1===arguments.length&&(t=he.R()),Ql("doc","path",t),e instanceof Zl){var u=ke.fromString.apply(ke,[t].concat(r));return zl(u),new ef(e,null,new be(u))}if(!(e instanceof ef||e instanceof nf))throw new ee($.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(ke.fromString.apply(ke,[t].concat(r)));return zl(o),new ef(e.firestore,e instanceof nf?e.converter:null,new be(o))}function of(e,t){return e=(0,a.getModularInstance)(e),t=(0,a.getModularInstance)(t),(e instanceof ef||e instanceof nf)&&(t instanceof ef||t instanceof nf)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function sf(e,t){return e=(0,a.getModularInstance)(e),t=(0,a.getModularInstance)(t),e instanceof tf&&t instanceof tf&&e.firestore===t.firestore&&qn(e._query,t._query)&&e.converter===t.converter}exports.CollectionReference=nf;var cf=function(){function e(){var t=this;R(this,e),this.qc=Promise.resolve(),this.Uc=[],this.Kc=!1,this.Gc=[],this.Qc=null,this.jc=!1,this.zc=!1,this.Wc=[],this.ko=new zo(this,"async_queue_retry"),this.Hc=function(){var e=Qo();e&&j("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ko.Vo()};var n=Qo();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Hc)}return O(e,[{key:"isShuttingDown",get:function(){return this.Kc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Jc(),this.Yc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Kc){this.Kc=!0,this.zc=e||!1;var t=Qo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Hc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Jc(),this.Kc)return new Promise(function(){});var n=new te;return this.Yc(function(){return t.Kc&&t.zc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Uc.push(e),t.Zc()})}},{key:"Zc",value:function(){var e=k(m().mark(function e(){var t=this;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Uc.length){e.next=14;break}return e.prev=1,e.next=4,this.Uc[0]();case 4:this.Uc.shift(),this.ko.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),Ge(e.t0)){e.next=12;break}throw e.t0;case 12:j("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Uc.length>0&&this.ko.vo(function(){return t.Zc()});case 14:case"end":return e.stop()}},e,this,[[1,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"Yc",value:function(e){var t=this,n=this.qc.then(function(){return t.jc=!0,e().catch(function(e){throw t.Qc=e,t.jc=!1,z("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(function(e){return t.jc=!1,e})});return this.qc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Jc(),this.Wc.indexOf(e)>-1&&(t=0);var i=Ks.createAndSchedule(this,e,t,n,function(e){return r.Xc(e)});return this.Gc.push(i),i}},{key:"Jc",value:function(){this.Qc&&X()}},{key:"verifyOperationInProgress",value:function(){}},{key:"ta",value:function(){var e=k(m().mark(function e(){var t;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.qc,e.next=3,t;case 3:if(t!==this.qc){e.next=0;break}case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"ea",value:function(e){var t,n=p(this.Gc);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"na",value:function(e){var t=this;return this.ta().then(function(){t.Gc.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=p(t.Gc);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.ta()})}},{key:"sa",value:function(e){this.Wc.push(e)}},{key:"Xc",value:function(e){var t=this.Gc.indexOf(e);this.Gc.splice(t,1)}}]),e}();function lf(e){return function(e,t){if("object"!=L(e)||null===e)return!1;var n,r=e,i=p(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(u){i.e(u)}finally{i.f()}return!1}(e)}var ff=function(){function e(){R(this,e),this._progressObserver={},this._taskCompletionResolver=new te,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return O(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}();exports.LoadBundleTask=ff;var hf=-1;exports.CACHE_SIZE_UNLIMITED=hf;var df=function(e){w(n,Zl);var t=b(n);function n(e,r,i,a){var u;return R(this,n),(u=t.call(this,e,r,i,a)).type="firestore",u._queue=new cf,u._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]",u}return O(n,[{key:"_terminate",value:function(){return this._firestoreClient||mf(this),this._firestoreClient.terminate()}}]),n}();function vf(e,t,r){r||(r="(default)");var i=(0,n._getProvider)(e,"firestore");if(i.isInitialized(r)){var u=i.getImmediate({identifier:r}),o=i.getOptions(r);if((0,a.deepEqual)(o,t))return u;throw new ee($.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ee($.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:r})}function yf(e,t){var r="object"==L(e)?e:(0,n.getApp)(),i="string"==typeof e?e:t||"(default)",u=(0,n._getProvider)(r,"firestore").getImmediate({identifier:i});if(!u._initialized){var o=(0,a.getDefaultEmulatorHostnameAndPort)("firestore");o&&$l.apply(void 0,[u].concat(_(o)))}return u}function pf(e){return e._firestoreClient||mf(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function mf(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new et(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new gl(e._authCredentials,e._appCheckCredentials,e._queue,r)}function gf(e,t){Af(e=Xl(e,df));var n=pf(e),r=e._freezeSettings(),i=new hl;return wf(n,i,new ll(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function kf(e){Af(e=Xl(e,df));var t=pf(e),n=e._freezeSettings(),r=new hl;return wf(t,r,new fl(r,n.cacheSizeBytes))}function wf(e,t,n){var r=new te;return e.asyncQueue.enqueue(k(m().mark(function i(){var a;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,kl(e,n);case 3:return i.next=5,xl(e,t);case 5:r.resolve(),i.next=14;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===$.FAILED_PRECONDITION||e.code===$.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(a=i.t0)){i.next=13;break}throw a;case 13:W("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a);case 14:case"end":return i.stop()}},i,null,[[0,8]])}))).then(function(){return r.promise})}function xf(e){if(e._initialized&&!e._terminated)throw new ee($.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new te;return e._queue.enqueueAndForgetEvenWhileRestricted(k(m().mark(function n(){return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=k(m().mark(function e(t){var n;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ue.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,Ue.delete(n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(to(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}},n,null,[[0,6]])}))),t.promise}function bf(e){return function(e){var t=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function n(){return m().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Nc,n.next=3,Nl(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)}))),t.promise}(pf(e=Xl(e,df)))}function If(e){return Rl(pf(e=Xl(e,df)))}function Tf(e){return Ml(pf(e=Xl(e,df)))}function Ef(e){return(0,n._removeServiceInstance)(e.app,"firestore",e._databaseId.database),e._delete()}function Sf(e,t){var n=pf(e=Xl(e,df)),r=new ff;return Bl(n,e._databaseId,t,r),r}function _f(e,t){return Kl(pf(e=Xl(e,df)),t).then(function(t){return t?new tf(e,null,t.query):null})}function Af(e){if(e._initialized||e._terminated)throw new ee($.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}exports.Firestore=df;var Df=O(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",n=arguments.length>1?arguments[1]:void 0;R(this,e),this._aggregateType=t,this._internalFieldPath=n,this.type="AggregateField"});exports.AggregateField=Df;var Nf=function(){function e(t,n,r){R(this,e),this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=t}return O(e,[{key:"data",value:function(){return this._userDataWriter.convertValue(this._data.value)}}]),e}();exports.AggregateQuerySnapshot=Nf;var Cf=function(){function e(t){R(this,e),this._byteString=t}return O(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(lt.fromBase64String(t))}catch(t){throw new ee($.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(lt.fromUint8Array(t))}}]),e}();exports.Bytes=Cf;var Ff=function(){function e(){R(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new ee($.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(n)}return O(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();function Lf(){return new Ff("__name__")}exports.FieldPath=Ff;var Rf=O(function e(t){R(this,e),this._methodName=t});exports.FieldValue=Rf;var Mf=function(){function e(t,n){if(R(this,e),!isFinite(t)||t<-90||t>90)throw new ee($.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new ee($.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return O(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return de(this._lat,e._lat)||de(this._long,e._long)}}]),e}();exports.GeoPoint=Mf;var Of=/^__.*__$/,Vf=function(){function e(t,n,r){R(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return O(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new gr(e,this.data,t,this.fieldTransforms)}}]),e}(),Pf=function(){function e(t,n,r){R(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return O(e,[{key:"toMutation",value:function(e,t){return new kr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function qf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}var Uf=function(){function e(t,n,r,i,a,u){R(this,e),this.settings=t,this.databaseId=n,this.Tt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ia(),this.fieldTransforms=a||[],this.fieldMask=u||[]}return O(e,[{key:"path",get:function(){return this.settings.path}},{key:"ra",get:function(){return this.settings.ra}},{key:"oa",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.Tt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ua",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.oa({path:n,ca:!1});return r.aa(e),r}},{key:"ha",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.oa({path:n,ca:!1});return r.ia(),r}},{key:"la",value:function(e){return this.oa({path:void 0,ca:!0})}},{key:"fa",value:function(e){return uh(e,this.settings.methodName,this.settings.da||!1,this.path,this.settings._a)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"ia",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.aa(this.path.get(e))}},{key:"aa",value:function(e){if(0===e.length)throw this.fa("Document fields must not be empty");if(qf(this.ra)&&Of.test(e))throw this.fa('Document fields cannot begin and end with "__"')}}]),e}(),Bf=function(){function e(t,n,r){R(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.Tt=r||jo(t)}return O(e,[{key:"wa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Uf({ra:e,methodName:t,_a:n,path:xe.emptyPath(),ca:!1,da:r},this.databaseId,this.Tt,this.ignoreUndefinedProperties)}}]),e}();function Kf(e){var t=e._freezeSettings(),n=jo(e._databaseId);return new Bf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Gf(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=e.wa(a.merge||a.mergeFields?2:0,t,n,i);nh("Data must be an object, but it was:",u,r);var o,s,c=eh(r,u);if(a.merge)o=new pn(u.fieldMask),s=u.fieldTransforms;else if(a.mergeFields){var l,f=[],h=p(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=rh(t,l.value,n);if(!u.contains(d))throw new ee($.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));oh(f,d)||f.push(d)}}catch(v){h.e(v)}finally{h.f()}o=new pn(f),s=u.fieldTransforms.filter(function(e){return o.covers(e.field)})}else o=null,s=u.fieldTransforms;return new Vf(new mn(c),o,s)}var Qf=function(e){w(n,Rf);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.ra)throw 1===e.ra?e.fa("".concat(this._methodName,"() can only appear at the top level of your update data")):e.fa("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}();function jf(e,t,n){return new Uf({ra:3,_a:t.settings._a,methodName:e._methodName,ca:n},t.databaseId,t.Tt,t.ignoreUndefinedProperties)}var zf=function(e){w(n,Rf);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"_toFieldTransform",value:function(e){return new or(e.path,new $n)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(),Wf=function(e){w(n,Rf);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e)).ma=r,i}return O(n,[{key:"_toFieldTransform",value:function(e){var t=jf(this,e,!0),n=this.ma.map(function(e){return $f(e,t)}),r=new er(n);return new or(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(),Hf=function(e){w(n,Rf);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e)).ma=r,i}return O(n,[{key:"_toFieldTransform",value:function(e){var t=jf(this,e,!0),n=this.ma.map(function(e){return $f(e,t)}),r=new nr(n);return new or(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(),Xf=function(e){w(n,Rf);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e)).ga=r,i}return O(n,[{key:"_toFieldTransform",value:function(e){var t=new ir(e.Tt,Hn(e.Tt,this.ga));return new or(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}();function Yf(e,t,n,r){var i=e.wa(1,t,n);nh("Data must be an object, but it was:",i,r);var u=[],o=mn.empty();rt(r,function(e,r){var s=ah(t,e,n);r=(0,a.getModularInstance)(r);var c=i.ha(s);if(r instanceof Qf)u.push(s);else{var l=$f(r,c);null!=l&&(u.push(s),o.set(s,l))}});var s=new pn(u);return new Pf(o,s,i.fieldTransforms)}function Jf(e,t,n,r,i,u){var o=e.wa(1,t,n),s=[rh(t,r,n)],c=[i];if(u.length%2!=0)throw new ee($.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var l=0;l<u.length;l+=2)s.push(rh(t,u[l])),c.push(u[l+1]);for(var f=[],h=mn.empty(),d=s.length-1;d>=0;--d)if(!oh(f,s[d])){var v=s[d],y=c[d];y=(0,a.getModularInstance)(y);var p=o.ha(v);if(y instanceof Qf)f.push(v);else{var m=$f(y,p);null!=m&&(f.push(v),h.set(v,m))}}var g=new pn(f);return new Pf(h,g,o.fieldTransforms)}function Zf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return $f(n,e.wa(r?4:3,t))}function $f(e,t){if(th(e=(0,a.getModularInstance)(e)))return nh("Unsupported field value:",t,e),eh(e,t);if(e instanceof Rf)return function(e,t){if(!qf(t.ra))throw t.fa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.fa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ca&&4!==t.ra)throw t.fa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=p(e);try{for(a.s();!(n=a.n()).done;){var u=$f(n.value,t.la(i));null==u&&(u={nullValue:"NULL_VALUE"}),r.push(u),i++}}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,a.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Hn(t.Tt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=pe.fromDate(e);return{timestampValue:ri(t.Tt,n)}}if(e instanceof pe){var r=new pe(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ri(t.Tt,r)}}if(e instanceof Mf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Cf)return{bytesValue:ii(t.Tt,e._byteString)};if(e instanceof ef){var i=t.databaseId,u=e.firestore._databaseId;if(!u.isEqual(i))throw t.fa("Document reference is for database ".concat(u.projectId,"/").concat(u.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:oi(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.fa("Unsupported field value: ".concat(Hl(e)))}(e,t)}function eh(e,t){var n={};return it(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):rt(e,function(e,r){var i=$f(r,t.ua(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function th(e){return!("object"!=L(e)||null===e||e instanceof Array||e instanceof Date||e instanceof pe||e instanceof Mf||e instanceof Cf||e instanceof ef||e instanceof Rf)}function nh(e,t,n){if(!th(n)||!function(e){return"object"==L(e)&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Hl(n);throw"an object"===r?t.fa(e+" a custom object"):t.fa(e+" "+r)}}function rh(e,t,n){if((t=(0,a.getModularInstance)(t))instanceof Ff)return t._internalPath;if("string"==typeof t)return ah(e,t);throw uh("Field path arguments must be of type string or ",e,!1,void 0,n)}var ih=new RegExp("[~\\*/\\[\\]]");function ah(e,t,n){if(t.search(ih)>=0)throw uh("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return v(Ff,_(t.split(".")))._internalPath}catch(r){throw uh("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function uh(e,t,n,r,i){var a=r&&!r.isEmpty(),u=void 0!==i,o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";var s="";return(a||u)&&(s+=" (found",a&&(s+=" in field ".concat(r)),u&&(s+=" in document ".concat(i)),s+=")"),new ee($.INVALID_ARGUMENT,o+e+s)}function oh(e,t){return e.some(function(e){return e.isEqual(t)})}var sh=function(){function e(t,n,r,i,a){R(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return O(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new ef(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new ch(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(lh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),ch=function(e){w(n,sh);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"data",value:function(){return o(S(n.prototype),"data",this).call(this)}}]),n}();function lh(e,t){return"string"==typeof t?ah(e,t):t instanceof Ff?t._internalPath:t._delegate._internalPath}function fh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ee($.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var hh=O(function e(){R(this,e)}),dh=function(e){w(n,hh);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n)}();function vh(e,t){for(var n=[],r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof hh&&n.push(t),function(e){var t=e.filter(function(e){return e instanceof mh}).length,n=e.filter(function(e){return e instanceof yh}).length;if(t>1||t>0&&n>0)throw new ee($.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n=n.concat(i));var u,o=p(n);try{for(o.s();!(u=o.n()).done;){e=u.value._apply(e)}}catch(s){o.e(s)}finally{o.f()}return e}exports.QueryConstraint=dh;var yh=function(e){w(n,dh);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this))._field=e,a._op=r,a._value=i,a.type="where",a}return O(n,[{key:"_apply",value:function(e){var t=this._parse(e);return Rh(e._query,t),new tf(e.firestore,e.converter,Vn(e._query,t))}},{key:"_parse",value:function(e){var t=Kf(e.firestore);return function(e,t,n,r,i,a,u){var o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new ee($.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Lh(u,a);var s,c=[],l=p(u);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.push(Fh(r,e,f))}}catch(h){l.e(h)}finally{l.f()}o={arrayValue:{values:c}}}else o=Fh(r,e,u)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Lh(u,a),o=Zf(n,"where",u,"in"===a||"not-in"===a);return Gt.create(i,a,o)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}();function ph(e,t,n){var r=t,i=lh("where",e);return yh._create(i,r,n)}exports.QueryFieldFilterConstraint=yh;var mh=function(e){w(n,hh);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this)).type=e,i._queryConstraints=r,i}return O(n,[{key:"_parse",value:function(e){var t=this._queryConstraints.map(function(t){return t._parse(e)}).filter(function(e){return e.getFilters().length>0});return 1===t.length?t[0]:Qt.create(t,this._getOperator())}},{key:"_apply",value:function(e){var t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){var n,r=e,i=p(t.getFlattenedFilters());try{for(i.s();!(n=i.n()).done;){var a=n.value;Rh(r,a),r=Vn(r,a)}}catch(u){i.e(u)}finally{i.f()}}(e._query,t),new tf(e.firestore,e.converter,Vn(e._query,t)))}},{key:"_getQueryConstraints",value:function(){return this._queryConstraints}},{key:"_getOperator",value:function(){return"and"===this.type?"and":"or"}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}();function gh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){return Oh("or",e)}),mh._create("or",t)}function kh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach(function(e){return Oh("and",e)}),mh._create("and",t)}exports.QueryCompositeFilterConstraint=mh;var wh=function(e){w(n,dh);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this))._field=e,i._direction=r,i.type="orderBy",i}return O(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new ee($.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ee($.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new sn(t,n);return function(e,t){if(null===Fn(e)){var n=Ln(e);null!==n&&Mh(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new tf(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new An(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t){return new n(e,t)}}]),n}();function xh(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=lh("orderBy",e);return wh._create(n,t)}exports.QueryOrderByConstraint=wh;var bh=function(e){w(n,dh);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this)).type=e,a._limit=r,a._limitType=i,a}return O(n,[{key:"_apply",value:function(e){return new tf(e.firestore,e.converter,Pn(e._query,this._limit,this._limitType))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}();function Ih(e){return Yl("limit",e),bh._create("limit",e,"F")}function Th(e){return Yl("limitToLast",e),bh._create("limitToLast",e,"L")}exports.QueryLimitConstraint=bh;var Eh=function(e){w(n,dh);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return O(n,[{key:"_apply",value:function(e){var t=Ch(e,this.type,this._docOrFields,this._inclusive);return new tf(e.firestore,e.converter,function(e,t){return new An(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}();function Sh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Eh._create("startAt",t,!0)}function _h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Eh._create("startAfter",t,!1)}exports.QueryStartAtConstraint=Eh;var Ah=function(e){w(n,dh);var t=b(n);function n(e,r,i){var a;return R(this,n),(a=t.call(this)).type=e,a._docOrFields=r,a._inclusive=i,a}return O(n,[{key:"_apply",value:function(e){var t=Ch(e,this.type,this._docOrFields,this._inclusive);return new tf(e.firestore,e.converter,function(e,t){return new An(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}],[{key:"_create",value:function(e,t,r){return new n(e,t,r)}}]),n}();function Dh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ah._create("endBefore",t,!1)}function Nh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ah._create("endAt",t,!0)}function Ch(e,t,n,r){if(n[0]=(0,a.getModularInstance)(n[0]),n[0]instanceof sh)return function(e,t,n,r,i){if(!r)throw new ee($.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,u=[],o=p(Mn(e));try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.field.isKeyField())u.push(_t(t,r.key));else{var c=r.data.field(s.field);if(yt(c))throw new ee($.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new ee($.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}u.push(c)}}}catch(f){o.e(f)}finally{o.f()}return new qt(u,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=Kf(e.firestore);return function(e,t,n,r,i,a){var u=e.explicitOrderBy;if(i.length>u.length)throw new ee($.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var o=[],s=0;s<i.length;s++){var c=i[s];if(u[s].field.isKeyField()){if("string"!=typeof c)throw new ee($.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(L(c)));if(!Rn(e)&&-1!==c.indexOf("/"))throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(ke.fromString(c));if(!be.isDocumentKey(l))throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new be(l);o.push(_t(t,f))}else{var h=Zf(n,r,c);o.push(h)}}return new qt(o,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function Fh(e,t,n){if("string"==typeof(n=(0,a.getModularInstance)(n))){if(""===n)throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rn(t)&&-1!==n.indexOf("/"))throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(ke.fromString(n));if(!be.isDocumentKey(r))throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return _t(e,new be(r))}if(n instanceof ef)return _t(e,n._key);throw new ee($.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Hl(n),"."))}function Lh(e,t){if(!Array.isArray(e)||0===e.length)throw new ee($.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Rh(e,t){if(t.isInequality()){var n=Ln(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new ee($.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(r.toString(),"'"));var i=Fn(e);null!==i&&Mh(e,r,i)}var a=function(e,t){var n,r=p(e);try{for(r.s();!(n=r.n()).done;){var i,a=p(n.value.getFlattenedFilters());try{for(a.s();!(i=a.n()).done;){var u=i.value;if(t.indexOf(u.op)>=0)return u.op}}catch(o){a.e(o)}finally{a.f()}}}catch(o){r.e(o)}finally{r.f()}return null}(e.filters,function(e){switch(t.op){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}());if(null!==a)throw a===t.op?new ee($.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new ee($.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(a.toString(),"' filters."))}function Mh(e,t,n){if(!n.isEqual(t))throw new ee($.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function Oh(e,t){if(!(t instanceof yh||t instanceof mh))throw new ee($.INVALID_ARGUMENT,"Function ".concat(e,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}exports.QueryEndAtConstraint=Ah;var Vh=function(){function e(){R(this,e)}return O(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(wt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw X()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return rt(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new Mf(dt(e.latitude),dt(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=pt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(mt(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=ht(e);return new pe(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=ke.fromString(e);Y(Ri(n));var r=new tt(n.get(1),n.get(3)),i=new be(n.popFirst(5));return r.isEqual(t)||z("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function Ph(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}exports.AbstractUserDataWriter=Vh;var qh=function(e){w(n,Vh);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).firestore=e,r}return O(n,[{key:"convertBytes",value:function(e){return new Cf(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ef(this.firestore,null,t)}}]),n}();function Uh(e){return new Df("sum",rh("sum",e))}function Bh(e){return new Df("avg",rh("average",e))}function Kh(){return new Df("count")}function Gh(e,t){var n,r;return e instanceof Df&&t instanceof Df&&e._aggregateType===t._aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())}function Qh(e,t){return sf(e.query,t.query)&&(0,a.deepEqual)(e.data(),t.data())}var jh=function(){function e(t,n){R(this,e),this.hasPendingWrites=t,this.fromCache=n}return O(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}();exports.SnapshotMetadata=jh;var zh=function(e){w(n,sh);var t=b(n);function n(e,r,i,a,u,o){var s;return R(this,n),(s=t.call(this,e,r,i,a,o))._firestore=e,s._firestoreImpl=e,s.metadata=u,s}return O(n,[{key:"exists",value:function(){return o(S(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(lh("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}();exports.DocumentSnapshot=zh;var Wh=function(e){w(n,zh);var t=b(n);function n(){return R(this,n),t.apply(this,arguments)}return O(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(S(n.prototype),"data",this).call(this,e)}}]),n}();exports.QueryDocumentSnapshot=Wh;var Hh=function(){function e(t,n,r,i){R(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new jh(i.hasPendingWrites,i.fromCache),this.query=r}return O(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new Wh(n._firestore,n._userDataWriter,r.key,r,new jh(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ee($.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){var r=new Wh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new Wh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Xh(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function Xh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}function Yh(e,t){return e instanceof zh&&t instanceof zh?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Hh&&t instanceof Hh&&e._firestore===t._firestore&&sf(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function Jh(e){e=Xl(e,ef);var t=Xl(e.firestore,df);return Vl(pf(t),e._key).then(function(n){return fd(t,e,n)})}exports.QuerySnapshot=Hh;var Zh=function(e){w(n,Vh);var t=b(n);function n(e){var r;return R(this,n),(r=t.call(this)).firestore=e,r}return O(n,[{key:"convertBytes",value:function(e){return new Cf(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ef(this.firestore,null,t)}}]),n}();function $h(e){e=Xl(e,ef);var t=Xl(e.firestore,df),n=pf(t),r=new Zh(t);return Ol(n,e._key).then(function(n){return new zh(t,r,e._key,n,new jh(null!==n&&n.hasLocalMutations,!0),e.converter)})}function ed(e){e=Xl(e,ef);var t=Xl(e.firestore,df);return Vl(pf(t),e._key,{source:"server"}).then(function(n){return fd(t,e,n)})}function td(e){e=Xl(e,tf);var t=Xl(e.firestore,df),n=pf(t),r=new Zh(t);return fh(e._query),ql(n,e._query).then(function(n){return new Hh(t,r,e,n)})}function nd(e){e=Xl(e,tf);var t=Xl(e.firestore,df),n=pf(t),r=new Zh(t);return Pl(n,e._query).then(function(n){return new Hh(t,r,e,n)})}function rd(e){e=Xl(e,tf);var t=Xl(e.firestore,df),n=pf(t),r=new Zh(t);return ql(n,e._query,{source:"server"}).then(function(n){return new Hh(t,r,e,n)})}function id(e,t,n){e=Xl(e,ef);var r=Xl(e.firestore,df),i=Ph(e.converter,t,n);return ld(r,[Gf(Kf(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,lr.none())])}function ad(e,t,n){e=Xl(e,ef);for(var r=Xl(e.firestore,df),i=Kf(r),u=arguments.length,o=new Array(u>3?u-3:0),s=3;s<u;s++)o[s-3]=arguments[s];return ld(r,[("string"==typeof(t=(0,a.getModularInstance)(t))||t instanceof Ff?Jf(i,"updateDoc",e._key,t,n,o):Yf(i,"updateDoc",e._key,t)).toMutation(e._key,lr.exists(!0))])}function ud(e){return ld(Xl(e.firestore,df),[new Er(e._key,lr.none())])}function od(e,t){var n=Xl(e.firestore,df),r=uf(e),i=Ph(e.converter,t);return ld(n,[Gf(Kf(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,lr.exists(!1))]).then(function(){return r})}function sd(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,u,o;e=(0,a.getModularInstance)(e);var s={includeMetadataChanges:!1},c=0;"object"!=L(n[c])||lf(n[c])||(s=n[c],c++);var l,f,h,d={includeMetadataChanges:s.includeMetadataChanges};if(lf(n[c])){var v=n[c];n[c]=null===(i=v.next)||void 0===i?void 0:i.bind(v),n[c+1]=null===(u=v.error)||void 0===u?void 0:u.bind(v),n[c+2]=null===(o=v.complete)||void 0===o?void 0:o.bind(v)}if(e instanceof ef)f=Xl(e.firestore,df),h=Nn(e._key.path),l={next:function(t){n[c]&&n[c](fd(f,e,t))},error:n[c+1],complete:n[c+2]};else{var y=Xl(e,tf);f=Xl(y.firestore,df),h=y._query;var p=new Zh(f);l={next:function(e){n[c]&&n[c](new Hh(f,p,y,e))},error:n[c+1],complete:n[c+2]},fh(e._query)}return function(e,t,n,r){var i=new vl(l),a=new nc(t,i,n);return e.asyncQueue.enqueueAndForget(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Xs,t.next=3,Fl(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.bc(),e.asyncQueue.enqueueAndForget(k(m().mark(function t(){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Js,t.next=3,Fl(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(pf(f),h,d)}function cd(e,t){return Ul(pf(e=Xl(e,df)),lf(t)?t:{next:t})}function ld(e,t){return function(e,t){var n=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function r(){return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=kc,r.next=3,Nl(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}(pf(e),t)}function fd(e,t,n){var r=n.docs.get(t._key),i=new Zh(e);return new zh(e,i,t._key,r,new jh(n.hasPendingWrites,n.fromCache),t.converter)}function hd(e){return dd(e,{count:Kh()})}function dd(e,t){var n=Xl(e.firestore,df),r=pf(n),i=function(e,t){var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,function(e,t){return new $e(new Ze(t),e._aggregateType,e._internalFieldPath)});return function(e,t,n){var r=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function i(){var a;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.t0=fs,i.next=4,Dl(e);case 4:if(i.t1=i.sent,!(0,i.t0)(i.t1)){i.next=12;break}return i.next=8,Cl(e);case 8:a=i.sent,r.resolve(Jo(a,t,n)),i.next=13;break;case 12:r.reject(new ee($.UNAVAILABLE,"Failed to get aggregate result because the client is offline."));case 13:i.next=18;break;case 15:i.prev=15,i.t2=i.catch(0),r.reject(i.t2);case 18:case"end":return i.stop()}},i,null,[[0,15]])}))),r.promise}(r,e._query,i).then(function(t){return function(e,t,n){var r=new Zh(e);return new Nf(t,r,n)}(n,e,t)})}var vd={maxAttempts:5},yd=function(){function e(t,n){R(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Kf(t)}return O(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=pd(e,this._firestore),i=Ph(r.converter,t,n),a=Gf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,lr.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=pd(e,this._firestore),u=arguments.length,o=new Array(u>3?u-3:0),s=3;s<u;s++)o[s-3]=arguments[s];return r="string"==typeof(t=(0,a.getModularInstance)(t))||t instanceof Ff?Jf(this._dataReader,"WriteBatch.update",i._key,t,n,o):Yf(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,lr.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=pd(e,this._firestore);return this._mutations=this._mutations.concat(new Er(t._key,lr.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new ee($.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function pd(e,t){if((e=(0,a.getModularInstance)(e)).firestore!==t)throw new ee($.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}exports.WriteBatch=yd;var md=function(e){w(n,e);var t=b(n);function n(e,r){var i;return R(this,n),(i=t.call(this,e,r))._firestore=e,i}return O(n,[{key:"get",value:function(e){var t=this,r=pd(e,this._firestore),i=new Zh(this._firestore);return o(S(n.prototype),"get",this).call(this,e).then(function(e){return new zh(t._firestore,i,r._key,e._document,new jh(!1,!1),r.converter)})}}]),n}(function(){function e(t,n){R(this,e),this._firestore=t,this._transaction=n,this._dataReader=Kf(t)}return O(e,[{key:"get",value:function(e){var t=this,n=pd(e,this._firestore),r=new qh(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return X();var i=e[0];if(i.isFoundDocument())return new sh(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new sh(t._firestore,r,n._key,null,n.converter);throw X()})}},{key:"set",value:function(e,t,n){var r=pd(e,this._firestore),i=Ph(r.converter,t,n),a=Gf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=pd(e,this._firestore),u=arguments.length,o=new Array(u>3?u-3:0),s=3;s<u;s++)o[s-3]=arguments[s];return r="string"==typeof(t=(0,a.getModularInstance)(t))||t instanceof Ff?Jf(this._dataReader,"Transaction.update",i._key,t,n,o):Yf(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=pd(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function gd(e,t,n){e=Xl(e,df);var r=Object.assign(Object.assign({},vd),n);return function(e){if(r.maxAttempts<1)throw new ee($.INVALID_ARGUMENT,"Max attempts must be at least 1")}(),function(e,t,n){var r=new te;return e.asyncQueue.enqueueAndForget(k(m().mark(function i(){var a;return m().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Cl(e);case 2:a=i.sent,new ml(e.asyncQueue,a,n,t,r).run();case 4:case"end":return i.stop()}},i)}))),r.promise}(pf(e),function(n){return t(new md(e,n))},r)}function kd(){return new Qf("deleteField")}function wd(){return new zf("serverTimestamp")}function xd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wf("arrayUnion",t)}function bd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Hf("arrayRemove",t)}function Id(e){return new Xf("increment",e)}function Td(e){return pf(e=Xl(e,df)),new yd(e,function(t){return ld(e,t)})}function Ed(e,t){var n,r=pf(e=Xl(e,df));if(!(null===(n=r.offlineComponents)||void 0===n?void 0:n.indexBackfillerScheduler))return W("Cannot enable indexes when persistence is disabled"),Promise.resolve();var i=function(e){var t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new ee($.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes)){var r,i=p(t.indexes);try{for(i.s();!(r=i.n()).done;){var a=r.value,u=Sd(a,"collectionGroup"),o=[];if(Array.isArray(a.fields)){var s,c=p(a.fields);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=ah("setIndexConfiguration",Sd(l,"fieldPath"));"CONTAINS"===l.arrayConfig?o.push(new _e(f,2)):"ASCENDING"===l.order?o.push(new _e(f,0)):"DESCENDING"===l.order&&o.push(new _e(f,1))}}catch(h){c.e(h)}finally{c.f()}}n.push(new Ie(Ie.UNKNOWN_ID,u,o,De.empty()))}}catch(h){i.e(h)}finally{i.f()}}return n}(t);return Al(r).then(function(e){return(t=k(m().mark(function e(t,n){var r,i,a;return m().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z(t),i=r.indexManager,a=[],e.abrupt("return",r.persistence.runTransaction("Configure indexes","readwrite",function(e){return i.getFieldIndexes(e).next(function(t){return function(e,t,n,r,i){e=_(e),t=_(t),e.sort(n),t.sort(n);for(var a=e.length,u=t.length,o=0,s=0;o<u&&s<a;){var c=n(e[s],t[o]);c<0?i(e[s++]):c>0?r(t[o++]):(o++,s++)}for(;o<u;)r(t[o++]);for(;s<a;)i(e[s++])}(t,n,Se,function(t){a.push(i.addFieldIndex(e,t))},function(t){a.push(i.deleteFieldIndex(e,t))})}).next(function(){return Pe.waitFor(a)})}));case 2:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)})(e,i);var t})}function Sd(e,t){if("string"!=typeof e[t])throw new ee($.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}exports.Transaction=md,function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){B=e}(n.SDK_VERSION),(0,n._registerComponent)(new r.Component("firestore",function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),u=new df(new ae(e.getProvider("auth-internal")),new ce(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ee($.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tt(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),u._setSettings(i),u},"PUBLIC").setMultipleInstances(!0)),(0,n.registerVersion)(q,"3.9.0",e),(0,n.registerVersion)(q,"3.9.0","esm2017")}();
},{"@firebase/app":"qn02","@firebase/component":"bXWY","@firebase/logger":"uNCT","@firebase/util":"VOc0","@firebase/webchannel-wrapper":"ygBT","process":"g5IB"}],"R6ck":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/firestore");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/firestore":"TIij"}],"zPhD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._UploadTask=exports._TaskState=exports._TaskEvent=exports._Location=exports._FbsBlob=exports.StringFormat=exports.StorageErrorCode=exports.StorageError=void 0,exports._dataFromString=oe,exports._getChild=Kt,exports._invalidArgument=O,exports._invalidRootOperation=A,exports.connectStorageEmulator=Jt,exports.deleteObject=Xt,exports.getBlob=Yt,exports.getBytes=Bt,exports.getDownloadURL=Wt,exports.getMetadata=zt,exports.getStorage=Zt,exports.getStream=Qt,exports.list=Vt,exports.listAll=Gt,exports.ref=$t,exports.updateMetadata=jt,exports.uploadBytes=qt,exports.uploadBytesResumable=Ht,exports.uploadString=Ft;var e=require("@firebase/app"),t=require("@firebase/util"),n=require("@firebase/component");const r="firebasestorage.googleapis.com",s="storageBucket",o=12e4,i=6e5,a=1e3;class u extends t.FirebaseError{constructor(e,t,n=0){super(h(e),`Firebase Storage: ${t} (${h(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,u.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return h(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var c,l;function h(e){return"storage/"+e}function d(){return new u(c.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function _(e){return new u(c.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function p(e){return new u(c.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function f(){return new u(c.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function g(){return new u(c.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function m(e){return new u(c.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function b(){return new u(c.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function T(){return new u(c.CANCELED,"User canceled the upload/download.")}function R(e){return new u(c.INVALID_URL,"Invalid URL '"+e+"'.")}function w(e){return new u(c.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function k(){return new u(c.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+s+"' property when initializing the app?")}function E(){return new u(c.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function v(){return new u(c.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function y(){return new u(c.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function x(e){return new u(c.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function O(e){return new u(c.INVALID_ARGUMENT,e)}function U(){return new u(c.APP_DELETED,"The Firebase app was deleted.")}function A(e){return new u(c.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function C(e,t){return new u(c.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function S(e){throw new u(c.INTERNAL_ERROR,"Internal error: "+e)}exports.StorageError=u,exports.StorageErrorCode=c,function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(c||(exports.StorageErrorCode=c={}));class I{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=I.makeFromUrl(e,t)}catch(r){return new I(e,"")}if(""===n.path)return n;throw w(e)}static makeFromUrl(e,t){let n=null;const s=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),a=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${i}/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp(`^https?://${t===r?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/([A-Za-z0-9.\\-_]+)/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:o}];for(let r=0;r<a.length;r++){const t=a[r],s=t.regex.exec(e);if(s){const e=s[t.indices.bucket];let r=s[t.indices.path];r||(r=""),n=new I(e,r),t.postModify(n);break}}if(null==n)throw R(e);return n}}exports._Location=I;class N{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function P(e,t,n){let r=1,s=null,o=null,i=!1,a=0;function u(){return 2===a}let c=!1;function l(...e){c||(c=!0,t.apply(null,e))}function h(t){s=setTimeout(()=>{s=null,e(_,u())},t)}function d(){o&&clearTimeout(o)}function _(e,...t){if(c)return void d();if(e)return d(),void l.call(null,e,...t);if(u()||i)return d(),void l.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),h(n)}let p=!1;function f(e){p||(p=!0,d(),c||(null!==s?(e||(a=2),clearTimeout(s),h(0)):e||(a=1)))}return h(0),o=setTimeout(()=>{i=!0,f(!0)},n),f}function D(e){e(!1)}function L(e){return void 0!==e}function M(e){return"function"==typeof e}function B(e){return"object"==typeof e&&!Array.isArray(e)}function q(e){return"string"==typeof e||e instanceof String}function F(e){return H()&&e instanceof Blob}function H(){return"undefined"!=typeof Blob&&!(0,t.isNode)()}function z(e,t,n,r){if(r<t)throw O(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw O(`Invalid value for '${e}'. Expected ${n} or less.`)}function j(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function V(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function G(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(l||(l={}));class W{constructor(e,t,n,r,s,o,i,a,u,c,l,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=i,this.errorCallback_=a,this.timeout_=u,this.progressCallback_=c,this.connectionFactory_=l,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new X(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===l.NO_ERROR,s=n.getStatus();if(!t||G(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===l.ABORT;return void e(!1,new X(!1,null,t))}const o=-1!==this.successCodes_.indexOf(s);e(!0,new X(o,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());L(e)?n(e):n()}catch(o){r(o)}else if(null!==s){const e=d();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?U():T())}else{r(b())}};this.canceled_?t(0,new X(!1,null,!0)):this.backoffId_=P(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&D(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class X{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function $(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function K(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}function Z(e,t){t&&(e["X-Firebase-GMPID"]=t)}function J(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function Y(e,t,n,r,s,o,i=!0){const a=V(e.urlParams),u=e.url+a,c=Object.assign({},e.headers);return Z(c,t),$(c,n),K(c,o),J(c,r),new W(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}function Q(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function ee(...e){const t=Q();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(H())return new Blob(e);throw new u(c.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function te(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}function ne(e){if("undefined"==typeof atob)throw x("base-64");return atob(e)}const re={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};exports.StringFormat=re;class se{constructor(e,t){this.data=e,this.contentType=t||null}}function oe(e,t){switch(e){case re.RAW:return new se(ie(t));case re.BASE64:case re.BASE64URL:return new se(ue(e,t));case re.DATA_URL:return new se(le(t),he(t))}throw d()}function ie(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function ae(e){let t;try{t=decodeURIComponent(e)}catch(n){throw C(re.DATA_URL,"Malformed data URL.")}return ie(t)}function ue(e,t){switch(e){case re.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw C(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case re.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw C(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ne(t)}catch(s){if(s.message.includes("polyfill"))throw s;throw C(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}class ce{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw C(re.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=de(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}function le(e){const t=new ce(e);return t.base64?ue(re.BASE64,t.rest):ae(t.rest)}function he(e){return new ce(e).contentType}function de(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}class _e{constructor(e,t){let n=0,r="";F(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(F(this.data_)){const n=te(this.data_,e,t);return null===n?null:new _e(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new _e(n,!0)}}static getBlob(...e){if(H()){const t=e.map(e=>e instanceof _e?e.data_:e);return new _e(ee.apply(null,t))}{const t=e.map(e=>q(e)?oe(re.RAW,e).data:e.data_);let n=0;t.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let s=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]}),new _e(r,!0)}}uploadData(){return this.data_}}function pe(e){let t;try{t=JSON.parse(e)}catch(n){return null}return B(t)?t:null}function fe(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}function ge(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}function me(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function be(e,t){return t}exports._FbsBlob=_e;class Te{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||be}}let Re=null;function we(e){return!q(e)||e.length<2?e:me(e)}function ke(){if(Re)return Re;const e=[];e.push(new Te("bucket")),e.push(new Te("generation")),e.push(new Te("metageneration")),e.push(new Te("name","fullPath",!0));const t=new Te("name");t.xform=function(e,t){return we(t)},e.push(t);const n=new Te("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Te("timeCreated")),e.push(new Te("updated")),e.push(new Te("md5Hash",null,!0)),e.push(new Te("cacheControl",null,!0)),e.push(new Te("contentDisposition",null,!0)),e.push(new Te("contentEncoding",null,!0)),e.push(new Te("contentLanguage",null,!0)),e.push(new Te("contentType",null,!0)),e.push(new Te("metadata","customMetadata",!0)),Re=e}function Ee(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new I(n,r);return t._makeStorageReference(s)}})}function ve(e,t,n){const r={type:"file"},s=n.length;for(let o=0;o<s;o++){const e=n[o];r[e.local]=e.xform(r,t[e.server])}return Ee(r,e),r}function ye(e,t,n){const r=pe(t);return null===r?null:ve(e,r,n)}function xe(e,t,n,r){const s=pe(t);if(null===s)return null;if(!q(s.downloadTokens))return null;const o=s.downloadTokens;if(0===o.length)return null;const i=encodeURIComponent;return o.split(",").map(t=>{const s=e.bucket,o=e.fullPath;return j("/b/"+i(s)+"/o/"+i(o),n,r)+V({alt:"media",token:t})})[0]}function Oe(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}const Ue="prefixes",Ae="items";function Ce(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Ue])for(const s of n[Ue]){const n=s.replace(/\/$/,""),o=e._makeStorageReference(new I(t,n));r.prefixes.push(o)}if(n[Ae])for(const s of n[Ae]){const n=e._makeStorageReference(new I(t,s.name));r.items.push(n)}return r}function Se(e,t,n){const r=pe(n);return null===r?null:Ce(e,t,r)}class Ie{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ne(e){if(!e)throw d()}function Pe(e,t){return function(n,r){const s=ye(e,r,t);return Ne(null!==s),s}}function De(e,t){return function(n,r){const s=Se(e,t,r);return Ne(null!==s),s}}function Le(e,t){return function(n,r){const s=ye(e,r,t);return Ne(null!==s),xe(s,r,e.host,e._protocol)}}function Me(e){return function(t,n){let r;return(r=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?g():f():402===t.getStatus()?p(e.bucket):403===t.getStatus()?m(e.path):n).status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Be(e){const t=Me(e);return function(n,r){let s=t(n,r);return 404===n.getStatus()&&(s=_(e.path)),s.serverResponse=r.serverResponse,s}}function qe(e,t,n){const r=j(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,o=new Ie(r,"GET",Pe(e,n),s);return o.errorHandler=Be(t),o}function Fe(e,t,n,r,s){const o={};t.isRoot?o.prefix="":o.prefix=t.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),s&&(o.maxResults=s);const i=j(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,u=new Ie(i,"GET",De(e,t.bucket),a);return u.urlParams=o,u.errorHandler=Me(t),u}function He(e,t,n){const r=j(t.fullServerUrl(),e.host,e._protocol)+"?alt=media",s=e.maxOperationRetryTime,o=new Ie(r,"GET",(e,t)=>t,s);return o.errorHandler=Be(t),void 0!==n&&(o.headers.Range=`bytes=0-${n}`,o.successCodes=[200,206]),o}function ze(e,t,n){const r=j(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,o=new Ie(r,"GET",Le(e,n),s);return o.errorHandler=Be(t),o}function je(e,t,n,r){const s=j(t.fullServerUrl(),e.host,e._protocol),o=Oe(n,r),i=e.maxOperationRetryTime,a=new Ie(s,"PATCH",Pe(e,r),i);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=Be(t),a}function Ve(e,t){const n=j(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime;const s=new Ie(n,"DELETE",function(e,t){},r);return s.successCodes=[200,204],s.errorHandler=Be(t),s}function Ge(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function We(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=Ge(null,t)),r}function Xe(e,t,n,r,s){const o=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+a;const u=We(t,r,s),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Oe(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=_e.getBlob(c,r,l);if(null===h)throw E();const d={name:u.fullPath},_=j(o,e.host,e._protocol),p=e.maxUploadRetryTime,f=new Ie(_,"POST",Pe(e,n),p);return f.urlParams=d,f.headers=i,f.body=h.uploadData(),f.errorHandler=Me(t),f}class $e{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function Ke(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){Ne(!1)}return Ne(!!n&&-1!==(t||["active"]).indexOf(n)),n}function Ze(e,t,n,r,s){const o=t.bucketOnlyServerUrl(),i=We(t,r,s),a={name:i.fullPath},u=j(o,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":i.contentType,"Content-Type":"application/json; charset=utf-8"},l=Oe(i,n),h=e.maxUploadRetryTime;const d=new Ie(u,"POST",function(e){let t;Ke(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){Ne(!1)}return Ne(q(t)),t},h);return d.urlParams=a,d.headers=c,d.body=l,d.errorHandler=Me(t),d}function Je(e,t,n,r){const s=e.maxUploadRetryTime,o=new Ie(n,"POST",function(e){const t=Ke(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){Ne(!1)}n||Ne(!1);const s=Number(n);return Ne(!isNaN(s)),new $e(s,r.size(),"final"===t)},s);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Me(t),o}const Ye=262144;function Qe(e,t,n,r,s,o,i,a){const u=new $e(0,0);if(i?(u.current=i.current,u.total=i.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw v();const c=u.total-u.current;let l=c;s>0&&(l=Math.min(l,s));const h=u.current,d=h+l;let _="";const p={"X-Goog-Upload-Command":_=0===l?"finalize":c===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${u.current}`},f=r.slice(h,d);if(null===f)throw E();const g=t.maxUploadRetryTime,m=new Ie(n,"POST",function(e,n){const s=Ke(e,["active","final"]),i=u.current+l,a=r.size();let c;return c="final"===s?Pe(t,o)(e,n):null,new $e(i,a,"final"===s,c)},g);return m.headers=p,m.body=f.uploadData(),m.progressCallback=a||null,m.errorHandler=Me(e),m}const et={STATE_CHANGED:"state_changed"};exports._TaskEvent=et;const tt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function nt(e){switch(e){case"running":case"pausing":case"canceling":return tt.RUNNING;case"paused":return tt.PAUSED;case"success":return tt.SUCCESS;case"canceled":return tt.CANCELED;case"error":default:return tt.ERROR}}exports._TaskState=tt;class rt{constructor(e,t,n){if(M(e)||null!=t||null!=n)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function st(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}let ot=null;class it{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=l.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=l.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=l.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw S("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw S("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw S("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw S("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw S("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class at extends it{initXhr(){this.xhr_.responseType="text"}}function ut(){return ot?ot():new at}class ct extends it{initXhr(){this.xhr_.responseType="arraybuffer"}}function lt(){return new ct}class ht extends it{initXhr(){this.xhr_.responseType="blob"}}function dt(){return new ht}class _t{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=ke(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=(e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(c.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(G(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,a),this._needToFetchStatus=!0,void this.completeTransitions_();e=b()}this._error=e,this._transition("error")}}),this._metadataErrorHandler=(e=>{this._request=void 0,e._codeEquals(c.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))}),this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const n=Ze(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ut,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const r=Je(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,ut,t,n);this._request=s,s.getPromise().then(e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Ye*this._chunkMultiplier,t=new $e(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=Qe(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(a){return this._error=a,void this._transition("error")}const i=this._ref.storage._makeRequest(o,ut,r,s,!1);this._request=i,i.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){2*(Ye*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=qe(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,ut,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=Xe(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ut,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=T(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=nt(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const s=new rt(t||void 0,n||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(nt(this._state)){case tt.SUCCESS:st(this._resolve.bind(null,this.snapshot))();break;case tt.CANCELED:case tt.ERROR:st(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(nt(this._state)){case tt.RUNNING:case tt.PAUSED:e.next&&st(e.next.bind(e,this.snapshot))();break;case tt.SUCCESS:e.complete&&st(e.complete.bind(e))();break;case tt.CANCELED:case tt.ERROR:e.error&&st(e.error.bind(e,this._error))();break;default:e.error&&st(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}exports._UploadTask=_t;class pt{constructor(e,t){this._service=e,this._location=t instanceof I?t:I.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new pt(e,t)}get root(){const e=new I(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return me(this._location.path)}get storage(){return this._service}get parent(){const e=fe(this._location.path);if(null===e)return null;const t=new I(this._location.bucket,e);return new pt(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw A(e)}}function ft(e,t){e._throwIfRoot("getBytes");const n=He(e.storage,e._location,t);return e.storage.makeRequestWithTokens(n,lt).then(e=>void 0!==t?e.slice(0,t):e)}function gt(e,t){e._throwIfRoot("getBlob");const n=He(e.storage,e._location,t);return e.storage.makeRequestWithTokens(n,dt).then(e=>void 0!==t?e.slice(0,t):e)}function mt(e,t,n){e._throwIfRoot("uploadBytes");const r=Xe(e.storage,e._location,ke(),new _e(t,!0),n);return e.storage.makeRequestWithTokens(r,ut).then(t=>({metadata:t,ref:e}))}function bt(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new _t(e,new _e(t),n)}function Tt(e,t,n=re.RAW,r){e._throwIfRoot("uploadString");const s=oe(n,t),o=Object.assign({},r);return null==o.contentType&&null!=s.contentType&&(o.contentType=s.contentType),mt(e,s.data,o)}function Rt(e){const t={prefixes:[],items:[]};return wt(e,t).then(()=>t)}async function wt(e,t,n){const r={pageToken:n},s=await kt(e,r);t.prefixes.push(...s.prefixes),t.items.push(...s.items),null!=s.nextPageToken&&await wt(e,t,s.nextPageToken)}function kt(e,t){null!=t&&"number"==typeof t.maxResults&&z("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=Fe(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,ut)}function Et(e){e._throwIfRoot("getMetadata");const t=qe(e.storage,e._location,ke());return e.storage.makeRequestWithTokens(t,ut)}function vt(e,t){e._throwIfRoot("updateMetadata");const n=je(e.storage,e._location,t,ke());return e.storage.makeRequestWithTokens(n,ut)}function yt(e){e._throwIfRoot("getDownloadURL");const t=ze(e.storage,e._location,ke());return e.storage.makeRequestWithTokens(t,ut).then(e=>{if(null===e)throw y();return e})}function xt(e){e._throwIfRoot("deleteObject");const t=Ve(e.storage,e._location);return e.storage.makeRequestWithTokens(t,ut)}function Ot(e,t){const n=ge(e._location.path,t),r=new I(e._location.bucket,n);return new pt(e.storage,r)}function Ut(e){return/^[A-Za-z]+:\/\//.test(e)}function At(e,t){return new pt(e,t)}function Ct(e,t){if(e instanceof Pt){const n=e;if(null==n._bucket)throw k();const r=new pt(n,n._bucket);return null!=t?Ct(r,t):r}return void 0!==t?Ot(e,t):e}function St(e,t){if(t&&Ut(t)){if(e instanceof Pt)return At(e,t);throw O("To use ref(service, url), the first argument must be a Storage instance.")}return Ct(e,t)}function It(e,t){const n=null==t?void 0:t[s];return null==n?null:I.makeFromBucketSpec(n,e)}function Nt(e,n,r,s={}){e.host=`${n}:${r}`,e._protocol="http";const{mockUserToken:o}=s;o&&(e._overrideAuthToken="string"==typeof o?o:(0,t.createMockUserToken)(o,e.app.options.projectId))}class Pt{constructor(e,t,n,s,a){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=r,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=o,this._maxUploadRetryTime=i,this._requests=new Set,this._bucket=null!=s?I.makeFromBucketSpec(s,this._host):It(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=I.makeFromBucketSpec(this._url,e):this._bucket=It(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){z("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){z("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new pt(this,e)}_makeRequest(e,t,n,r,s=!0){if(this._deleted)return new N(U());{const o=Y(e,this._appId,n,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Dt="@firebase/storage",Lt="0.11.2",Mt="storage";function Bt(e,n){return ft(e=(0,t.getModularInstance)(e),n)}function qt(e,n,r){return mt(e=(0,t.getModularInstance)(e),n,r)}function Ft(e,n,r,s){return Tt(e=(0,t.getModularInstance)(e),n,r,s)}function Ht(e,n,r){return bt(e=(0,t.getModularInstance)(e),n,r)}function zt(e){return Et(e=(0,t.getModularInstance)(e))}function jt(e,n){return vt(e=(0,t.getModularInstance)(e),n)}function Vt(e,n){return kt(e=(0,t.getModularInstance)(e),n)}function Gt(e){return Rt(e=(0,t.getModularInstance)(e))}function Wt(e){return yt(e=(0,t.getModularInstance)(e))}function Xt(e){return xt(e=(0,t.getModularInstance)(e))}function $t(e,n){return St(e=(0,t.getModularInstance)(e),n)}function Kt(e,t){return Ot(e,t)}function Zt(n=(0,e.getApp)(),r){n=(0,t.getModularInstance)(n);const s=(0,e._getProvider)(n,Mt).getImmediate({identifier:r}),o=(0,t.getDefaultEmulatorHostnameAndPort)("storage");return o&&Jt(s,...o),s}function Jt(e,t,n,r={}){Nt(e,t,n,r)}function Yt(e,n){return gt(e=(0,t.getModularInstance)(e),n)}function Qt(e,t){throw new Error("getStream() is only supported by NodeJS builds")}function en(t,{instanceIdentifier:n}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Pt(r,s,o,n,e.SDK_VERSION)}function tn(){(0,e._registerComponent)(new n.Component(Mt,en,"PUBLIC").setMultipleInstances(!0)),(0,e.registerVersion)(Dt,Lt,""),(0,e.registerVersion)(Dt,Lt,"esm2017")}tn();
},{"@firebase/app":"qn02","@firebase/util":"VOc0","@firebase/component":"bXWY"}],"pIUw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/storage");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/storage":"zPhD"}],"kvTz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteInstallations=bt,exports.getId=gt,exports.getInstallations=St,exports.getToken=wt,exports.onIdChange=Ct;var t=require("@firebase/app"),e=require("@firebase/component"),n=require("@firebase/util"),a=require("idb");const i="@firebase/installations",r="0.6.4",o=1e4,s="w:0.6.4",u="FIS_v2",c="https://firebaseinstallations.googleapis.com/v1",f=36e5,p="installations",l="Installations",d={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},g=new n.ErrorFactory(p,l,d);function w(t){return t instanceof n.FirebaseError&&t.code.includes("request-failed")}function m({projectId:t}){return`${c}/projects/${t}/installations`}function h(t){return{token:t.token,requestStatus:2,expiresIn:v(t.expiresIn),creationTime:Date.now()}}async function y(t,e){const n=(await e.json()).error;return g.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function b({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function C(t,{refreshToken:e}){const n=b(t);return n.append("Authorization",I(e)),n}async function S(t){const e=await t();return e.status>=500&&e.status<600?t():e}function v(t){return Number(t.replace("s","000"))}function I(t){return`${u} ${t}`}async function T({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const a=m(t),i=b(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const o={fid:n,authVersion:u,appId:t.appId,sdkVersion:s},c={method:"POST",headers:i,body:JSON.stringify(o)},f=await S(()=>fetch(a,c));if(f.ok){const t=await f.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:h(t.authToken)}}throw await y("Create Installation",f)}function k(t){return new Promise(e=>{setTimeout(e,t)})}function j(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}const P=/^[cdef][\w-]{21}$/,q="";function $(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const n=E(e);return P.test(n)?n:q}catch(t){return q}}function E(t){return j(t).substr(0,22)}function O(t){return`${t.appName}!${t.appId}`}const D=new Map;function x(t,e){const n=O(t);_(n,e),F(n,e)}function A(t,e){M();const n=O(t);let a=D.get(n);a||(a=new Set,D.set(n,a)),a.add(e)}function N(t,e){const n=O(t),a=D.get(n);a&&(a.delete(e),0===a.size&&D.delete(n),H())}function _(t,e){const n=D.get(t);if(n)for(const a of n)a(e)}function F(t,e){const n=M();n&&n.postMessage({key:t,fid:e}),H()}let V=null;function M(){return!V&&"BroadcastChannel"in self&&((V=new BroadcastChannel("[Firebase] FID Change")).onmessage=(t=>{_(t.data.key,t.data.fid)})),V}function H(){0===D.size&&V&&(V.close(),V=null)}const L="firebase-installations-database",B=1,K="firebase-installations-store";let z=null;function J(){return z||(z=(0,a.openDB)(L,B,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(K)}}})),z}async function R(t,e){const n=O(t),a=(await J()).transaction(K,"readwrite"),i=a.objectStore(K),r=await i.get(n);return await i.put(e,n),await a.done,r&&r.fid===e.fid||x(t,e.fid),e}async function U(t){const e=O(t),n=(await J()).transaction(K,"readwrite");await n.objectStore(K).delete(e),await n.done}async function G(t,e){const n=O(t),a=(await J()).transaction(K,"readwrite"),i=a.objectStore(K),r=await i.get(n),o=e(r);return void 0===o?await i.delete(n):await i.put(o,n),await a.done,!o||r&&r.fid===o.fid||x(t,o.fid),o}async function Q(t){let e;const n=await G(t.appConfig,n=>{const a=W(n),i=X(t,a);return e=i.registrationPromise,i.installationEntry});return n.fid===q?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function W(t){return et(t||{fid:$(),registrationStatus:0})}function X(t,e){if(0===e.registrationStatus){if(!navigator.onLine){return{installationEntry:e,registrationPromise:Promise.reject(g.create("app-offline"))}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:Y(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Z(t)}:{installationEntry:e}}async function Y(t,e){try{const a=await T(t,e);return R(t.appConfig,a)}catch(n){throw w(n)&&409===n.customData.serverCode?await U(t.appConfig):await R(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Z(t){let e=await tt(t.appConfig);for(;1===e.registrationStatus;)await k(100),e=await tt(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await Q(t);return n||e}return e}function tt(t){return G(t,t=>{if(!t)throw g.create("installation-not-found");return et(t)})}function et(t){return nt(t)?{fid:t.fid,registrationStatus:0}:t}function nt(t){return 1===t.registrationStatus&&t.registrationTime+o<Date.now()}async function at({appConfig:t,heartbeatServiceProvider:e},n){const a=it(t,n),i=C(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&i.append("x-firebase-client",t)}const o={installation:{sdkVersion:s,appId:t.appId}},u={method:"POST",headers:i,body:JSON.stringify(o)},c=await S(()=>fetch(a,u));if(c.ok){return h(await c.json())}throw await y("Generate Auth Token",c)}function it(t,{fid:e}){return`${m(t)}/${e}/authTokens:generate`}async function rt(t,e=!1){let n;const a=await G(t.appConfig,a=>{if(!ct(a))throw g.create("not-registered");const i=a.authToken;if(!e&&ft(i))return a;if(1===i.requestStatus)return n=ot(t,e),a;{if(!navigator.onLine)throw g.create("app-offline");const e=lt(a);return n=ut(t,e),e}});return n?await n:a.authToken}async function ot(t,e){let n=await st(t.appConfig);for(;1===n.authToken.requestStatus;)await k(100),n=await st(t.appConfig);const a=n.authToken;return 0===a.requestStatus?rt(t,e):a}function st(t){return G(t,t=>{if(!ct(t))throw g.create("not-registered");return dt(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function ut(t,e){try{const a=await at(t,e),i=Object.assign(Object.assign({},e),{authToken:a});return await R(t.appConfig,i),a}catch(n){if(!w(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await R(t.appConfig,n)}else await U(t.appConfig);throw n}}function ct(t){return void 0!==t&&2===t.registrationStatus}function ft(t){return 2===t.requestStatus&&!pt(t)}function pt(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+f}function lt(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function dt(t){return 1===t.requestStatus&&t.requestTime+o<Date.now()}async function gt(t){const e=t,{installationEntry:n,registrationPromise:a}=await Q(e);return a?a.catch(console.error):rt(e).catch(console.error),n.fid}async function wt(t,e=!1){const n=t;return await mt(n),(await rt(n,e)).token}async function mt(t){const{registrationPromise:e}=await Q(t);e&&await e}async function ht(t,e){const n=yt(t,e),a={method:"DELETE",headers:C(t,e)},i=await S(()=>fetch(n,a));if(!i.ok)throw await y("Delete Installation",i)}function yt(t,{fid:e}){return`${m(t)}/${e}`}async function bt(t){const{appConfig:e}=t,n=await G(e,t=>{if(!t||0!==t.registrationStatus)return t});if(n){if(1===n.registrationStatus)throw g.create("delete-pending-registration");if(2===n.registrationStatus){if(!navigator.onLine)throw g.create("app-offline");await ht(e,n),await U(e)}}}function Ct(t,e){const{appConfig:n}=t;return A(n,e),()=>{N(n,e)}}function St(e=(0,t.getApp)()){return(0,t._getProvider)(e,"installations").getImmediate()}function vt(t){if(!t||!t.options)throw It("App Configuration");if(!t.name)throw It("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw It(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function It(t){return g.create("missing-app-config-values",{valueName:t})}const Tt="installations",kt="installations-internal",jt=e=>{const n=e.getProvider("app").getImmediate();return{app:n,appConfig:vt(n),heartbeatServiceProvider:(0,t._getProvider)(n,"heartbeat"),_delete:()=>Promise.resolve()}},Pt=e=>{const n=e.getProvider("app").getImmediate(),a=(0,t._getProvider)(n,Tt).getImmediate();return{getId:()=>gt(a),getToken:t=>wt(a,t)}};function qt(){(0,t._registerComponent)(new e.Component(Tt,jt,"PUBLIC")),(0,t._registerComponent)(new e.Component(kt,Pt,"PRIVATE"))}qt(),(0,t.registerVersion)(i,"0.6.4"),(0,t.registerVersion)(i,"0.6.4","esm2017");
},{"@firebase/app":"qn02","@firebase/component":"bXWY","@firebase/util":"VOc0","idb":"ZUep"}],"LjKA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAnalytics=te,exports.initializeAnalytics=ne,exports.isSupported=ae,exports.logEvent=le,exports.setAnalyticsCollectionEnabled=se,exports.setConsent=de,exports.setCurrentScreen=ie,exports.setDefaultEventParameters=ce,exports.setUserId=re,exports.setUserProperties=oe,exports.settings=Y;var e=require("@firebase/app"),t=require("@firebase/logger"),n=require("@firebase/util"),a=require("@firebase/component");require("@firebase/installations");const i="analytics",r="firebase_id",o="origin",s=6e4,c="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",l="https://www.googletagmanager.com/gtag/js",d=new t.Logger("@firebase/analytics");function u(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function p(e,t){const n=document.createElement("script");n.src=`${l}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}function f(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function m(e,t,n,a,i,r){const o=a[i];try{if(o)await t[o];else{const e=(await u(n)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(s){d.error(s)}e("config",i,r)}async function h(e,t,n,a,i){try{let o=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const a=await u(n);for(const n of e){const e=a.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){o=[];break}o.push(i)}}0===o.length&&(o=Object.values(t)),await Promise.all(o),e("event",a,i||{})}catch(r){d.error(r)}}function g(e,t,n,a){return async function(i,r,o){try{"event"===i?await h(e,t,n,r,o):"config"===i?await m(e,t,n,a,r,o):"consent"===i?e("consent","update",o):e("set",r)}catch(s){d.error(s)}}}function y(e,t,n,a,i){let r=function(...e){window[a].push(arguments)};return window[i]&&"function"==typeof window[i]&&(r=window[i]),window[i]=g(r,e,t,n),{gtagCore:r,wrappedGtag:window[i]}}function w(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(l)&&n.src.includes(e))return n;return null}const I={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},b=new n.ErrorFactory("analytics","Analytics",I),v=30,x=1e3;class M{constructor(e={},t=x){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const D=new M;function T(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function A(e){var t;const{appId:n,apiKey:a}=e,i={method:"GET",headers:T(a)},r=c.replace("{app-id}",n),o=await fetch(r,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(s){}throw b.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}async function F(e,t=D,n){const{appId:a,apiKey:i,measurementId:r}=e.options;if(!a)throw b.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:a};throw b.create("no-api-key")}const o=t.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new k;return setTimeout(async()=>{c.abort()},void 0!==n?n:s),E({appId:a,apiKey:i,measurementId:r},o,c,t)}async function E(e,{throttleEndTimeMillis:t,backoffCount:a},i,r=D){var o;const{appId:s,measurementId:c}=e;try{await $(i,t)}catch(l){if(c)return d.warn("Timed out fetching this Firebase app's measurement ID from the server."+` Falling back to the measurement ID ${c}`+` provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:s,measurementId:c};throw l}try{const t=await A(e);return r.deleteThrottleMetadata(s),t}catch(l){const t=l;if(!C(t)){if(r.deleteThrottleMetadata(s),c)return d.warn("Failed to fetch this Firebase app's measurement ID from the server."+` Falling back to the measurement ID ${c}`+` provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:s,measurementId:c};throw l}const u=503===Number(null===(o=null==t?void 0:t.customData)||void 0===o?void 0:o.httpStatus)?(0,n.calculateBackoffMillis)(a,r.intervalMillis,v):(0,n.calculateBackoffMillis)(a,r.intervalMillis),p={throttleEndTimeMillis:Date.now()+u,backoffCount:a+1};return r.setThrottleMetadata(s,p),d.debug(`Calling attemptFetch again in ${u} millis`),E(e,p,i,r)}}function $(e,t){return new Promise((n,a)=>{const i=Math.max(t-Date.now(),0),r=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(r),a(b.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function C(e){if(!(e instanceof n.FirebaseError&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}class k{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let P,_;async function z(e,t,n,a,i){if(i&&i.global)e("event",n,a);else{const i=await t;e("event",n,Object.assign(Object.assign({},a),{send_to:i}))}}async function j(e,t,n,a){if(a&&a.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}async function B(e,t,n,a){if(a&&a.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}async function q(e,t,n,a){if(a&&a.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}async function O(e,t){const n=await e;window[`ga-disable-${n}`]=!t}function S(e){_=e}function L(e){P=e}async function N(){if(!(0,n.isIndexedDBAvailable)())return d.warn(b.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,n.validateIndexedDBOpenable)()}catch(e){return d.warn(b.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}async function K(e,t,n,a,i,s,c){var l;const u=F(e);u.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&d.warn(`The measurement ID in the local Firebase config (${e.options.measurementId})`+` does not match the measurement ID fetched from the server (${t.measurementId}).`+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>d.error(e)),t.push(u);const f=N().then(e=>e?a.getId():void 0),[m,h]=await Promise.all([u,f]);w(s)||p(s,m.measurementId),_&&(i("consent","default",_),S(void 0)),i("js",new Date);const g=null!==(l=null==c?void 0:c.config)&&void 0!==l?l:{};return g[o]="firebase",g.update=!0,null!=h&&(g[r]=h),i("config",m.measurementId,g),P&&(i("set",P),L(void 0)),m.measurementId}class U{constructor(e){this.app=e}_delete(){return delete G[this.app.options.appId],Promise.resolve()}}let G={},V=[];const W={};let H,R,J="dataLayer",Q="gtag",X=!1;function Y(e){if(X)throw b.create("already-initialized");e.dataLayerName&&(J=e.dataLayerName),e.gtagName&&(Q=e.gtagName)}function Z(){const e=[];if((0,n.isBrowserExtension)()&&e.push("This is a browser extension environment."),(0,n.areCookiesEnabled)()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=b.create("invalid-analytics-context",{errorInfo:t});d.warn(n.message)}}function ee(e,t,n){Z();const a=e.options.appId;if(!a)throw b.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw b.create("no-api-key");d.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+` measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId}`+' provided in the "measurementId" field in the local Firebase config.')}if(null!=G[a])throw b.create("already-exists",{id:a});if(!X){f(J);const{wrappedGtag:e,gtagCore:t}=y(G,V,W,J,Q);R=e,H=t,X=!0}return G[a]=K(e,V,W,t,H,J,n),new U(e)}function te(t=(0,e.getApp)()){t=(0,n.getModularInstance)(t);const a=(0,e._getProvider)(t,i);return a.isInitialized()?a.getImmediate():ne(t)}function ne(t,a={}){const r=(0,e._getProvider)(t,i);if(r.isInitialized()){const e=r.getImmediate();if((0,n.deepEqual)(a,r.getOptions()))return e;throw b.create("already-initialized")}return r.initialize({options:a})}async function ae(){if((0,n.isBrowserExtension)())return!1;if(!(0,n.areCookiesEnabled)())return!1;if(!(0,n.isIndexedDBAvailable)())return!1;try{return await(0,n.validateIndexedDBOpenable)()}catch(e){return!1}}function ie(e,t,a){e=(0,n.getModularInstance)(e),j(R,G[e.app.options.appId],t,a).catch(e=>d.error(e))}function re(e,t,a){e=(0,n.getModularInstance)(e),B(R,G[e.app.options.appId],t,a).catch(e=>d.error(e))}function oe(e,t,a){e=(0,n.getModularInstance)(e),q(R,G[e.app.options.appId],t,a).catch(e=>d.error(e))}function se(e,t){e=(0,n.getModularInstance)(e),O(G[e.app.options.appId],t).catch(e=>d.error(e))}function ce(e){R?R("set",e):L(e)}function le(e,t,a,i){e=(0,n.getModularInstance)(e),z(R,G[e.app.options.appId],t,a,i).catch(e=>d.error(e))}function de(e){R?R("consent","update",e):S(e)}const ue="@firebase/analytics",pe="0.9.4";function fe(){(0,e._registerComponent)(new a.Component(i,(e,{options:t})=>{return ee(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)},"PUBLIC")),(0,e._registerComponent)(new a.Component("analytics-internal",function(e){try{const n=e.getProvider(i).getImmediate();return{logEvent:(e,t,a)=>le(n,e,t,a)}}catch(t){throw b.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,e.registerVersion)(ue,pe),(0,e.registerVersion)(ue,pe,"esm2017")}fe();
},{"@firebase/app":"qn02","@firebase/logger":"uNCT","@firebase/util":"VOc0","@firebase/component":"bXWY","@firebase/installations":"kvTz"}],"Pkoa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/analytics");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/analytics":"LjKA"}],"OHMQ":[function(require,module,exports) {
var define;
var e;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(a){var i;function s(){var e=Error.apply(this,arguments);e.name=this.name="FlashError",this.stack=e.stack,this.message=e.message}function r(){var e=Error.apply(this,arguments);e.name=this.name="WebcamError",this.stack=e.stack,this.message=e.message}var o=function(){};o.prototype=Error.prototype,s.prototype=new o,r.prototype=new o;var h={version:"1.0.26",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,iOS:/iPad|iPhone|iPod/.test(navigator.userAgent)&&!a.MSStream,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0,iosPlaceholderText:"Click here to open camera.",user_callback:null,user_canvas:null},errors:{FlashError:s,WebcamError:r},hooks:{},init:function(){var e=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function(e){return new Promise(function(t,a){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,e,t,a)})}}:null,a.URL=a.URL||a.webkitURL||a.mozURL||a.msURL,this.userMedia=this.userMedia&&!!this.mediaDevices&&!!a.URL,navigator.userAgent.match(/Firefox\D+(\d+)/)&&parseInt(RegExp.$1,10)<21&&(this.userMedia=null),this.userMedia&&a.addEventListener("beforeunload",function(t){e.reset()})},exifOrientation:function(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return console.log("Not a valid JPEG file"),0;for(var a=2;a<e.byteLength;){if(255!=t.getUint8(a))return console.log("Not a valid marker at offset "+a+", found: "+t.getUint8(a)),0;if(225==t.getUint8(a+1)){a+=4;var i="";for(n=0;n<4;n++)i+=String.fromCharCode(t.getUint8(a+n));if("Exif"!=i)return console.log("Not valid EXIF data found"),0;a+=6;var s=null;if(18761==t.getUint16(a))s=!1;else{if(19789!=t.getUint16(a))return console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),0;s=!0}if(42!=t.getUint16(a+2,!s))return console.log("Not valid TIFF data! (no 0x002A)"),0;var r=t.getUint32(a+4,!s);if(r<8)return console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(a+4,!s)),0;for(var o=a+r,h=t.getUint16(o,!s),l=0;l<h;l++){var c=o+12*l+2;if(274==t.getUint16(c,!s)){var d=t.getUint16(c+2,!s),m=t.getUint32(c+4,!s);if(3!=d&&1!=m)return console.log("Invalid EXIF orientation value type ("+d+") or count ("+m+")"),0;var p=t.getUint16(c+8,!s);return p<1||p>8?(console.log("Invalid EXIF orientation value ("+p+")"),0):p}}}else a+=2+t.getUint16(a+2)}return 0},fixOrientation:function(e,t,a){var i=new Image;i.addEventListener("load",function(e){var s=document.createElement("canvas"),r=s.getContext("2d");switch(t<5?(s.width=i.width,s.height=i.height):(s.width=i.height,s.height=i.width),t){case 2:r.transform(-1,0,0,1,i.width,0);break;case 3:r.transform(-1,0,0,-1,i.width,i.height);break;case 4:r.transform(1,0,0,-1,0,i.height);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,i.height,0);break;case 7:r.transform(0,-1,-1,0,i.height,i.width);break;case 8:r.transform(0,-1,1,0,0,i.width)}r.drawImage(i,0,0),a.src=s.toDataURL()},!1),i.src=e},attach:function(e){if("string"==typeof e&&(e=document.getElementById(e)||document.querySelector(e)),!e)return this.dispatch("error",new r("Could not locate DOM element to attach to."));this.container=e,e.innerHTML="";var t=document.createElement("div");if(e.appendChild(t),this.peg=t,this.params.width||(this.params.width=e.offsetWidth),this.params.height||(this.params.height=e.offsetHeight),!this.params.width||!this.params.height)return this.dispatch("error",new r("No width and/or height for webcam.  Please call set() first, or attach to a visible element."));this.params.dest_width||(this.params.dest_width=this.params.width),this.params.dest_height||(this.params.dest_height=this.params.height),this.userMedia=void 0===i?this.userMedia:i,this.params.force_flash&&(i=this.userMedia,this.userMedia=null),"number"!=typeof this.params.fps&&(this.params.fps=30);var s=this.params.width/this.params.dest_width,o=this.params.height/this.params.dest_height;if(this.userMedia){var n=document.createElement("video");n.setAttribute("autoplay","autoplay"),n.setAttribute("playsinline","playsinline"),n.style.width=this.params.dest_width+"px",n.style.height=this.params.dest_height+"px",1==s&&1==o||(e.style.overflow="hidden",n.style.webkitTransformOrigin="0px 0px",n.style.mozTransformOrigin="0px 0px",n.style.msTransformOrigin="0px 0px",n.style.oTransformOrigin="0px 0px",n.style.transformOrigin="0px 0px",n.style.webkitTransform="scaleX("+s+") scaleY("+o+")",n.style.mozTransform="scaleX("+s+") scaleY("+o+")",n.style.msTransform="scaleX("+s+") scaleY("+o+")",n.style.oTransform="scaleX("+s+") scaleY("+o+")",n.style.transform="scaleX("+s+") scaleY("+o+")"),e.appendChild(n),this.video=n;var l=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then(function(e){n.onloadedmetadata=function(t){l.stream=e,l.loaded=!0,l.live=!0,l.dispatch("load"),l.dispatch("live"),l.flip()},"srcObject"in n?n.srcObject=e:n.src=a.URL.createObjectURL(e)}).catch(function(t){l.params.enable_flash&&l.detectFlash()?setTimeout(function(){l.params.force_flash=1,l.attach(e)},1):l.dispatch("error",t)})}else if(this.iOS){(f=document.createElement("div")).id=this.container.id+"-ios_div",f.className="webcamjs-ios-placeholder",f.style.width=this.params.width+"px",f.style.height=this.params.height+"px",f.style.textAlign="center",f.style.display="table-cell",f.style.verticalAlign="middle",f.style.backgroundRepeat="no-repeat",f.style.backgroundSize="contain",f.style.backgroundPosition="center";var c=document.createElement("span");c.className="webcamjs-ios-text",c.innerHTML=this.params.iosPlaceholderText,f.appendChild(c);var d=document.createElement("img");d.id=this.container.id+"-ios_img",d.style.width=this.params.dest_width+"px",d.style.height=this.params.dest_height+"px",d.style.display="none",f.appendChild(d);var m=document.createElement("input");m.id=this.container.id+"-ios_input",m.setAttribute("type","file"),m.setAttribute("accept","image/*"),m.setAttribute("capture","camera");l=this;var p=this.params;m.addEventListener("change",function(e){if(e.target.files.length>0&&0==e.target.files[0].type.indexOf("image/")){var t=URL.createObjectURL(e.target.files[0]),a=new Image;a.addEventListener("load",function(e){var t=document.createElement("canvas");t.width=p.dest_width,t.height=p.dest_height;var i=t.getContext("2d");ratio=Math.min(a.width/p.dest_width,a.height/p.dest_height);var s=p.dest_width*ratio,r=p.dest_height*ratio,o=(a.width-s)/2,n=(a.height-r)/2;i.drawImage(a,o,n,s,r,0,0,p.dest_width,p.dest_height);var h=t.toDataURL();d.src=h,f.style.backgroundImage="url('"+h+"')"},!1);var i=new FileReader;i.addEventListener("load",function(e){var i=l.exifOrientation(e.target.result);i>1?l.fixOrientation(t,i,a):a.src=t},!1);var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="blob",s.onload=function(e){200!=this.status&&0!==this.status||i.readAsArrayBuffer(this.response)},s.send()}},!1),m.style.display="none",e.appendChild(m),f.addEventListener("click",function(e){p.user_callback?l.snap(p.user_callback,p.user_canvas):(m.style.display="block",m.focus(),m.click(),m.style.display="none")},!1),e.appendChild(f),this.loaded=!0,this.live=!0}else if(this.params.enable_flash&&this.detectFlash()){var f;a.Webcam=h,(f=document.createElement("div")).innerHTML=this.getSWFHTML(),e.appendChild(f)}else this.dispatch("error",new r(this.params.noInterfaceFoundText));if(this.params.crop_width&&this.params.crop_height){var u=Math.floor(this.params.crop_width*s),g=Math.floor(this.params.crop_height*o);e.style.width=u+"px",e.style.height=g+"px",e.style.overflow="hidden",e.scrollLeft=Math.floor(this.params.width/2-u/2),e.scrollTop=Math.floor(this.params.height/2-g/2)}else e.style.width=this.params.width+"px",e.style.height=this.params.height+"px"},reset:function(){if(this.preview_active&&this.unfreeze(),this.unflip(),this.userMedia){if(this.stream)if(this.stream.getVideoTracks){var e=this.stream.getVideoTracks();e&&e[0]&&e[0].stop&&e[0].stop()}else this.stream.stop&&this.stream.stop();delete this.stream,delete this.video}if(!0!==this.userMedia&&this.loaded&&!this.iOS){var t=this.getMovie();t&&t._releaseCamera&&t._releaseCamera()}this.container&&(this.container.innerHTML="",delete this.container),this.loaded=!1,this.live=!1},set:function(){if(1==arguments.length)for(var e in arguments[0])this.params[e]=arguments[0][e];else this.params[arguments[0]]=arguments[1]},on:function(e,t){e=e.replace(/^on/i,"").toLowerCase(),this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t)},off:function(e,t){if(e=e.replace(/^on/i,"").toLowerCase(),this.hooks[e])if(t){var a=this.hooks[e].indexOf(t);a>-1&&this.hooks[e].splice(a,1)}else this.hooks[e]=[]},dispatch:function(){var e,i=arguments[0].replace(/^on/i,"").toLowerCase(),o=Array.prototype.slice.call(arguments,1);if(this.hooks[i]&&this.hooks[i].length){for(var n=0,h=this.hooks[i].length;n<h;n++){var l=this.hooks[i][n];"function"==typeof l?l.apply(this,o):"object"==t(l)&&2==l.length?l[0][l[1]].apply(l[0],o):a[l]&&a[l].apply(a,o)}return!0}return"error"==i&&(e=o[0]instanceof s||o[0]instanceof r?o[0].message:"Could not access webcam: "+o[0].name+": "+o[0].message+" "+o[0].toString(),alert("Webcam.js Error: "+e)),!1},setSWFLocation:function(e){this.set("swfURL",e)},detectFlash:function(){var e="Shockwave Flash",i="application/x-shockwave-flash",s=a,r=navigator,o=!1;if(void 0!==r.plugins&&"object"===t(r.plugins[e]))r.plugins[e].description&&void 0!==r.mimeTypes&&r.mimeTypes[i]&&r.mimeTypes[i].enabledPlugin&&(o=!0);else if(void 0!==s.ActiveXObject)try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(n)n.GetVariable("$version")&&(o=!0)}catch(a){}return o},getSWFHTML:function(){var e="",t=this.params.swfURL;if(location.protocol.match(/file/))return this.dispatch("error",new s("Flash does not work from local disk.  Please run from a web server.")),'<h3 style="color:red">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>';if(!this.detectFlash())return this.dispatch("error",new s("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again.")),'<h3 style="color:red">'+this.params.flashNotDetectedText+"</h3>";if(!t){for(var i="",r=document.getElementsByTagName("script"),o=0,n=r.length;o<n;o++){var h=r[o].getAttribute("src");h&&h.match(/\/webcam(\.min)?\.js/)&&(i=h.replace(/\/webcam(\.min)?\.js.*$/,""),o=n)}t=i?i+"/webcam.swf":"webcam.swf"}a.localStorage&&!localStorage.getItem("visited")&&(this.params.new_user=1,localStorage.setItem("visited",1));var l="";for(var c in this.params)l&&(l+="&"),l+=c+"="+escape(this.params[c]);return e+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this.params.width+'" height="'+this.params.height+'" id="webcam_movie_obj" align="middle"><param name="wmode" value="opaque" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+t+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+l+'"/><embed id="webcam_movie_embed" src="'+t+'" wmode="opaque" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+this.params.width+'" height="'+this.params.height+'" name="webcam_movie_embed" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+l+'"></embed></object>'},getMovie:function(){if(!this.loaded)return this.dispatch("error",new s("Flash Movie is not loaded yet"));var e=document.getElementById("webcam_movie_obj");return e&&e._snap||(e=document.getElementById("webcam_movie_embed")),e||this.dispatch("error",new s("Cannot locate Flash movie in DOM")),e},freeze:function(){var e=this,t=this.params;this.preview_active&&this.unfreeze();var a=this.params.width/this.params.dest_width,i=this.params.height/this.params.dest_height;this.unflip();var s=t.crop_width||t.dest_width,r=t.crop_height||t.dest_height,o=document.createElement("canvas");o.width=s,o.height=r;var n=o.getContext("2d");this.preview_canvas=o,this.preview_context=n,1==a&&1==i||(o.style.webkitTransformOrigin="0px 0px",o.style.mozTransformOrigin="0px 0px",o.style.msTransformOrigin="0px 0px",o.style.oTransformOrigin="0px 0px",o.style.transformOrigin="0px 0px",o.style.webkitTransform="scaleX("+a+") scaleY("+i+")",o.style.mozTransform="scaleX("+a+") scaleY("+i+")",o.style.msTransform="scaleX("+a+") scaleY("+i+")",o.style.oTransform="scaleX("+a+") scaleY("+i+")",o.style.transform="scaleX("+a+") scaleY("+i+")"),this.snap(function(){o.style.position="relative",o.style.left=e.container.scrollLeft+"px",o.style.top=e.container.scrollTop+"px",e.container.insertBefore(o,e.peg),e.container.style.overflow="hidden",e.preview_active=!0},o)},unfreeze:function(){this.preview_active&&(this.container.removeChild(this.preview_canvas),delete this.preview_context,delete this.preview_canvas,this.preview_active=!1,this.flip())},flip:function(){if(this.params.flip_horiz){var e=this.container.style;e.webkitTransform="scaleX(-1)",e.mozTransform="scaleX(-1)",e.msTransform="scaleX(-1)",e.oTransform="scaleX(-1)",e.transform="scaleX(-1)",e.filter="FlipH",e.msFilter="FlipH"}},unflip:function(){if(this.params.flip_horiz){var e=this.container.style;e.webkitTransform="scaleX(1)",e.mozTransform="scaleX(1)",e.msTransform="scaleX(1)",e.oTransform="scaleX(1)",e.transform="scaleX(1)",e.filter="",e.msFilter=""}},savePreview:function(e,t){var a=this.params,i=this.preview_canvas,s=this.preview_context;t&&t.getContext("2d").drawImage(i,0,0);e(t?null:i.toDataURL("image/"+a.image_format,a.jpeg_quality/100),i,s),this.params.unfreeze_snap&&this.unfreeze()},snap:function(e,t){e||(e=this.params.user_callback),t||(t=this.params.user_canvas);var a=this.params;if(!this.loaded)return this.dispatch("error",new r("Webcam is not loaded yet"));if(!e)return this.dispatch("error",new r("Please provide a callback function or canvas to snap()"));if(this.preview_active)return this.savePreview(e,t),null;var i=document.createElement("canvas");i.width=this.params.dest_width,i.height=this.params.dest_height;var s=i.getContext("2d");this.params.flip_horiz&&(s.translate(a.dest_width,0),s.scale(-1,1));var o=function(){if(a.crop_width&&a.crop_height){var r=document.createElement("canvas");r.width=a.crop_width,r.height=a.crop_height;var o=r.getContext("2d");o.drawImage(i,Math.floor(a.dest_width/2-a.crop_width/2),Math.floor(a.dest_height/2-a.crop_height/2),a.crop_width,a.crop_height,0,0,a.crop_width,a.crop_height),s=o,i=r}if(t){var n=t.getContext("2d");n.drawImage(i,0,0)}e(t?null:i.toDataURL("image/"+a.image_format,a.jpeg_quality/100),i,s)};if(this.userMedia)s.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height),o();else if(this.iOS){var n=document.getElementById(this.container.id+"-ios_div"),h=document.getElementById(this.container.id+"-ios_img"),l=document.getElementById(this.container.id+"-ios_input");iFunc=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){o.call(h),h.removeEventListener("load",iFunc),n.style.backgroundImage="none",h.removeAttribute("src"),l.value=null}),l.value?iFunc(null):(h.addEventListener("load",iFunc),l.style.display="block",l.focus(),l.click(),l.style.display="none")}else{var c=this.getMovie()._snap();(h=new Image).onload=o,h.src="data:image/"+this.params.image_format+";base64,"+c}return null},configure:function(e){e||(e="camera"),this.getMovie()._configure(e)},flashNotify:function(e,t){switch(e){case"flashLoadComplete":this.loaded=!0,this.dispatch("load");break;case"cameraLive":this.live=!0,this.dispatch("live");break;case"error":this.dispatch("error",new s(t))}},b64ToUint6:function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},base64DecToArr:function(e,t){for(var a,i,s=e.replace(/[^A-Za-z0-9\+\/]/g,""),r=s.length,o=t?Math.ceil((3*r+1>>2)/t)*t:3*r+1>>2,n=new Uint8Array(o),h=0,l=0,c=0;c<r;c++)if(i=3&c,h|=this.b64ToUint6(s.charCodeAt(c))<<18-6*i,3===i||r-c==1){for(a=0;a<3&&l<o;a++,l++)n[l]=h>>>(16>>>a&24)&255;h=0}return n},upload:function(e,t,a){var i=this.params.upload_name||"webcam",s="";if(!e.match(/^data\:image\/(\w+)/))throw"Cannot locate image format in Data URI";s=RegExp.$1;var r=e.replace(/^data\:image\/\w+\;base64\,/,""),o=new XMLHttpRequest;o.open("POST",t,!0),o.upload&&o.upload.addEventListener&&o.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;h.dispatch("uploadProgress",t,e)}},!1);var n=this;o.onload=function(){a&&a.apply(n,[o.status,o.responseText,o.statusText]),h.dispatch("uploadComplete",o.status,o.responseText,o.statusText)};var l=new Blob([this.base64DecToArr(r)],{type:"image/"+s}),c=new FormData;c.append(i,l,i+"."+s.replace(/e/,"")),o.send(c)}};h.init(),"function"==typeof e&&e.amd?e(function(){return h}):"object"===("undefined"==typeof module?"undefined":t(module))&&module.exports?module.exports=h:a.Webcam=h}(window);
},{}],"sNrv":[function(require,module,exports) {
var process = require("process");
var r=require("process");function t(r,t){for(var e=0,n=r.length-1;n>=0;n--){var o=r[n];"."===o?r.splice(n,1):".."===o?(r.splice(n,1),e++):e&&(r.splice(n,1),e--)}if(t)for(;e--;e)r.unshift("..");return r}function e(r){"string"!=typeof r&&(r+="");var t,e=0,n=-1,o=!0;for(t=r.length-1;t>=0;--t)if(47===r.charCodeAt(t)){if(!o){e=t+1;break}}else-1===n&&(o=!1,n=t+1);return-1===n?"":r.slice(e,n)}function n(r,t){if(r.filter)return r.filter(t);for(var e=[],n=0;n<r.length;n++)t(r[n],n,r)&&e.push(r[n]);return e}exports.resolve=function(){for(var e="",o=!1,s=arguments.length-1;s>=-1&&!o;s--){var i=s>=0?arguments[s]:r.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,o="/"===i.charAt(0))}return(o?"/":"")+(e=t(n(e.split("/"),function(r){return!!r}),!o).join("/"))||"."},exports.normalize=function(r){var e=exports.isAbsolute(r),s="/"===o(r,-1);return(r=t(n(r.split("/"),function(r){return!!r}),!e).join("/"))||e||(r="."),r&&s&&(r+="/"),(e?"/":"")+r},exports.isAbsolute=function(r){return"/"===r.charAt(0)},exports.join=function(){var r=Array.prototype.slice.call(arguments,0);return exports.normalize(n(r,function(r,t){if("string"!=typeof r)throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))},exports.relative=function(r,t){function e(r){for(var t=0;t<r.length&&""===r[t];t++);for(var e=r.length-1;e>=0&&""===r[e];e--);return t>e?[]:r.slice(t,e-t+1)}r=exports.resolve(r).substr(1),t=exports.resolve(t).substr(1);for(var n=e(r.split("/")),o=e(t.split("/")),s=Math.min(n.length,o.length),i=s,u=0;u<s;u++)if(n[u]!==o[u]){i=u;break}var f=[];for(u=i;u<n.length;u++)f.push("..");return(f=f.concat(o.slice(i))).join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(r){if("string"!=typeof r&&(r+=""),0===r.length)return".";for(var t=r.charCodeAt(0),e=47===t,n=-1,o=!0,s=r.length-1;s>=1;--s)if(47===(t=r.charCodeAt(s))){if(!o){n=s;break}}else o=!1;return-1===n?e?"/":".":e&&1===n?"/":r.slice(0,n)},exports.basename=function(r,t){var n=e(r);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},exports.extname=function(r){"string"!=typeof r&&(r+="");for(var t=-1,e=0,n=-1,o=!0,s=0,i=r.length-1;i>=0;--i){var u=r.charCodeAt(i);if(47!==u)-1===n&&(o=!1,n=i+1),46===u?-1===t?t=i:1!==s&&(s=1):-1!==t&&(s=-1);else if(!o){e=i+1;break}}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===e+1?"":r.slice(t,n)};var o="b"==="ab".substr(-1)?function(r,t,e){return r.substr(t,e)}:function(r,t,e){return t<0&&(t=r.length+t),r.substr(t,e)};
},{"process":"g5IB"}],"war4":[function(require,module,exports) {
exports.endianness=function(){return"LE"},exports.hostname=function(){return"undefined"!=typeof location?location.hostname:""},exports.loadavg=function(){return[]},exports.uptime=function(){return 0},exports.freemem=function(){return Number.MAX_VALUE},exports.totalmem=function(){return Number.MAX_VALUE},exports.cpus=function(){return[]},exports.type=function(){return"Browser"},exports.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},exports.networkInterfaces=exports.getNetworkInterfaces=function(){return{}},exports.arch=function(){return"javascript"},exports.platform=function(){return"browser"},exports.tmpdir=exports.tmpDir=function(){return"/tmp"},exports.EOL="\n",exports.homedir=function(){return"/"};
},{}],"MZEE":[function(require,module,exports) {
module.exports={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}};
},{}],"Ig2k":[function(require,module,exports) {
var process = require("process");
var e=require("process"),r=require("fs"),n=require("path"),o=require("os"),a=require("../package.json"),c=a.version,s=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function t(e){var r,n={},o=e.toString();for(o=o.replace(/\r\n?/gm,"\n");null!=(r=s.exec(o));){var a=r[1],c=r[2]||"",t=(c=c.trim())[0];c=c.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===t&&(c=(c=c.replace(/\\n/g,"\n")).replace(/\\r/g,"\r")),n[a]=c}return n}function i(e){console.log("[dotenv@".concat(c,"][DEBUG] ").concat(e))}function l(e){return"~"===e[0]?n.join(o.homedir(),e.slice(1)):e}function d(o){var a=n.resolve(e.cwd(),".env"),c="utf8",s=Boolean(o&&o.debug),t=Boolean(o&&o.override);o&&(null!=o.path&&(a=l(o.path)),null!=o.encoding&&(c=o.encoding));try{var d=p.parse(r.readFileSync(a,{encoding:c}));return Object.keys(d).forEach(function(r){Object.prototype.hasOwnProperty.call(e.env,r)?(!0===t&&(e.env[r]=d[r]),s&&i('"'.concat(r,!0===t?'" is already defined in `process.env` and WAS overwritten':'" is already defined in `process.env` and was NOT overwritten'))):e.env[r]=d[r]}),{parsed:d}}catch(u){return s&&i("Failed to load ".concat(a," ").concat(u.message)),{error:u}}}var p={config:d,parse:t};module.exports.config=p.config,module.exports.parse=p.parse,module.exports=p;
},{"fs":"D9Nj","path":"sNrv","os":"war4","../package.json":"MZEE","process":"g5IB"}],"H99C":[function(require,module,exports) {
var define;
var t;require("./styles.css");var e=h(require("jquery")),a=require("firebase/app"),o=require("firebase/firestore"),n=require("firebase/storage"),r=require("firebase/analytics"),i=h(require("./webcam.min.js")),s=l(require("dotenv"));function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,a=new WeakMap;return(c=function(t){return t?a:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var a=c(e);if(a&&a.has(t))return a.get(t);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var i=n?Object.getOwnPropertyDescriptor(t,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=t[r]}return o.default=t,a&&a.set(t,o),o}function h(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(){"use strict";d=function(){return t};var t={},e=Object.prototype,a=e.hasOwnProperty,o=Object.defineProperty||function(t,e,a){t[e]=a.value},n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,a){return t[e]=a}}function l(t,e,a,n){var r=e&&e.prototype instanceof p?e:p,i=Object.create(r.prototype),s=new L(n||[]);return o(i,"_invoke",{value:k(t,a,s)}),i}function h(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(P){return{type:"throw",arg:P}}}t.wrap=l;var f={};function p(){}function g(){}function w(){}var m={};c(m,r,function(){return this});var y=Object.getPrototypeOf,_=y&&y(y(I([])));_&&_!==e&&a.call(_,r)&&(m=_);var v=w.prototype=p.prototype=Object.create(m);function b(t){["next","throw","return"].forEach(function(e){c(t,e,function(t){return this._invoke(e,t)})})}function x(t,e){var n;o(this,"_invoke",{value:function(o,r){function i(){return new e(function(n,i){!function o(n,r,i,s){var c=h(t[n],t,r);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==u(d)&&a.call(d,"__await")?e.resolve(d.__await).then(function(t){o("next",t,i,s)},function(t){o("throw",t,i,s)}):e.resolve(d).then(function(t){l.value=t,i(l)},function(t){return o("throw",t,i,s)})}s(c.arg)}(o,r,n,i)})}return n=n?n.then(i,i):i()}})}function k(t,e,a){var o="suspendedStart";return function(n,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw r;return T()}for(a.method=n,a.arg=r;;){var i=a.delegate;if(i){var s=S(i,a);if(s){if(s===f)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===o)throw o="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);o="executing";var c=h(t,e,a);if("normal"===c.type){if(o=a.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(o="completed",a.method="throw",a.arg=c.arg)}}}function S(t,e){var a=e.method,o=t.iterator[a];if(void 0===o)return e.delegate=null,"throw"===a&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==a&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+a+"' method")),f;var n=h(o,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,f;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function I(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,n=function e(){for(;++o<t.length;)if(a.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:T}}function T(){return{value:void 0,done:!0}}return g.prototype=w,o(v,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(x.prototype),c(x.prototype,i,function(){return this}),t.AsyncIterator=x,t.async=function(e,a,o,n,r){void 0===r&&(r=Promise);var i=new x(l(e,a,o,n),r);return t.isGeneratorFunction(a)?i:i.next().then(function(t){return t.done?t.value:i.next()})},b(v),c(v,s,"Generator"),c(v,r,function(){return this}),c(v,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),a=[];for(var o in e)a.push(o);return a.reverse(),function t(){for(;a.length;){var o=a.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},t.values=I,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(a,o){return i.type="throw",i.arg=t,e.next=a,o&&(e.method="next",e.arg=void 0),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],i=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var s=a.call(r,"catchLoc"),c=a.call(r,"finallyLoc");if(s&&c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),j(a),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var o=a.completion;if("throw"===o.type){var n=o.arg;j(a)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:I(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=void 0),f}},t}function f(t,e,a,o,n,r,i){try{var s=t[r](i),c=s.value}catch(l){return void a(l)}s.done?e(c):Promise.resolve(c).then(o,n)}function p(t){return function(){var e=this,a=arguments;return new Promise(function(o,n){var r=t.apply(e,a);function i(t){f(r,o,n,i,s,"next",t)}function s(t){f(r,o,n,i,s,"throw",t)}i(void 0)})}}s.config();var g={apiKey:"AIzaSyDe1sKd4XfY0pS1doRzvS9KwHpDHJEbRwU",authDomain:"withfaithcowork.firebaseapp.com",projectId:"withfaithcowork",storageBucket:"withfaithcowork.appspot.com",messagingSenderId:"107068147490",appId:"1:107068147490:web:da5e00e53657b38040077b",measurementId:"G-DXWJSDSDG7"},w=(0,a.initializeApp)(g);console.log(w);var m,y,_,v,b,x,k=(0,o.getFirestore)(w),S=(0,n.getStorage)(),D="",j="faith****hope",L="withfaithwelcome::love",I="",T="demo";function P(t){alert(t),console.log(t)}(0,e.default)(document).ready(function(){function t(){(0,e.default)("#withfaith_openingpage_ig").hide(),(0,e.default)("#withfaith_welcometocowork").hide(),(0,e.default)("#withfaith_coreapp").hide()}function a(){return r.apply(this,arguments)}function r(){return(r=p(d().mark(function a(){var o;return d().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t(),(o=localStorage.ig_data)?(console.log("data saved!"),D=JSON.parse(o),j=localStorage.withfaith_chatgpt_intro_analysis,(0,e.default)("#withfaith_coreapp").show(),(0,e.default)("#analyzing_ig_username").html('\n            <span style="color: blue"><a href="'.concat(D.url,'" target="_blank">@').concat(D.username,'</a></span>\n            <br>\n            Click <a><span style="color:green" onclick="withfaith_update_ig_account()">here</span></a> to plug in another IG account\n          ')),(0,e.default)("#withfaith_howmanyphotos_generated").html(localStorage.withfaith_howmanyphotos_generated),(0,e.default)("#withfaith_current_gen_photo").html(localStorage.withfaith_current_gen_photo),parseInt(localStorage.withfaith_howmanyphotos_generated,10)>0&&((0,e.default)("#withfaith_prephotos_info").hide(),(0,e.default)("#withfaith_generate_new_photo").show()),(0,e.default)("#withfaith_howmanycooltitledescriptions_generated").html(localStorage.withfaith_howmanycooltitledescriptions_generated),parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)>0&&((0,e.default)("#withfaith_prechat_info").hide(),(0,e.default)("#withfaith_supercoolupdatewritings").show(),(0,e.default)("#withfaith_supercoolupdatewritingsactionbutton").show()),O("\n          Welcome to Cowork demo, @".concat(D.username,"! ").concat(localStorage.withfaith_chatgpt_intro_analysis.split("****")[0]," I am your AI Social Media Manager. What kind of post would you like to create today?\n          ")),O('\n            <table style="text-align: center">\n            <tr>\n            <td style="padding: 3px">\n            <button class="btn-small btn-primary" onclick="withfaith_create_new_social_media_post()" style="border-radius: 22px; padding: 8px">Social Media Post For A New Product</button>\n            </td>\n            </tr>  \n            \x3c!--\n            <tr>\n            <td style="padding: 3px">\n            <button class="btn-small btn-primary" style="border-radius: 22px; padding: 8px">Surprise Me!</button>\n            </td>\n            </tr>  \n            --\x3e \n            </table>\n          ')):(console.log("data from ig call was blank"),t(),s());case 3:case"end":return a.stop()}},a)}))).apply(this,arguments)}function s(){t(),(0,e.default)("#withfaith_openingpage_ig").show()}y=(0,o.doc)(k,"demo",T),(0,e.default)("#main").show(),a(),window.withfaith_show_photolib=function(){(0,e.default)("#withfaith_text_actions").hide(),(0,e.default)("#withfaith_photo_actions").show()},window.withfaith_show_textupdates=function(){(0,e.default)("#withfaith_photo_actions").hide(),(0,e.default)("#withfaith_text_actions").show()},window.withfaith_create_new_social_media_post=p(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return L="withfaith_create_new_social_media_post::describe_product",e="\n      Okay, great! Can you tell us a little more about the product?\n      ",t.next=4,O(e);case 4:return e="\n    For example, the type of product, add some details about it. \n    ",t.next=7,O(e);case 7:case"end":return t.stop()}},t)})),window.withfaith_update_ig_account=function(){localStorage.removeItem("ig_data");for(var t=0;t<parseInt(localStorage.withfaith_howmanyphotos_generated);t++)localStorage.removeItem("withfaith_photogenerated_"+(t+1));window.location.reload()},(0,e.default)("#withfaithhelperstarter").keypress(function(n){if(13==n.which){(0,e.default)("#loader").show();var r=(0,e.default)("#withfaithhelperstarter").val();setTimeout(function(){!function(){t(),(0,e.default)("#withfaith_welcometocowork").show(),(0,e.default)("body").css({"background-image":"url('https://thumbs.gfycat.com/AcclaimedBonyAlaskanmalamute-max-1mb.gif')","background-size":"cover","background-position":"center"});var a=0,o="Welcome to@*Preparing your workspace...*D   a   r   e     T   o ** <",n=55;!function t(){a<o.length&&("*"===o.charAt(a)?setTimeout(function(){document.getElementById("demo").innerHTML="",a++,setTimeout(t,n)},500):"<"===o.charAt(a)?((0,e.default)("body").css({"background-image":"url('https://www.thisiscolossal.com/wp-content/uploads/2014/03/120430.gif')"}),(0,e.default)("#demo").html('<span style="color: blue">D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M<span>')):"@"==o.charAt(a)?(setTimeout(function(){document.getElementById("demo").innerHTML="",(0,e.default)("#withfaithwelcome").show()},500),setTimeout(function(){(0,e.default)("#withfaithwelcome").hide(),a++,setTimeout(t,n)},2500)):(document.getElementById("demo").innerHTML+=o.charAt(a),a++,setTimeout(t,n)))}()}()},3481),console.log("here");var i={cache:!1,async:!0,crossDomain:!0,url:"https://us-central1-love-375210.cloudfunctions.net/apify?profile="+r,method:"POST",timeout:0};e.default.ajax(i).done(function(t){if(console.log(t),t.response.length>0){localStorage.withfaith_fbuid||p(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.addDoc)((0,o.collection)(k,"demo"),{withfaith:"love"});case 2:e=t.sent,console.log("Document written with ID: ",e.id),localStorage.withfaith_fbuid=e.id;case 5:case"end":return t.stop()}},t)}))(),localStorage.ig_data=JSON.stringify(t.response[0]),localStorage.withfaith_photoupload_base64||(localStorage.withfaith_howmanyphotos_generated=0,localStorage.withfaith_howmanycooltitledescriptions_generated=0);var n=[];n.push("withfaithprep"),localStorage.withfaith_chathistory=JSON.stringify(n);var r=[];r.push("withfaithprep"),localStorage.withfaith_photolibrary=JSON.stringify(r),console.log(JSON.stringify(t.response[0]))}else alert("Instagram account not found");var i=localStorage.ig_data;i&&(D=JSON.parse(i));var s="",c={url:"https://us-central1-love-375210.cloudfunctions.net/chatgpt?prompt="+(s+='\n        Response: Seems like you are running a very nice (description of Instagram account from information given).\n\n        Please reference the response given to complete the response describing what kind of Instagram profile you think this user has. Please speak relatively casually and avoid talking in the 3rd person. Speak directly to this person as someone who would like to help them manage their social media account. Please avoid greeting phrases like "hi" or "hello". Assume that this person is already greeted and you\'re progressing from an initial greeting. \n\n        Also, after your response, please include a brief description of a type of setting that you think would fit well with this profile in this format (include 4 asterisks before your response): ****(your response)\n\n        Username: '.concat(D.username,"\n        Biography: ").concat(D.biography,"\n        Response: \n        ")),method:"GET",timeout:0};e.default.ajax(c).done(function(t){console.log(t),localStorage.withfaith_chatgpt_intro_analysis=t.response,(0,e.default)("#loader").hide(),p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{z_ig_data:localStorage.ig_data,withfaith_chatgpt_intro_analysis:localStorage.withfaith_chatgpt_intro_analysis,withfaith_photolibrary:localStorage.withfaith_photolibrary,withfaith_chathistory:localStorage.withfaith_chathistory,withfaith_howmanycooltitledescriptions_generated:localStorage.withfaith_howmanycooltitledescriptions_generated,withfaith_howmanyphotos_generated:localStorage.withfaith_howmanyphotos_generated},{merge:!0});case 2:case"end":return t.stop()}},t)}))(),a()})})}});var c=(0,e.default)(".chat-container"),l=(0,e.default)(".message-input"),h=(0,e.default)(".send-button"),u=(0,e.default)(".file-upload-input");(0,e.default)(".file-upload-label");function f(){var t=l.val();t&&(c.append('\n        <div class="message">\n          <div class="message-body">\n            '.concat(t,'\n            <div class="time">').concat(g(),"</div>\n          </div>\n        </div>\n      ")),l.val(""),w())}function g(){var t=new Date,e=t.getHours(),a=t.getMinutes();return e<10&&(e="0"+e),a<10&&(a="0"+a),e+":"+a}function w(){c.scrollTop(c[0].scrollHeight)}u.on("change",function(t){var e=t.target.files[0],a=new FileReader;a.onload=function(t){c.append('\n        <div class="message">\n          <div class="message-body">\n            <img src="'.concat(t.target.result,'" class="message-image" />\n            <div class="time">').concat(g(),"</div>\n          </div>\n        </div>\n      ")),w()},a.readAsDataURL(e)}),(0,e.default)(".upvote").click(function(){event.target.classList.toggle("upvoted")}),l.on("keydown",function(t){13!=t.keyCode||t.shiftKey||(t.preventDefault(),f())}),h.on("click",function(t){t.preventDefault(),f()});c=(0,e.default)(".chat-container"),l=(0,e.default)(".chat-input input"),h=(0,e.default)(".chat-input button"),u=(0,e.default)(".file-upload-input"),(0,e.default)(".file-upload-label");u.on("change",function(t){var e=t.target.files[0],a=new FileReader;a.onload=function(t){c.append('\n  <div class="message">\n    <div class="message-body">\n      <img src="'.concat(t.target.result,'" class="message-image" />\n      <div class="time">').concat(A(),"</div>\n    </div>\n  </div>\n")),C()},a.readAsDataURL(e)});var _="";function b(t){var a=document.getElementById(t).files[0],n=new FileReader;n.onloadend=function(){(0,e.default)("#message").find("br").remove();var t="with faith";if(t=t.replace(/<div>/,"<br>").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/<br>/g," ").trim()){var a='<div class="post post-user">\n        <img src="'.concat(n.result,'"  \n        width="177" \n        /> ').concat(A(),"</span></div>");(0,e.default)("#message-board").append(a),(0,e.default)("#my_camera").hide(),(0,e.default)("#recordpicture").hide(),i.default.reset(),C(),p(d().mark(function t(){var e,a;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.getDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid));case 2:(e=t.sent).exists()?(console.log("Document data:",e.data()),v=e.data(),v.withfaith_chathistory,a={from:"user",response:"(photo)",html:"(photo)"},p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_chathistory:(0,o.arrayUnion)(a)},{merge:!0});case 2:case"end":return t.stop()}},t)}))()):console.log("No such document!");case 4:case"end":return t.stop()}},t)}))(),window.withfaith_prep_photo_with_chat(n.result),setTimeout(function(){C()},500)}(0,e.default)("#message").empty()},a&&n.readAsDataURL(a)}function x(){(0,e.default)("#message").find("br").remove();var t,a="with faith";if(a=a.replace(/<div>/,"<br>").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/<br>/g," ").trim()){var o='<div class="post post-user">\n    <img src="https://firebasestorage.googleapis.com/v0/b/withfaithcowork.appspot.com/o/withfaith%20try%20as%20well.png?alt=media&token=68d222b7-d46e-4702-919c-b1dc19178b99"\n      width="177" \n    />\n    '.concat(A(),"</span></div>");(0,e.default)("#message-board").append(o),C(),"string"==typeof(t=function(t){var e=t.toLowerCase(),a=["Sorry, I don't understand you.","Please try again"];/^hi$|^hell?o|^howdy|^hoi|^hey|^ola/.test(e)?a=["Hi ".concat(_),"What can I do for you?"]:/test/.test(e)?a=["Ok","Feel free to test as much as you want"]:/help|sos|emergency|support/.test(e)?a=["I am here to help.","What seems to be the problem?"]:/class\=\"fa/.test(e)?a=["I see you've found the smileys",'Cool! <span class="far fa-grin-beam fa-2x"></span>',"Did you need something?"]:/how|what|why/.test(e)?a=t+" what?":/^huh+|boring|lame|wtf|pff/.test(e)?a=['<span class="far fa-dizzy fa-2x"></span>',"I'm sorry you feel that way","How can I make it better?"]:/bye|ciao|adieu|salu/.test(e)&&(a=["Ok, bye :)"]);return a}(a))?O(response):t.forEach(function(t){return O(t)})}(0,e.default)("#message").empty()}function P(){(0,e.default)("#message").find("br").remove();var t=(0,e.default)("#message").html().trim();if(t=t.replace(/<div>/,"<br>").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/<br>/g," ").trim()){var a='<div class="post post-user">'.concat(t+A(),"</span></div>");(0,e.default)("#message-board").append(a),C(),p(d().mark(function e(){var n,r;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.getDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid));case 2:(n=e.sent).exists()?(console.log("Document data:",n.data()),v=n.data(),v.withfaith_chathistory,r={from:"user",response:E(t),html:a},p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_chathistory:(0,o.arrayUnion)(r)},{merge:!0});case 2:case"end":return t.stop()}},t)}))()):console.log("No such document!");case 4:case"end":return e.stop()}},e)}))();var n=L.split("::")[0],r=L.split("::")[1];if("withfaith_create_new_social_media_post"==n&&"describe_product"==r){I=t,L="withfaith_create_new_social_media_post::ask_for_photo";var i='\n          <img src="https://www.citypng.com/public/uploads/small/11641123862zya20vtg6snjl6q603msbj5jurjyzpqekdy9a7h4bwkmqyvzx6sri7mq4ejkmuife8qrtncqodgu3irir3dq5plnvhd3ktenoirx.png" width="18" /> Okay, got it. Thank you!\n          ';O(i),O(i='\n          Now, can you upload a photo of the product?\n          <br> <br> \n          <table style="text-align: center">\n          <tr>\n          <td style="padding: 3px; width: 725px">  \n          <form><label\n          for="fetchfilevalwith" \n          style="color: white; cursor: pointer;"\n          >  <div class="btn-small btn-primary" style="border-radius: 22px; padding: 8px">Upload Photo</div></label> \n          <input type="file" id="fetchfilevalwith" hidden /> \n          </form> \n          </td>\n          </tr> \n          <tr>\n          <td style="padding: 3px; width: 725px"> \n          <button class="btn-small btn-primary" onclick="withfaith_photoupload_helper(\'camera\')" style="border-radius: 22px; padding: 8px">Take A Picture</button>\n          </td>\n          </tr>   \n          <tr>\n          <td style="padding: 3px; padding-top: 11px; width: 725px"> \n          <button class="btn-small btn-outlined-secondary" onclick="withfaith_photoupload_helper(\'camera\')" style="border-radius: 22px; padding: 8px; font-size: 10.2px">Continue Without A Photo</button>\n          </td>\n          </tr>   \n          </table> \n        \n          '),(0,e.default)("#fetchfilevalwith").on("change",function(){b("fetchfilevalwith")})}}(0,e.default)("#message").empty()}function O(t){var a='<div class="post post-bot">'.concat(t+A(),"</div>");Math.floor(2e3*Math.random());(0,e.default)("#message-board").append(a),C(),p(d().mark(function e(){var n,r,i;return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.getDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid));case 2:(n=e.sent).exists()?(console.log("Document data:",n.data()),v=n.data(),r=v.withfaith_chathistory,Array.from(!r),i={from:"ai",response:E(t),html:a},p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_chathistory:(0,o.arrayUnion)(i)},{merge:!0});case 2:case"end":return t.stop()}},t)}))()):console.log("No such document!");case 4:case"end":return e.stop()}},e)}))()}function E(t){var e=document.createElement("DIV");return e.innerHTML=t,e.textContent||e.innerText||""}function A(){var t=new Date,e=t.getHours(),a=t.getMinutes();return a<10&&(a="0"+a),'<span class="timestamp">'.concat(e,":").concat(a,"</span>")}function C(){var t=(0,e.default)("#message-board"),a=t.height(),o=t[0].scrollHeight;o>a&&t.scrollTop(o)}_=(0,e.default)("#username").val(),(0,e.default)("#landing").slideUp(300),setTimeout(function(){(0,e.default)("#start-chat").html("Continue chat")},300),(0,e.default)("#photovidlibbutton").on("click",function(){(0,e.default)("#loader").show(),i.default.set({width:320,height:240,image_format:"jpeg",jpeg_quality:90}),i.default.attach("#my_camera"),(0,e.default)("#my_camera").show(),(0,e.default)("#recordpicture").show(),(0,e.default)("#withfaithcomeagainwithpicture").show(),setTimeout(function(){(0,e.default)("#loader").hide()},2500)}),(0,e.default)("#recordpicture").on("click",function(){i.default.snap(function(t){(0,e.default)("#message").find("br").remove();var a="with faith";if(a=a.replace(/<div>/,"<br>").replace(/<div>/g,"").replace(/<\/div>/g,"<br>").replace(/<br>/g," ").trim()){var n='<div class="post post-user">\n        <img src="'.concat(t,'" \n        width="177" \n        /> ').concat(A(),"</span></div>");(0,e.default)("#message-board").append(n),(0,e.default)("#my_camera").hide(),(0,e.default)("#recordpicture").hide(),(0,e.default)("#withfaithcomeagainwithpicture").hide(),i.default.reset(),C(),p(d().mark(function t(){var e,a;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.getDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid));case 2:(e=t.sent).exists()?(console.log("Document data:",e.data()),(v=e.data()).withfaith_chathistory,a={from:"user",response:"(photo)",html:"(photo)"},p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_chathistory:(0,o.arrayUnion)(a)},{merge:!0});case 2:case"end":return t.stop()}},t)}))()):console.log("No such document!");case 4:case"end":return t.stop()}},t)}))(),window.withfaith_prep_photo_with_chat(t),setTimeout(function(){C()},500)}(0,e.default)("#message").empty()})}),window.withfaith_prep_photo_with_chat=function(t){var e=L.split("::")[0],a=L.split("::")[1];if("withfaith_create_new_social_media_post"===e&&"ask_for_photo"===a){m=t,console.log(m);var o='\n        <img src="https://www.citypng.com/public/uploads/small/11641123862zya20vtg6snjl6q603msbj5jurjyzpqekdy9a7h4bwkmqyvzx6sri7mq4ejkmuife8qrtncqodgu3irir3dq5plnvhd3ktenoirx.png" width="18" /> Great, got it. Thank you! Now please wait while I prepare your custom generation pipeline. \n        ';O(o),o='\n        <img src="https://cdn.dribbble.com/users/77307/screenshots/6114091/dribbble_siri_style_loader.gif" width="177" />  \n        ',window.withfaith_showloaderwithchat(o),window.withfaith_gen_pipeline("chat")}},window.withfaith_gen_pipeline=function(){var t=p(d().mark(function t(a){var r,i,s,c,l,h;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(function(t,e){return t.lastModifiedDate=new Date,t.name=e,t}),parseInt(localStorage.withfaith_howmanyphotos_generated,10)>0&&(0,e.default)("#withfaith_generatephoto_loader").show(),"chat"===a&&(r=m,i=(0,n.ref)(S,"withfaith_photoupload_base64_"+localStorage.withfaith_fbuid+"_"+Date.now()),(0,n.uploadString)(i,r,"data_url").then(function(t){console.log("Uploaded a data_url string!"),console.log(t),(0,n.getDownloadURL)(t.ref).then(function(t){console.log("File available at",t),p(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_photouploads:(0,o.arrayUnion)(t)},{merge:!0});case 2:case"end":return e.stop()}},e)}))(),localStorage["withfaith_recentphotoupload_"+t]=t,localStorage.withfaith_photoupload_base64=t})}),localStorage.withfaith_describe_product=I,parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)>0&&(0,e.default)("#withfaith_generatecooltitledescription_loader").show()),function(t){var e=new FileReader;return e.readAsDataURL(t),new Promise(function(t){e.onloadend=function(){t(e.result)}})},s=localStorage.withfaith_chatgpt_intro_analysis.split("****")[1]+", no artifacts, clean edges, photorealistic",c=localStorage.withfaith_describe_product,l=localStorage.withfaith_photoupload_base64,h={cache:!1,url:"https://us-central1-love-375210.cloudfunctions.net/withfaithsd?place="+s+"&product="+c+"&photourl="+l,method:"POST",headers:{"Content-Type":"application/json"}},e.default.ajax(h).done(function(t,r,i){console.log(i.status),200!==i.status&&(console.log("trying again..."),window.withfaith_gen_pipeline());var s=t.data[0];(0,e.default)("#withfaith_inchatloading").remove(),console.log(s);var c='\n      <img src="'.concat(s,'" width="325"\n       style="border: 3px solid white;" />  \n      ');(0,e.default)("#withfaith_current_gen_photo").html(c),localStorage.withfaith_current_gen_photo=c,(0,e.default)("#withfaith_photobank").append('\n      <div class="col-xs-6" style="padding: 4px;">\n      <img\n        src="'.concat(s,'"\n        width="75"\n        height="75"\n      />\n    </div>\n      ')),(0,e.default)("#withfaith_generatephoto_loader").hide(),localStorage.withfaith_howmanyphotos_generated=parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)+1;var l=localStorage.withfaith_howmanyphotos_generated,h=s,u=(0,n.ref)(S,"withfaith_photogenerated_"+localStorage.withfaith_fbuid+"_"+l);if((0,n.uploadString)(u,h,"data_url").then(function(t){console.log("Uploaded a data_url string!"),console.log(t),(0,n.getDownloadURL)(t.ref).then(function(t){console.log("File available at",t),p(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_photolibrary:(0,o.arrayUnion)(t)},{merge:!0});case 2:case"end":return e.stop()}},e)}))(),localStorage["withfaith_photogenerated_"+l]=t})}),parseInt(localStorage.withfaith_howmanyphotos_generated,10)>0&&((0,e.default)("#withfaith_prephotos_info").hide(),(0,e.default)("#withfaith_generate_new_photo").show()),(0,e.default)("#withfaith_howmanyphotos_generated").html(localStorage.withfaith_howmanyphotos_generated),"chat"===a){(0,e.default)("#withfaith_generatecooltitledescription_loader").show();var f="",g={url:"https://us-central1-love-375210.cloudfunctions.net/chatgpt?prompt="+(f+="\n      \n      Please reference the username, biography, and product description given to complete the response and generate a potential instagram post title and description that is clever, engaging, and suitable for their audience\n\n      With your response, please include the generated instagram post title in this format (include 4 asterisks before your response): ****(your generated instagram post title)\n\n      Also, please include the generated instagram post description in this format (include 4 carats before your response): ^^^(your generated instagram post description) \n       \n      Please be creative and detailed. Also, please include emojis. Also, when including emojis, please ensure that there's a space between any preceding alphanumeric character and an emoji. \n\n      Also, please don't include references to other accounts in your responses. Also, it's very important to adhere to the **** and ^^^ formats. @@@ is not acceptable. Please verify that your responses are valid before responding. Also, please don't include any extra text after hashtags. Thank you! \n \n      Username: ".concat(D.username,"\n      Biography: ").concat(D.biography,"\n      Product Description: ").concat(I,"\n      Response: \n      ")),method:"GET",timeout:0};e.default.ajax(g).done(function(t){console.log(t),(0,e.default)("#withfaithtextresultsarea").html('\n        \n        <textarea\n        id="withfaith_titledescription_ideas"\n        class="form-control"\n        width="325"\n        rows="5"\n        style="font-size: 0.9em;"\n      >'.concat(t.response.split("^^^")[0].split("****")[1].trim(),"\n\n").concat(t.response.split("^^^")[1].replace("@@@","").replace("undefined","").replace("*",""),"</textarea>")),(0,e.default)("#withfaith_generatecooltitledescription_loader").hide(),localStorage.withfaith_howmanycooltitledescriptions_generated=parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)+1,parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)>0&&((0,e.default)("#withfaith_prechat_info").hide(),(0,e.default)("#withfaith_supercoolupdatewritings").show(),(0,e.default)("#withfaith_supercoolupdatewritingsactionbutton").show()),(0,e.default)("#withfaith_howmanycooltitledescriptions_generated").html(localStorage.withfaith_howmanycooltitledescriptions_generated),localStorage.withfaith_chatgpt_intro_analysis=t.response})}}).fail(function(t,e,a){alert(a)});case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),window.withfaith_generate_new_titledescription=function(){var t="",a=[];(0,e.default)(".upvoted").each(function(){var o;console.log((0,e.default)(this)),"funny"===(0,e.default)(this)[0].textContent&&(o="\nSpeak as a comedian. Make at least one very funny joke or pun in your response. \n        ",a.push(o)),"clever"===(0,e.default)(this)[0].textContent&&(o="\nSpeak as a very clever person. Make at least one clever statement or reference in your response. \n        ",a.push(o)),"emojis"===(0,e.default)(this)[0].textContent&&(o="\nUtilize lots of emojis in your response. \n        ",a.push(o)),"sales focus"===(0,e.default)(this)[0].textContent&&(o="\nSpeak as a sales person. Craft your response as if you were a door-to-door salesperson and the post product was your product \n        ",a.push(o)),"product focus"===(0,e.default)(this)[0].textContent&&(o="\nSpeak as a brilliant product person. Craft your response as if you were an award-winning product designer and marketer and the post product was your product \n        ",a.push(o)),"surroundings focus"===(0,e.default)(this)[0].textContent&&(o="\nFocus on the surroundings of your product with your response. \n        ",a.push(o)),"warm"===(0,e.default)(this)[0].textContent&&(o="\nSpeak with warmth with your response. \n        ",a.push(o)),t+=(0,e.default)(this)[0].textContent+", "});for(var o="",n=a.length,r=0;r<n;r++)o+="\n      ".concat(a[r],"\n       ");localStorage.withfaith_howmanycooltitledescriptions_generated=parseInt(localStorage.withfaith_howmanycooltitledescriptions_generated,10)+1,t=t.replace(/,\s*$/,""),(0,e.default)("#withfaith_generatecooltitledescription_loader").show();var i="";i+="\n   \n   Please reference the username, biography, and product description given to complete the response and generate a potential instagram post title and description that is clever, engaging, and suitable for their audience\n\n   With your response, please include the generated instagram post title in this format (include 4 asterisks before your response): ****(your generated instagram post title)\n\n   Also, please include the generated instagram post description in this format (include 4 carats before your response): ^^^(your generated instagram post description)\n \n   Very important: Please have a ".concat(t," vibe with your response (celebrate each vibe).  \n\n   ").concat(o," \n    \n   Also, please don't include references to other accounts in your responses. Also, it's very important to adhere to the **** and ^^^ formats. @@@ is not acceptable. Please verify that your responses are valid before responding. Also, please don't include any extra text after hashtags. Thank you! \n\n   Username: ").concat(D.username,"\n   Biography: ").concat(D.biography,"\n   Product Description: ").concat(I,"\n   Response: \n   "),console.log(i);var s={url:"https://us-central1-love-375210.cloudfunctions.net/chatgpt?prompt="+i,method:"GET",timeout:0};e.default.ajax(s).done(function(t){console.log(t),(0,e.default)("#withfaithtextresultsarea").html(' \n     \n     <textarea\n     id="withfaith_titledescription_ideas"\n     class="form-control"\n     width="325"\n     rows="5"\n     style="font-size: 0.9em;"\n   >'.concat(t.response.split("^^^")[0].split("****")[1].trim(),"\n\n").concat(t.response.split("^^^")[1].replace("@@@","").replace("undefined","").replace("*",""),"</textarea>")),(0,e.default)("#withfaith_generatecooltitledescription_loader").hide(),(0,e.default)("#withfaith_howmanycooltitledescriptions_generated").html(localStorage.withfaith_howmanycooltitledescriptions_generated),localStorage.withfaith_chatgpt_intro_analysis=t.response})},window.withfaith_showloaderwithchat=function(t){var a='<div id="withfaith_inchatloading" class="post post-bot">'.concat(t+A(),"</div>");(0,e.default)("#message-board").append(a),C(),p(d().mark(function t(){var e,n;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.getDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid));case 2:(e=t.sent).exists()?(console.log("Document data:",e.data()),v=e.data(),v.withfaith_chathistory,n={from:"ai",response:"(shows loading)",html:a},p(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.setDoc)((0,o.doc)(k,"demo",localStorage.withfaith_fbuid),{withfaith_chathistory:(0,o.arrayUnion)(n)},{merge:!0});case 2:case"end":return t.stop()}},t)}))()):console.log("No such document!");case 4:case"end":return t.stop()}},t)}))()},window.helperwithcamerarefresh=function(){(0,e.default)("#loader").hide(),(0,e.default)("#my_camera").hide(),(0,e.default)("#recordpicture").hide(),(0,e.default)("#withfaithcomeagainwithpicture").hide(),i.default.reset()},(0,e.default)("#fetchfileval").on("change",function(){b("fetchfileval")}),(0,e.default)("#test").on("click",function(){x()}),window.withfaith_photoupload_helper=function(t){"upload"==t&&(0,e.default)("#fetchfileval").change(),"camera"==t&&(0,e.default)("#photovidlibbutton").click()},(0,e.default)("#message").on("keyup",function(t){13===t.which&&P()}).on("focus",function(){(0,e.default)("#message").addClass("focus")}).on("blur",function(){(0,e.default)("#message").removeClass("focus")}),(0,e.default)("#send").on("click",P),(0,e.default)("#back-button").on("click",function(){(0,e.default)("#landing").show()}),(0,e.default)("#nav-icon").on("click",function(){(0,e.default)("#nav-container").show()}),(0,e.default)("#nav-container").on("mouseleave",function(){(0,e.default)("#nav-container").hide()}),(0,e.default)(".nav-link").on("click",function(){(0,e.default)("#nav-container").slideToggle(200)}),(0,e.default)("#clear-history").on("click",function(){(0,e.default)("#message-board").empty(),(0,e.default)("#message").empty()}),(0,e.default)("#sign-out").on("click",function(){(0,e.default)("#message-board").empty(),(0,e.default)("#message").empty(),(0,e.default)("#landing").show(),(0,e.default)("#username").val(""),(0,e.default)("#start-chat").html("Start chat")}),(0,e.default)("#emoi").on("click",function(){(0,e.default)("#emoijis").slideToggle(300),(0,e.default)("#emoi").toggleClass("fa fa-grin far fa-chevron-down")}),(0,e.default)(".smiley").on("click",function(t){var a=(0,e.default)(t.currentTarget).clone().contents().addClass("fa-lg");(0,e.default)("#message").append(a),(0,e.default)("#message").select()}),(0,e.default)("img").bind("contextmenu",function(t){return alert("Please join the CoWork beta for the ability to download high-resolution versions of generated photos"),!1})});
},{"./styles.css":"D9Nj","jquery":"HlZQ","firebase/app":"hLvv","firebase/firestore":"R6ck","firebase/storage":"pIUw","firebase/analytics":"Pkoa","./webcam.min.js":"OHMQ","dotenv":"Ig2k"}]},{},["H99C"], null)
//# sourceMappingURL=/csb-ywgl36/src.e8df5a8f.js.map